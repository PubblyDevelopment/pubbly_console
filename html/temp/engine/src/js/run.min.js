"use strict";function _possibleConstructorReturn(self,call){return!call||"object"!==_typeof(call)&&"function"!=typeof call?_assertThisInitialized(self):call}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),superClass&&_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){return(_setPrototypeOf=Object.setPrototypeOf||function(o,p){return o.__proto__=p,o})(o,p)}function _get(target,property,receiver){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(target,property,receiver){var base=_superPropBase(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(receiver):desc.value}})(target,property,receiver||target)}function _superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=_getPrototypeOf(object)););return object}function _getPrototypeOf(o){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(o){return o.__proto__||Object.getPrototypeOf(o)})(o)}function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _typeof(obj){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj})(obj)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Constructor}var Pubbly=function(){function Pubbly(data,runtimeProps){var _this3=this;_classCallCheck(this,Pubbly),$("#pubbly_main")&&$("#pubbly_main").css("opacity",1),this.drawPage_dispatch=this.drawPage_dispatch.bind(this),this.fatalError=this.fatalError.bind(this),this.checkPageFor=this.checkPageFor.bind(this),this.loadBufferLead=this.loadBufferLead.bind(this),this.find=this.find.bind(this),this.findAll=this.findAll.bind(this),this.sendToTop=this.sendToTop.bind(this),this.runtimeProps=_extends({masterVolume:1,startPage:0,showOverflowPages:!1,showSequence:!1,announceDrawnObjects:!1,announceAssetLoad:!1,artificialLoadTime:0,artificialInterrupt:void 0,holdPageLinks:!1,stopAtTarget:"",drawFieldBorders:!1,name:"Pubbly",height:641,width:1e3,display:"single",bullet:"#8867AC",interrupt:!1,saveStates:!1,navigation:!0,snapDrops:!0,lastPageSpread:!1,assetLocationPrefix:"",HighlightLinkColor:"128,255,255",HighlightLinkColorRGBA:"RGBA(128,255,255,0.5)",HighlightLinkTransparency:50,HighlightLinkTime:500,timeLimit:0,environment:"online",forceBack:!1,enginePathPrefix:""},runtimeProps),"app"===this.runtimeProps.environment&&(this.appModifications=new AppModifications(this.runtimeProps),this.analytics=new Analytics),this.runtimeProps.timeLimit&&0<parseInt(this.runtimeProps.timeLimit)&&window.setTimeout(function(){history.back()},1e3*this.runtimeProps.timeLimit),this.data=data,this.curPage=this.runtimeProps.startPage,this.ready=!1,this.firstDraw=!0,this.lzwCompress=window.lzwCompress,this.dom=new PubblyDom(data,this.runtimeProps.environment),this.navigationUI=new NavigationUI({display:this.data.info.display,bookLength:this.data.pages.length,initShown:this.data.info.navigation,initEnabled:!(!this.domInteraction&&this.domInteractionNeeded),startPage:this.curPage,lastPageSpread:this.data.info.lastPageSpread},this.dom.header),this.textCtx=document.createElement("canvas").getContext("2d"),this.bufferCtx=document.createElement("canvas").getContext("2d"),this.turns=new Turns(this,this.data.info.display),this.cursors=new Cursors($("#cancover")),this.events=new Events(this),this.states=new States(this),this.countdown=new Countdown(this),this.sequence=new Sequence(this),this.urlNav=new UrlNav(this.runtimeProps.environment),this.drawingTools=new PubblyDrawingTools(this,this.data.drawingTool),this.data.pages.forEach(function(p){p.objs.forEach(function(o){"workspace"===o.type&&(o.workspace=new Workspace(o,_this3.dom.workspaces))})}),this.redrawDependency=new RedrawDependency(this.drawPage_dispatch.bind(this)),this.progressGraph=new ProgressGraph("vertical_letters",this.dom.main.find("#loaderCont"),this.runtimeProps.enginePathPrefix),this.slowNetworkGif=new ProgressGraph("carrot_eat",this.dom.main.find("#loaderCont"),this.runtimeProps.enginePathPrefix),this.slowNetworkGif.hide(),this.presetAssets=new PubblyPresetAssets(this.runtimeProps.rootToEngine),this.pageBuffer=new PubblyPageBuffer(this.data),this.domInteractionCover=new DomInteractionCover(this.dom.canvases),this.domInteractionCover.picked.relPath=this.runtimeProps.rootToEngine+this.domInteractionCover.picked.relPath,this.presetAssets.add(this.domInteractionCover.picked),this.launch_dispatch({done:function(){this.events.enable(),this.ready=!0;var pages=[0];this.data.pages[1]&&pages.push(1),this.drawPage_dispatch(pages),this.firstDraw=!1,this.data.info.navigation&&this.navigationUI.enable(),this.checkPageFor("openPages")}.bind(this),fail:this.fatalError})}return _createClass(Pubbly,[{key:"drawLinks",value:function(ctx,which,color){var curPage=this.data.pages[this.curPage];ctx||(ctx=$("canvas.current")[0].getContext("2d")),which=which||Array.apply(null,{length:curPage.links.length}).map(Number.call,Number);for(var links=curPage.links,drawLinks="number"==typeof which?[which]:which,_loop=function(g){var link=links[drawLinks[g]];!function(poly,ctx){var color=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"RGBA(20,20,20,0.2)";if(console.log(poly),ctx.fillStyle=color,ctx.strokeStyle=color,poly&&poly[0]){ctx.beginPath(),ctx.moveTo(poly[0][0],poly[0][1]);for(var p=1;p<poly.length;p++)ctx.lineTo(poly[p][0],poly[p][1]);ctx.fill(),ctx.closePath(),ctx.stroke()}else console.warn("Link had no points, moving on...")}("graphic"===link.type?link.poly:imgToPoly(curPage.objs.find(function(o){return o.name===link.name})),ctx,color)},g=0;g<drawLinks.length;g++)_loop(g)}},{key:"setCanvasClasses",value:function(curPage){null==curPage&&(curPage=this.curPage),"composite"==this.data.info.display&&(0==curPage||curPage==this.data.pages.length-1&&!this.data.info.lastPageSpread?this.events.pageOffsetX=this.data.info.width/-2:this.events.pageOffsetX=0,$("#pubbly_main #canvases .cover").find("canvas").attr("width",2*this.data.info.width),$("#pubbly_main #canvases .cover").removeClass("cover"),0==curPage?($("#pubbly_main #canvases .current").addClass("cover"),$("#pubbly_main #canvases .current").find("canvas").attr("width",this.data.info.width)):1==curPage&&($("#pubbly_main #canvases .previous").addClass("cover"),$("#pubbly_main #canvases .previous").find("canvas").attr("width",this.data.info.width)),curPage+1!=this.data.pages.length||this.data.info.lastPageSpread?curPage+2!=this.data.pages.length||this.data.info.lastPageSpread||($("#pubbly_main #canvases .next").addClass("cover"),$("#pubbly_main #canvases .next").find("canvas").attr("width",this.data.info.width)):($("#pubbly_main #canvases .current").addClass("cover"),$("#pubbly_main #canvases .current").find("canvas").attr("width",this.data.info.width)))}},{key:"checkLocFor",value:function(loc,what,condition){var _this=this;"object"!==_typeof(what)&&(what=[what]);for(var found=[],curPage=this.data.pages[this.curPage],_loop2=function(l){var link=curPage.links[l],poly=!1;if("graphic"!==link.type&&"link"!==link.type||!link.enabled){if("image"===link.type){var img=curPage.objs.find(function(o){return o.name===link.name});img.vis&&(poly=imgToPoly(img))}}else poly=link.poly;if(link.pinned){var _obj=curPage.objs.find(function(o){return o.name===link.pinned});if(_obj){var info=_this.getRealObjDescription(_obj),topDif=info.top-_obj.init.loc[0],leftDif=info.left-_obj.init.loc[1];poly=poly.map(function(pt){return[pt[0]+leftDif,pt[1]+topDif]})}}if(poly&&inside(loc,poly))for(var w=0;w<what.length;w++){var linkType=what[w];if("clicks"===linkType||"dragStops"===linkType||"lineStops"===linkType)for(var _i=0;_i<link.triggers[linkType].length;_i++){var accepts=link.triggers[linkType][_i].condition;accepts!=condition&&"any"!=accepts&&"clicks"!=linkType||found.push({link:link,type:"sequence",action:linkType,loc:_i})}else"lineStarts"===linkType&&("multiple"!=link.drawing&&"single"!=link.drawing||found.push({link:link,type:"singleAction",action:link.drawing,loc:null}))}},l=0;l<curPage.links.length;l++)_loop2(l);var checkDrag=-1!==what.indexOf("dragStarts"),checkDraw=-1!==what.indexOf("drawStarts"),checkEdit=-1!==what.indexOf("editableFields");if(checkDrag||checkDraw||checkEdit)for(var o=0;o<curPage.objs.length;o++){var obj=curPage.objs[o];if(checkDraw&&"workspace"===obj.type&&obj.vis&&inside(loc,obj.rect)&&found.push({link:obj,action:this.drawingTools.tool.cursor,loc:o}),checkDrag&&obj.vis&&("clone"===obj.mobility||"drag"===obj.mobility)||checkEdit&&"field"===obj.type&&obj.editable){var objTop=obj.droppedLoc?obj.droppedLoc[0]:obj.loc[0],objLeft=obj.droppedLoc?obj.droppedLoc[1]:obj.loc[1],rect=[[objLeft,objTop],[objLeft+obj.width,objTop],[objLeft+obj.width,objTop+obj.height],[objLeft,objTop+obj.height]],action="fixed"==obj.mobility?"editText":obj.mobility;inside(loc,rect)&&!0===obj.vis&&found.push({link:obj,type:"singleAction",action:action,loc:o})}}return found.sort(function(a,b){return"workspace"===a.link.type||"workspace"===b.link.type?"workspace"===a.link.type?1:-1:b.link.layer-a.link.layer}),found}},{key:"checkPageFor",value:function(what){for(var links=this.data.pages[this.curPage].links,points=this.data.pages[this.curPage].points,totLinks=[],l=0;l<links.length;l++)for(var link=links[l],triggers=link.triggers[what],p=0;p<triggers.length;p++){var trigger=triggers[p];if("openPages"===what)"every"!==trigger.condition&&0!==trigger.run||this.runtimeProps.holdPageLinks||totLinks.push([{action:"openPages",loc:p,link:link},trigger]);else if("countdowns"==what)totLinks.push([{action:"countdowns",loc:p,link:link},trigger]);else if("points"==what){if(-1!==points.changed.indexOf(trigger.condition[0])){var met=!1,realPoints=1*points[trigger.condition[0]],triggerPoints=1*trigger.condition[2];switch(trigger.condition[1]){case"<":met=realPoints<triggerPoints;break;case"<=":met=realPoints<=triggerPoints;break;case">":met=triggerPoints<realPoints;break;case">=":met=triggerPoints<=realPoints;break;case"=":met=realPoints==triggerPoints;break;case"!=":met=realPoints!=triggerPoints;break;default:console.error("Unknown point trigger comparison of "+trigger.condition[1])}met&&totLinks.push([{action:"points",loc:p,link:link},trigger])}}else console.error("Unknown page trigger "+what)}if(totLinks[0]){if("points"==what){var pointName=totLinks[0][1].condition[0],_p=this.data.pages[this.curPage].points.changed.indexOf(pointName);this.data.pages[this.curPage].points.changed.splice(_p,1)}this.sequence.startNew(totLinks[0][0],totLinks[0][1])}}},{key:"getRealObjDescription",value:function(curObj){var objTop,objLeft,objWidth,objHeight,swapHeight,swapWidth;if(curObj.swapMethod){var heightOverage=curObj.swapHeight/curObj.height,widthOverage=curObj.swapWidth/curObj.width,scaleDown=Math.max(heightOverage,widthOverage,1);swapHeight=curObj.swapHeight/scaleDown,swapWidth=curObj.swapWidth/scaleDown}objTop=curObj.swapMethod?curObj.loc[0]+(curObj.height-swapHeight)/2:curObj.loc[0],objLeft=curObj.swapMethod?curObj.loc[1]+(curObj.width-swapWidth)/2:curObj.loc[1],objWidth=curObj.swapMethod?swapWidth:curObj.width,objHeight=curObj.swapMethod?swapHeight:curObj.height;var objOpacity=curObj.opacity,objAngle=curObj.angle||0;if(curObj.animations.playing){objWidth=curObj.swapMethod?swapWidth:curObj.init.width,objHeight=curObj.swapMethod?swapHeight:curObj.init.height;for(var anim=curObj.animations[curObj.animations.playing],leg=-1,time=0;leg++,(time+=anim.data[leg].time)<curObj.animations.at;);var curLeg=anim.data[leg],nextLeg=anim.data[leg+1],leftover=time-curObj.animations.at,percent=(curLeg.time-leftover)/curLeg.time;objTop=animLegNextByPercent(curLeg.loc[0],nextLeg.loc[0],percent),objLeft=animLegNextByPercent(curLeg.loc[1],nextLeg.loc[1],percent),objAngle=animLegNextByPercent(curLeg.angle,nextLeg.angle,percent),objOpacity=animLegNextByPercent(curLeg.opacity,nextLeg.opacity,percent),objTop-=(objHeight*=animLegNextByPercent(curLeg.height,nextLeg.height,percent))/2,objLeft-=(objWidth*=animLegNextByPercent(curLeg.width,nextLeg.width,percent))/2}else curObj.droppedLoc&&(objTop=curObj.droppedLoc[0],objLeft=curObj.droppedLoc[1]);return curObj.offsets&&(objTop+=curObj.offsets[0],objLeft+=curObj.offsets[1]),{top:objTop,left:objLeft,height:objHeight,width:objWidth,angle:objAngle,opacity:objOpacity,layer:curObj.layer,vis:curObj.vis}}},{key:"makeClone",value:function(parent){var clone=jQuery.extend(!0,{},parent);return clone.type="clone",clone.mobility="drag",clone.markedForDeletion=!1,clone.init.markedForDeletion=!0,this.data.pages[this.curPage].objs.push(clone),clone}},{key:"clearClones",value:function(){for(var objs=this.data.pages[this.curPage].objs,o=0;o<objs.length;o++){var obj=objs[o];"clone"===obj.type&&obj.markedForDeletion&&(this.data.pages[this.curPage].objs.splice(o,1),o--)}}},{key:"clearLines",value:function(){for(var lnks=this.data.pages[this.curPage].links,l=0;l<lnks.length;l++){var lnk=lnks[l];if(lnk.lines&&lnk.lines.length)for(var ln=0;ln<lnk.lines.length;ln++)lnk.lines[ln].markedForDeletion&&(this.data.pages[this.curPage].links[l].lines.splice(ln,1),ln--)}}},{key:"fatalError",value:function(message){console.error("Pubbly fatal error: "+message)}},{key:"find",value:function(what,type,curPage){var found=this.findAll(what,type,curPage);return found[0]?found[0]:found}},{key:"sendToTop",value:function(what,type,curPage){return this.sendTo(what,type,curPage,"top")}},{key:"sendToBottom",value:function(what,type,curPage){return this.sendTo(what,type,curPage,"bottom")}},{key:"findAll",value:function(what){var type=1<arguments.length&&void 0!==arguments[1]?arguments[1]:what.type,curPage=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.curPage,page=this.data.pages[curPage],searchStart=!1,found=!1;return 0<=["image","clone","gif","field","workspace","object","video"].indexOf(type)?searchStart=page.objs:0<=["link"].indexOf(type)&&(searchStart=page.links),searchStart&&(found=searchStart.filter(function(o){return"object"===_typeof(what)?o===what:"string"==typeof what?o.name===what:void 0})),found}},{key:"sendTo",value:function(what){var type=1<arguments.length&&void 0!==arguments[1]?arguments[1]:what.type,curPage=2<arguments.length&&void 0!==arguments[2]?arguments[2]:this.curPage,where=3<arguments.length?arguments[3]:void 0,page=this.data.pages[curPage],searchStart=!1,toSend=this.find(what,type,curPage);if(0<=["image","clone","gif","field","workspace","object"].indexOf(type)?searchStart=page.objs:0<=["link"].indexOf(type)&&(searchStart=page.links),searchStart&&toSend){toSend.layer;return"top"===where?toSend.layer=searchStart.length:(toSend.layer=-1,searchStart.map(function(o){return o.layer++})),(searchStart=searchStart.sort(function(a,b){return a.layer-b.layer})).map(function(o,i){return o.layer=i}),this.drawPage_dispatch(),toSend}return!1}},{key:"getPageArrayNeededForDrawPage",value:function(){var checkPage=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.curPage,arr=[];return arr.push(checkPage),checkPage+1<this.data.pages.length&&arr.push(checkPage+1),0<=checkPage-1&&arr.push(checkPage-1),arr}},{key:"getPageArrayNeededForBufferLead",value:function(){var checkPage=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.curPage,arr=this.getPageArrayNeededForDrawPage(checkPage);return checkPage+2<this.data.pages.length&&arr.push(checkPage+2),arr}},{key:"loadBufferLead",value:function(newPage,cbs){var neededForDraw=this.getPageArrayNeededForDrawPage(newPage),neededForLead=this.getPageArrayNeededForBufferLead(newPage);if(0===neededForDraw.reduce(function(a,p){return a+this.pageBuffer.getPageUnloadedAssetCount(p)}.bind(this),0))cbs.done(),this.pageBuffer.loadMultiplePages(neededForLead,{done:function(){console.log("Background-buffer done")}});else{var progFnc=this.progressGraph.calculate;this.firstDraw||(this.slowNetworkGif.show(),this.events.disable(),this.navigationUI.disable(),progFnc=this.slowNetworkGif.calculate),this.pageBuffer.loadMultiplePages(neededForLead,{done:function(){this.slowNetworkGif.hide(),this.events.enable(),this.navigationUI.enable(),cbs.done()}.bind(this),fail:cbs.fail,prog:progFnc})}}},{key:"getLastPage",value:function(){return this.data.pages.length-1}},{key:"getLastPageSpread",value:function(){return this.data.info.lastPageSpread}},{key:"updateCanvasAttrsWithNewPageValues",value:function(){var newPage=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.curPage;if(this.removeTurningStylesFromCanvases(),"composite"===this.data.info.display){var atFrontCover=0===newPage,atRearCover=newPage===this.getLastPage()&&!this.getLastPageSpread(),canvasesAsCover={previous:1===newPage,current:atFrontCover||atRearCover,next:newPage+1===this.getLastPage()&&!this.getLastPageSpread()},eventOffset=canvasesAsCover.current?this.data.info.width/-2:0;for(var canName in this.events.offsets.pageOffsetX=eventOffset,canvasesAsCover){var placer=this.dom.canPlacers[canName],can=placer.find("canvas");canvasesAsCover[canName]?(can.attr("width",this.data.info.width),placer.addClass("cover")):(can.attr("width",2*this.data.info.width),placer.removeClass("cover"))}}}},{key:"removeTurningStylesFromCanvases",value:function(){for(var placer in this.dom.canPlacers)this.dom.canPlacers[placer][0]&&this.dom.canPlacers[placer][0].removeAttribute("style")}},{key:"changeCurPage_dispatch",value:function(newPage,cbs){this.ready=!1,cbs=assignDefaultCallbacks(cbs),void 0===newPage?console.error("Cannot set curPage: Value passed undefined"):newPage<0||newPage>=this.data.pages.length?console.error("Cannot set curPage: Value passed should be between 0 and "+this.data.pages.length-1):(this.curPage=newPage,this.navigationUI.update(newPage),this.loadBufferLead(newPage,{done:function(){this.updateCanvasAttrsWithNewPageValues(newPage),this.ready=!0,this.drawPage_dispatch(),cbs.done()}.bind(this),fail:cbs.error,prog:this.progressGraph.calculate}))}},{key:"launch_dispatch",value:function(cbs){this.updateCanvasAttrsWithNewPageValues(),this.presetAssets.load({done:function(){this.loadBufferLead(this.curPage,{done:function(){this.progressGraph.end(),"app"===this.runtimeProps.environment?cbs.done():detectAutoplay(100,{fail:function(){this.domInteractionCover.promptClick(cbs.done)}.bind(this),done:cbs.done})}.bind(this),fail:cbs.fail,prog:this.progressGraph.calculate})}.bind(this),fail:cbs.fail})}},{key:"drawPage_dispatch",value:function(){var _this2=this,which=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.curPage;if(this.ready)if("object"===_typeof(which)&&which.length)which.map(function(page){return _this2.drawPage_dispatch(page)});else if(1<Math.abs(which-this.curPage)||!this.data.pages[which]){var start=Math.max(this.curPage-1,0),end=this.data.pages[this.curPage+1]?this.curPage+1:this.data.pages.length-1;console.error("Pubbly.drawPage_dispatch: Can only draw prev, cur or next pages. Please call with a value between "+start+" and "+end+". Not "+which)}else{var btx,page=this.data.pages[which],ctx=this.draw_readyAndReturnCTX(which);"composite"===this.data.info.display?btx=ctx:((btx=this.bufferCtx).canvas.height=ctx.canvas.height,btx.canvas.width=ctx.canvas.width),page.objs.sort(function(a,b){return"video"!==a.type&&"video"!==b.type||"video"===a.type&&"video"===b.type?a.layer-b.layer:"video"===a.type?1:-1});var key={image:"draw_general",clone:"draw_general",sequence:"draw_general",workspace:"draw_workspace",field:"draw_field",gifs:"draw_gif",video:"draw_video"};page.objs.map(function(o){"function"==typeof _this2[key[o.type]]&&_this2[key[o.type]](btx,o,which)}),page.links.map(function(l){l.clickHighlightOn&&_this2.drawLinks(ctx,l,_this2.data.info.HighlightLinkColorRGBA)}),"composite"===this.data.info.display?this.draw_cloneCanvasToSpread(ctx,which):ctx.drawImage(btx.canvas,0,0,this.data.info.width,this.data.info.height)}}},{key:"draw_readyAndReturnCTX",value:function(drawPage){var relativeHalf=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",baseClass=["previous","current","next"][(drawPage="number"==typeof drawPage?drawPage:this.curPage)+1-this.curPage],spreadClass="";"left"===relativeHalf?spreadClass="SpreadLeft":"right"===relativeHalf&&(spreadClass="SpreadRight");$("#canvases").find("div."+baseClass+spreadClass)[0];var can=$("#canvases").find("canvas."+baseClass+spreadClass)[0],ctx=can.getContext("2d");return ctx.imageSmoothingEnabled=!0,can.height=1*can.height,can.width=1*can.width,ctx}},{key:"draw_elem",value:function(ctx,elem,objDesc){if(objDesc.vis){ctx.globalAlpha=objDesc.opacity;var args=[elem,parseInt(objDesc.left,10),parseInt(objDesc.top,10),parseInt(objDesc.width,10),parseInt(objDesc.height,10)];if(objDesc.angle){var objRad=360*objDesc.angle*(Math.PI/180),halfWidth=objDesc.width/2,halfHeight=objDesc.height/2;ctx.save(),ctx.translate(objDesc.left+halfWidth,objDesc.top+halfHeight),ctx.rotate(objRad),ctx.translate(-halfWidth,-halfHeight),ctx.drawImage(elem,0,0,objDesc.width,objDesc.height),ctx.restore()}else ctx.drawImage.apply(ctx,args);ctx.globalAlpha=1}}},{key:"draw_general",value:function(ctx,curObj,curPage){var img,relPath="sequence"==curObj.type?curObj.frames[curObj.at].relPath:curObj.relPath,assetPath=this.pageBuffer.assetListLoaders[curPage].keys[relPath];img="workspace"===curObj.type?curObj.workspace.elem:!(!assetPath||!assetPath.elem)&&assetPath.elem;var objDesc=this.getRealObjDescription(curObj);!1!==img?this.draw_elem(ctx,img,objDesc):console.error("Pubbly.draw_image: Missing image elem for "+curObj.fileName)}},{key:"draw_workspace",value:function(ctx,curWorkspace,curPage){curWorkspace.clear&&(curWorkspace.clear=!1,curWorkspace.workspace.elem.width=1*curWorkspace.workspace.elem.width);var rect=[curWorkspace.loc[1],curWorkspace.loc[0],curWorkspace.width,curWorkspace.height];curWorkspace.bgTexture&&curWorkspace.vis&&this.draw_texture(ctx,curWorkspace.bgTexture,rect),this.draw_general(ctx,curWorkspace,curPage),this.drawingTools.drawCtx===curWorkspace.workspace.ctx&&ctx.drawImage(this.drawingTools.effectCanvas,curWorkspace.loc[1],curWorkspace.loc[0])}},{key:"draw_field",value:function(ctx,curObj,relPage){if(curObj.vis){var text=curObj.contents||"";if("points"===curObj.displayType){var localCheck=this.data.pages[relPage].points[curObj.display.toLowerCase()],globalCheck=this.data.points[curObj.display.toLowerCase()];void 0===(text=void 0===localCheck?globalCheck:localCheck)?error("warn","draw page","Undefined points reference: "+curObj.display):text=text.toString()}else"countdown"===curObj.displayType&&(text=this.countdown.at);var lines=!1,drawTops=[];if(""!==text||curObj.editing){lines=text.toString().split("\n")||[];var fakeText=!text;fakeText&&(lines=["M"]);if(curObj.calculated.size||"auto"!==curObj.size)ctx.font=curObj.size+"pt "+curObj.font;else{var widthLimit=parseInt(curObj.width/lines[0].length),curDirection=!1,lastDirection=!1,measured=0;do{measured=0,ctx.font=widthLimit+"pt "+curObj.font;for(var l=0;l<lines.length;l++)measured=Math.max(ctx.measureText(lines[l]).width,measured);curDirection=measured>curObj.width?-1:1,!1===lastDirection&&(lastDirection=curDirection),lastDirection!==curDirection?((curDirection=-1)&&widthLimit--,curDirection=lastDirection=!1):widthLimit+=curDirection}while(!1!==curDirection);var heightLimit=0;measured=0;for(;heightLimit++,ctx.font=heightLimit+"pt "+curObj.font,(measured=ctx.measureText("M").width)<.7*curObj.height/lines.length;);heightLimit--,curObj.calculated.size=Math.min(heightLimit,widthLimit)}ctx.font=curObj.calculated.size+"pt "+curObj.font;for(var widestLine=0,_l=0;_l<lines.length;_l++)widestLine=Math.max(ctx.measureText(lines[_l]).width,widestLine);curObj.calculated.lineHeight=ctx.measureText("M").width,curObj.calculated.widestLine=widestLine,"left"==curObj.align?curObj.calculated.leftMargin=0:"center"==curObj.align?curObj.calculated.leftMargin=(curObj.width-widestLine)/2:"right"==curObj.align?curObj.calculated.leftMargin=curObj.width-widestLine:error("warn","draw page","Unknown text align of "+curObj.align),fakeText&&(lines=[""]);var insert={at:0,line:0,char:0};if(curObj.editing){curObj.loc[0],curObj.loc[1],curObj.calculated.leftMargin,curObj.calculated.size;insert={at:this.events.f.insertionPoint.at,line:0,char:0};for(var _i2=0;_i2<insert.at;_i2++)insert.char++,insert.char>lines[insert.line].length&&(insert.char=0,insert.line++)}ctx.font=curObj.calculated.size+"pt "+curObj.font,ctx.fillStyle=curObj.color;for(var drawLeftBase=curObj.loc[1]+curObj.calculated.leftMargin,lineStartWord=0,_l2=0;_l2<lines.length;_l2++){var drawLeft=drawLeftBase,drawTop=curObj.loc[0]+curObj.calculated.lineHeight*(_l2+1);if("center"==curObj.align){var width=ctx.measureText(lines[_l2]).width;drawLeft+=curObj.calculated.widestLine/2-width/2}else if("right"==curObj.align){var _width=ctx.measureText(lines[_l2]).width;drawLeft+=curObj.calculated.widestLine-_width}drawTops.push(drawTop);isNaN(1*curObj.size)?curObj.calculated.size:curObj.size;var words=lines[_l2].split(" ");if(words=words.filter(function(wrd){return""!==wrd}),curObj.highlight&&"number"==typeof curObj.highlight.wordNum&&curObj.highlight.wordNum>=lineStartWord&&curObj.highlight.wordNum<lineStartWord+words.length)for(var wordOffsetWidth=0,w=0;w<words.length;w++){if(lineStartWord+w===curObj.highlight.wordNum)if("front"===curObj.highlight.type)ctx.fillStyle=curObj.highlight.color;else{ctx.fillStyle=curObj.highlight.color;var wordWidth=ctx.measureText(words[w]).width,spaceWidth=ctx.measureText(" ").width;ctx.fillRect(drawLeft+wordOffsetWidth-.5*spaceWidth,drawTop-curObj.calculated.lineHeight,wordWidth+spaceWidth,1.2*curObj.calculated.lineHeight),ctx.fillStyle=curObj.color}else ctx.fillStyle=curObj.color;ctx.fillText(words[w]+" ",drawLeft+wordOffsetWidth,drawTop),wordOffsetWidth+=ctx.measureText(words[w]+" ").width}else ctx.fillText(lines[_l2],drawLeft,drawTop);if(lineStartWord+=words.length,curObj.editing&&this.events.f.insertionPoint.on&&insert.line==_l2){var lineStr=lines[_l2].substring(0,insert.char),strWidth=ctx.measureText(lineStr).width,fontsFuckingSuck=drawTop+.17*curObj.calculated.lineHeight;ctx.beginPath(),ctx.moveTo(drawLeft+strWidth,fontsFuckingSuck-curObj.calculated.lineHeight),ctx.lineTo(drawLeft+strWidth,fontsFuckingSuck),ctx.stroke()}}}this.runtimeProps.drawFieldBorders&&(ctx.fillStyle="black",ctx.beginPath(),ctx.lineTo(curObj.loc[1],curObj.loc[0]),ctx.lineTo(curObj.loc[1]+curObj.width,curObj.loc[0]),ctx.lineTo(curObj.loc[1]+curObj.width,curObj.loc[0]+curObj.height),ctx.lineTo(curObj.loc[1],curObj.loc[0]+curObj.height),ctx.lineTo(curObj.loc[1],curObj.loc[0]),ctx.stroke())}}},{key:"draw_gif",value:function(ctx,curGif){console.log("TODO: Draw gif"),console.log(curGif)}},{key:"draw_cloneCanvasToSpread",value:function(ctx,curPage){var pUnit=this.data.info.width;this.draw_readyAndReturnCTX(curPage,"left").drawImage(ctx.canvas,0,0),this.draw_readyAndReturnCTX(curPage,"right").drawImage(ctx.canvas,-1*pUnit,0)}},{key:"draw_texture",value:function(ctx,curTexture,rect){var image=this.presetAssets.list.find(function(i){return i.relPath==="pubbly_engine/assets/textures/"+curTexture});if(image&&image.elem){var pattern=ctx.createPattern(image.elem,"repeat");ctx.rect.apply(ctx,rect),ctx.fillStyle=pattern,ctx.fill()}}},{key:"draw_video",value:function(ctx,curVideo,curPage){var elem=this.pageBuffer.assetListLoaders[curPage].byFileSource[curVideo.fSrc].elem,objDesc=this.getRealObjDescription(curVideo);this.draw_elem(ctx,elem,objDesc)}}]),Pubbly}();function Countdown(pubblyScope){var _Pubbly=pubblyScope,_This=this;this.at=0,this.playing=!1,this.finished=!1,this.killed=!1,this.play=function(){this.playing||(this.playing=!0,this.int=window.setInterval(function(){_This.next.call(_This)},1e3))},this.finish=function(){window.clearInterval(this.int),this.playing=!1,this.finished=!0,_Pubbly.checkPageFor("countdowns")},this.kill=function(){window.clearInterval(this.int),this.at=0,this.playing=!1,this.killed=!0},this.stop=this.kill,this.mod_add=function(what){var num=this.mod_check(what,"add");num&&(this.at+=num)},this.mod_set=function(what){var num=this.mod_check(what,"set");num&&(this.at=num)},this.mod_subtract=function(what){var num=this.mod_check(what,"subtract");num&&(this.at-=num),this.check()},this.mod_check=function(what,from){return"number"==typeof(1*what)?1*what:(console.error("Cannot set to "+what+", only numbers allowed"),!1)},this.start_at=function(what){var num=this.mod_check(what,"set");num&&(this.at=num),this.playing||this.play()},this.pause=function(){this.playing=!1,window.clearInterval(this.int)},this.resume=function(){this.play()},this.int=!1,this.next=function(){this.at--,this.check()},this.check=function(){_Pubbly.drawPage_dispatch(),this.at<=0&&this.finish()}.bind(this)}function PubblyDom(xml,environment){return this.dom,this.build=function(environment){var info=xml.info,spreadWidth="composite"==info.display?2*info.width:info.width;$("#pubbly_main").append("<div id='header'></div>"),$("#pubbly_main").append("<div id='canvases'></div>"),$("#pubbly_main").append("<div id='footer'></div>"),$("#pubbly_main #header").append("<div id='bullet' style='background-color:"+info.bullet+";'></div>"),$("#pubbly_main #header").append("<p id='title'>"+info.name+"</p>"),$("#pubbly_main #header").css({width:spreadWidth}),$("#pubbly_main").append("\x3c!-- assetVisitorCenter is where I put video elements while they play. Cause there's no new Video() yet, and unless it's actually IN THE DOM, drawing a playing video on a canvas will only getcha the first frame --\x3e"),$("#pubbly_main").append("<div id='assetVisitorCenter'></div>"),$("#pubbly_main #canvases").append("<div id='cancover'></div>"),$("#pubbly_main #canvases #cancover").addClass("noselect"),$("#pubbly_main #cancover").append("<div id='loaderCont'></div>"),$("#pubbly_main").append("<div id='workspaces'></div>"),$("#pubbly_main #workspaces").css("display","none"),$("#pubbly_main").append('<textarea id="textEntryHidden" type="text" autocorrect="off" autocomplete="off" autocapitalize="off" spellcheck="off"></textarea>'),$("#pubbly_main #textEntryHidden").css({position:"absolute","z-index":-1,top:"50%",display:"none"}),"composite"==info.display?($("#pubbly_main #canvases").addClass("composite"),$("#pubbly_main #canvases #cancover").append("<div class='previousSpreadLeft canPlacer'>\n                <canvas height=".concat(info.height," width=").concat(info.width,"\n                class='previousSpreadLeft'></canvas>\n                </div>")),$("#pubbly_main #canvases #cancover").append("<div class='previousSpreadRight canPlacer'>\n                <canvas height=".concat(info.height," width=").concat(info.width,"\n                class='previousSpreadRight'></canvas>\n                </div>")),$("#pubbly_main #canvases #cancover").append("<div class='previous canPlacer'>\n                <canvas height=".concat(info.height," width=").concat(spreadWidth,"\n                class='previous'></canvas>\n                </div>")),$("#pubbly_main #canvases #cancover").append("<div class='currentSpreadLeft canPlacer'>\n                <canvas height=".concat(info.height," width=").concat(info.width,"\n                class='currentSpreadLeft'></canvas>\n                </div>")),$("#pubbly_main #canvases #cancover").append("<div class='currentSpreadRight canPlacer'>\n                <canvas height=".concat(info.height," width=").concat(info.width,"\n                class='currentSpreadRight'></canvas>\n                </div>")),$("#pubbly_main #canvases #cancover").append("<div class='current canPlacer'>\n                <canvas height=".concat(info.height," width=").concat(spreadWidth,"\n                class='current'></canvas>\n                </div>")),$("#pubbly_main #canvases #cancover").append("<div class='nextSpreadLeft canPlacer'>\n                <canvas height=".concat(info.height," width=").concat(info.width,"\n                class='nextSpreadLeft'></canvas>\n                </div>")),$("#pubbly_main #canvases #cancover").append("<div class='nextSpreadRight canPlacer'>\n                <canvas height=".concat(info.height," width=").concat(info.width,"\n                class='nextSpreadRight'></canvas>\n                </div>")),$("#pubbly_main #canvases #cancover").append("<div class='next canPlacer'>\n                <canvas height=".concat(info.height," width=").concat(spreadWidth,"\n                class='next'></canvas>\n                </div>"))):($("#pubbly_main #canvases").addClass("singlePage"),$("#pubbly_main #canvases #cancover").append("<div class='previous canPlacer'>\n                <canvas height=".concat(info.height," width=").concat(info.width,"\n                class='previous'></canvas>\n                </div>")),$("#pubbly_main #canvases #cancover").append("<div class='current canPlacer'>\n                <canvas height=".concat(info.height," width=").concat(info.width,"\n                class='current'></canvas>\n                </div>")),$("#pubbly_main #canvases #cancover").append("<div class='next canPlacer'>\n                <canvas height=".concat(info.height," width=").concat(info.width,"\n                class='next'></canvas>\n                </div>"))),$("#pubbly_main #footer").append("<img class='logo' />"),$("#pubbly_main #footer").append("<div class='clearfix'></div>"),$("#pubbly_main #canvases #cancover").css({height:info.height,width:spreadWidth}),$("#pubbly_main #canvases").css({height:info.height,width:spreadWidth});var domHeight=info.height+111,domWidth=spreadWidth+30,viewportScale=Math.min(screen.height/domHeight,screen.width/domWidth),viewportScaleNoMargins=Math.min(screen.height/info.height,screen.width/spreadWidth);"app"===environment?$("#viewport").attr("content","initial-scale="+viewportScaleNoMargins+", width=device-width, user-scalable=no"):$("#viewport").attr("content","initial-scale="+viewportScale);for(var p=0;p<xml.pages.length;p++){var pageName=xml.pages[p].name;$("select.goto").append("<option class='page_"+p+"' val='"+pageName+"'>"+pageName+"</option>")}$("#main").addClass("transformCenterCont"),$("#main > div").addClass("transformCenter"),this.dom={main:$("#pubbly_main"),header:$("#header"),textEntryHidden:$("#textEntryHidden"),canvases:$("#canvases"),workspaces:$("#workspaces"),canPlacers:{previousSpreadLeft:$("div.previousSpreadLeft.canPlacer"),previousSpreadRight:$("div.previousSpreadRight.canPlacer"),previous:$("div.previous.canPlacer"),currentSpreadLeft:$("div.currentSpreadLeft.canPlacer"),currentSpreadRight:$("div.currentSpreadRight.canPlacer"),current:$("div.current.canPlacer"),nextSpreadLeft:$("div.nextSpreadLeft.canPlacer"),nextSpreadRight:$("div.nextSpreadRight.canPlacer"),next:$("div.next.canPlacer")}}},this.build(environment),this.dom}var DomInteractionCover=function(){function DomInteractionCover(container){_classCallCheck(this,DomInteractionCover),this.container=container,this.clicked=this.clicked.bind(this),this.cb=!1,this.available=["dom_click_bee1.gif","dom_click_bee2.gif","dom_click_mathazzar.gif","dom_click_bird.gif","dom_click_pup.gif","dom_click_wordtopia.gif"].map(function(e){return{type:"gif",relPath:"assets/"+e}}),this.picked=randInArray(this.available)}return _createClass(DomInteractionCover,[{key:"promptClick",value:function(cb){var height=this.container.height(),width=this.container.width();this.container.append("\n         <div class='domInteractionCoverCont' \n         style='position:absolute;height:".concat(height,"px;width:").concat(width,"px;background-color:white'> \n         <img src=\"").concat(this.picked.relPath,"\"\n         class='transformCenter cursor-pointer'\n         style='max-height: 100%' \n         loop=infinite />\n         </div>")),this.cb=cb,this.container[0].addEventListener("click",this.clicked)}},{key:"clicked",value:function(){this.container.find(".domInteractionCoverCont").remove(),this.container[0].removeEventListener("click",this.clicked),this.cb(),this.cb=!1}}]),DomInteractionCover}(),DrawingTools=function(){function DrawingTools(defaultTool){_classCallCheck(this,DrawingTools),this.tool={type:"none",cursor:"draw-none"},this.effectCanvas=document.createElement("canvas"),this.ectx=this.effectCanvas.getContext("2d"),this.drawCtx=!1,this.temporaryDrawData={pencilPath:[]},defaultTool&&defaultTool.type&&this.change(defaultTool)}return _createClass(DrawingTools,[{key:"drawStop",value:function(){this.lastLoc=!1,this.temporaryDrawData.pencilPath=[],this.drawCtx&&(this.drawCtx.drawImage(this.effectCanvas,0,0),this.ectx.canvas.width=1*this.ectx.canvas.width,this.drawCtx=!1)}},{key:"draw",value:function(ctx,loc){"function"==typeof this["draw_"+this.tool.type]?(this.lastLoc||(this.lastLoc=loc),this["draw_"+this.tool.type](ctx,loc),this.lastLoc=loc):console.error("PubblyDrawingTools.draw: Unknown tool "+this.tool.type)}},{key:"draw_none",value:function(){}},{key:"draw_eraser",value:function(ctx,loc){var eraserDims=[50,40];ctx.clearRect(loc[0],loc[1],eraserDims[1]+5,eraserDims[0]+2)}},{key:"init_chalk",value:function(ctx,loc){this.drawCtx=ctx,this.effectCanvas.width=ctx.canvas.width,this.effectCanvas.height=ctx.canvas.height,this.ectx.lineCap="butt",this.ectx.globalAlpha=this.tool.color[3]/100,this.ectx.lineWidth=this.tool.width,this.ectx.strokeStyle="rgba("+this.tool.color.slice(0,3).join(",")+","+(.4+.2*Math.random())+")",this.ectx.hasBeenInitialized=!0}},{key:"draw_chalk",value:function(ctx,loc){this.drawCtx?ctx!==this.drawCtx&&console.error("Only one workspace at a time"):this.init_chalk(ctx,loc);var brushDiameter=this.tool.width,last=this.lastLoc;this.ectx.beginPath(),this.ectx.moveTo(last[0],last[1]),this.ectx.lineTo(loc[0],loc[1]),this.ectx.stroke();for(var length=Math.round(Math.sqrt(Math.pow(loc[0]-last[0],2)+Math.pow(loc[1]-last[1],2))/(5/brushDiameter)),xUnit=(loc[0]-last[0])/length,yUnit=(loc[1]-last[1])/length,i=0;i<length;i++){var xCurrent=last[0]+i*xUnit,yCurrent=last[1]+i*yUnit,xRandom=xCurrent+(Math.random()-.5)*brushDiameter*1.2,yRandom=yCurrent+(Math.random()-.5)*brushDiameter*1.2;this.ectx.clearRect(xRandom,yRandom,2*Math.random()+2,Math.random()+1)}}},{key:"init_pencil",value:function(ctx,loc){this.drawCtx=ctx,this.effectCanvas.width=ctx.canvas.width,this.effectCanvas.height=ctx.canvas.height}},{key:"draw_pencil",value:function(ctx,loc){var _this4=this;this.drawCtx?ctx!==this.drawCtx&&console.error("Only one workspace at a time"):this.init_pencil(ctx,loc),this.temporaryDrawData.pencilPath.push(loc),this.ectx.canvas.width=1*this.ectx.canvas.width,this.ectx.lineCap="round",this.ectx.lineJoin="round",this.ectx.lineWidth=this.tool.width,this.ectx.globalAlpha=this.tool.color[3],this.ectx.strokeStyle="rgba("+this.tool.color.join(",")+")",this.ectx.globalCompositeOperation="copy",this.ectx.beginPath(),this.ectx.moveTo.apply(this.ectx,this.temporaryDrawData.pencilPath[0]);var moveOrLine="line";this.temporaryDrawData.pencilPath.map(function(pt){pt?"move"===moveOrLine?(_this4.ectx.moveTo.apply(_this4.ectx,pt),moveOrLine="line"):_this4.ectx.lineTo.apply(_this4.ectx,pt):moveOrLine="move"}),this.ectx.stroke()}},{key:"change",value:function(to){if(-1===["eraser","chalk","pencil","none"].indexOf(to.type))return console.error("PubblyDrawingTools.change: Unknown type "+to.type),!1;to.color&&3===to.color.length&&to.color.push(1);return to.color[3]&&1<to.color[3]&&(to.color[3]/=100,to.color[3]=Math.min(3*to.color[3],1)),this.tool=_extends({none:{},eraser:{height:90,width:75,cursor:"draw-eraser"},pencil:{color:[255,255,255,1],height:5,width:5,cursor:"draw-pencil"},chalk:{color:[255,255,255,1],height:15,width:15,cursor:"draw-chalk"}}[to.type],to),!0}}]),DrawingTools}(),PubblyDrawingTools=function(_DrawingTools){function PubblyDrawingTools(pubblyScope,defaultTool){var _this5;return _classCallCheck(this,PubblyDrawingTools),(_this5=_possibleConstructorReturn(this,_getPrototypeOf(PubblyDrawingTools).call(this,defaultTool)))._Pubbly=pubblyScope,_this5}return _inherits(PubblyDrawingTools,DrawingTools),_createClass(PubblyDrawingTools,[{key:"change",value:function(to){return!!_get(_getPrototypeOf(PubblyDrawingTools.prototype),"change",this).call(this,to)&&(this._Pubbly.data.drawingTool=to,!0)}}]),PubblyDrawingTools}();function Events(pubblyScope){var _Events=this,_Pubbly=pubblyScope,_pUnit=pubblyScope.data.info.width;this.enabled=!1,this.enable=function(){this.enabled=!0},this.disable=function(){this.enabled=!1},this.m={reset:function(){this.start=[],this.down=!1,this.lastMouseLocs=[],this.turning=!1,this.action=!1,this.dragging={},this.lining={}}},this.a={dragRevert:new function(){var _DragRevert=this;this.init=function(){this.endStamp=!1,this.interval=!1,this.what=!1,this.origOffsets=[],this.speed=200},this.clear=function(){this!==_DragRevert?_DragRevert.clear.call(_DragRevert):(window.clearInterval(this.interval),this.what.offsets=[0,0,0],"clone"==this.what.type&&(this.what.markedForDeletion=!0,_Pubbly.clearClones(),_Pubbly.drawPage_dispatch()),this.what={},_Pubbly.drawPage_dispatch())},this.animate=function(){this.interval=window.setInterval(function(){_DragRevert.animLeg.call(_DragRevert)},10)},this.animLeg=function(){var percent=(this.endStamp-now())/this.speed;percent<0?this.clear():void 0===this.what?this.clear.call(this):(this.what.offsets[0]=this.origOffsets[0]*percent,this.what.offsets[1]=this.origOffsets[1]*percent,_Pubbly.drawPage_dispatch())},this.init()},reset:function(){for(var anims in _Events.a)"function"==typeof _Events.a[anims].clear&&_Events.a[anims].clear()}},this.m.reset(),this.f={init:function(){this.elem=_Pubbly.dom.textEntryHidden,this.editing=!1,this.badKeys=[33,34,35,36,37,38,39,40,45,46],this.stringLimit=500,this.field=!1;var _FieldScope=this;this.elem.keydown(function(e){_FieldScope.type.call(_FieldScope,e)})},clear:function(){window.clearInterval(this.insertionBlink),this.field.editing=!1,this.field=!1,this.val="",this.insertionAt=0,this.elem.val(""),this.editing=!1,this.elem.blur()},edit:function(field,click){this.clear(),this.elem.val(field.contents),this.editing=!0,(this.field=field).editing=!0,this.elem.focus(),this.elem.focus(),this.val=field.contents;var relClick=[click[1]-this.field.loc[0],click[0]-this.field.loc[1]],insertStart={line:0,char:0,at:0};if(""!==this.field.contents&&this.field.calculated){_Pubbly.textCtx.font=this.field.calculated.size+"pt "+this.field.font;var lines=this.field.contents.toString().split("\n");insertStart.line=Math.floor(relClick[1]/this.field.calculated.lineHeight),insertStart.line=Math.min(insertStart.line,lines.length-1),insertStart.line=Math.max(insertStart.line,0);var str=lines[insertStart.line],lineLeft=0,strWidth=!1;"left"!==this.field.align&&(strWidth=_Pubbly.textCtx.measureText(str).width),"center"==this.field.align?lineLeft+=(this.field.width-strWidth)/2:"right"==this.field.align&&(lineLeft+=this.field.width-strWidth);var partialLen=0;insertStart.char=0;var charWidth=_Pubbly.textCtx.measureText("M").width;do{var partialStr=str.substring(0,insertStart.char);partialLen=_Pubbly.textCtx.measureText(partialStr).width,partialLen+=.6*charWidth,insertStart.char++}while(lineLeft+partialLen<relClick[0]&&insertStart.char<=str.length);insertStart.char--,insertStart.char=str.length;for(var l=0;l<insertStart.line;l++)insertStart.at+=lines[l].length+1;insertStart.at+=insertStart.char}this.insertionPoint.init(insertStart.at)},insertionPoint:{interval:!1,blinkTime:500,on:!1,blink:function(){_Pubbly.drawPage_dispatch(),this.on=!this.on},start:function(){var scope=this;window.clearInterval(this.interval),this.interval=window.setInterval(function(){scope.blink.call(scope)},this.blinkTime),this.on=!0,scope.blink.call(scope)},init:function(insertionAt){this.at=insertionAt;var input=pubbly.dom.textEntryHidden[0];if(input.setSelectionRange)input.focus(),input.setSelectionRange(this.at,this.at);else if(input.createTextRange){var range=input.createTextRange();range.collapse(!0),range.moveEnd("character",this.at),range.moveStart("character",this.at),range.select()}this.start()}},type:function(e){if(-1!==this.badKeys.indexOf(e.keyCode)||this.val.length>this.stringLimit-1)e.preventDefault();else{var _This=this;window.setTimeout(function(){_This.val=_This.elem.val(),_This.field.contents=_This.val+"","auto"==_This.field.size&&(_This.field.calculated.size=!1),_This.insertionPoint.at=_This.elem.prop("selectionStart"),_This.insertionPoint.start()},1)}}},this.f.init(),this.offsets={pageOffsetX:0,pageOffsetY:0},this.dragEventsBeforeTurnDetermination=5,this.getDir=function(speedArr){for(var consistantDir="",_i3=1;_i3<speedArr.length;_i3++){var newDir=0<speedArr[_i3][0]-speedArr[_i3-1][0]?"left":"right";""===consistantDir?consistantDir=newDir:consistantDir!==newDir&&(consistantDir=!1)}return consistantDir},this.cursor=new CursorInput,this.getLoc=this.cursor.getLoc,this.raw={move:function(e){0===e.buttons?this.raw.hover.call(this,e):this.m.interrupt=_Pubbly.states.checkInterruptionsAndSave(function(){_Events.raw.drag.call(_Events,e)})},hover:function(e){var loc=this.getLoc(e,this.offsets),caught=_Pubbly.checkLocFor(loc,["lineStarts","dragStarts","drawStarts","editableFields","clicks"]),cursor=!!caught[0]&&caught[0].action;_Pubbly.cursors.set(cursor,"hover")},drag:function(e){var loc=this.getLoc(e,this.offsets);if(this.m.lastMouseLocs.unshift(loc),"dragging"==this.m.action||"cloning"==this.m.action){_Pubbly.checkLocFor(loc,["dragStops"],this.m.dragging.what.name)[0]?_Pubbly.cursors.set("drop","drag"):_Pubbly.cursors.set("no-drop","drag");var offsets=[loc[1]-this.m.dragging.start[1],loc[0]-this.m.dragging.start[0],loc[2]-this.m.dragging.start[2]];!this.m.dragging.moved&&10<Math.abs(offsets[0])+Math.abs(offsets[1])&&(this.m.dragging.moved=!0),this.m.dragging.moved&&(this.m.dragging.what.offsets=offsets),_Pubbly.drawPage_dispatch()}else if("lining"==this.m.action)this.m.lining.end=loc,_Pubbly.drawPage_dispatch();else if(-1<["draw-chalk","draw-eraser","draw-marker","draw-pen","draw-pencil"].indexOf(this.m.action)){var _caught=_Pubbly.checkLocFor(loc,["drawStarts","clicks"])[0]||!1;if(_caught&&_caught.link&&-1<["draw-chalk","draw-eraser","draw-marker","draw-pen","draw-pencil"].indexOf(_caught.action)&&(!_Pubbly.drawingTools.drawCtx||_Pubbly.drawingTools.drawCtx===_caught.link.workspace.ctx)){var curObj=_caught.link,ctx=curObj.workspace.ctx,relLoc=[loc[0]-curObj.loc[1],loc[1]-curObj.loc[0]];_Pubbly.drawingTools.draw(ctx,relLoc),_Pubbly.drawPage_dispatch()}else"pencil"===_Pubbly.drawingTools.tool.type&&!1!==_Pubbly.drawingTools.temporaryDrawData.pencilPath[_Pubbly.drawingTools.temporaryDrawData.pencilPath.length-1]&&_Pubbly.drawingTools.temporaryDrawData.pencilPath.push(!1)}else if(this.m.lastMouseLocs.length>this.dragEventsBeforeTurnDetermination&&_Pubbly.data.info.navigation){if(this.m.lastMouseLocs.pop(),!this.m.turning){var tmpDir=this.getDir(this.m.lastMouseLocs);tmpDir&&(this.m.turning=tmpDir)}if(this.m.turning){this.m.action="turning";var cur=this.m.lastMouseLocs[0][0],start=this.m.start[0],percent="left"==this.m.turning?1-cur/_pUnit:(cur-start)/(_pUnit-start);percent=Math.max(percent,0),percent=Math.min(percent,1),_Pubbly.turns.handlers.set.call(_Pubbly.turns,this.m.turning,percent)}}},down:function(e){this.m.interrupt=_Pubbly.states.checkInterruptionsAndSave(function(){_Events.raw.check.call(_Events,e)})},check:function(e){var loc=this.getLoc(e,this.offsets);this.m.down=!0,this.m.start=loc,this.f.editing&&this.f.clear();var caught=_Pubbly.checkLocFor(loc,["lineStarts","dragStarts","drawStarts","editableFields","clicks"])[0]||!1,cursorLibrary="default",cursorAction=caught.action;if("drag"===caught.action||"clone"===caught.action)cursorLibrary="drag",this.m.action="drag"==caught.action?"dragging":"cloning",caught="cloning"==this.m.action?_Pubbly.makeClone(caught.link):caught.link,this.m.dragging={what:caught,start:loc,moved:!1},!0===this.m.dragging.what.frontDrag&&_Pubbly.sendToTop.call(_Pubbly,caught),caught.offsets=[0,0,0],caught.droppedLoc&&(this.m.dragging.start[0]-=caught.droppedLoc[1]-caught.loc[1],this.m.dragging.start[1]-=caught.droppedLoc[0]-caught.loc[0]),this.m.dragging.what.droppedLoc=!1,this.a.dragRevert.what==caught&&this.a.dragRevert.clear();else if("single"===caught.action||"multiple"===caught.action){cursorLibrary="line";var startLoc=[loc[1],loc[0]];!1,this.m.action="lining","single"!=caught.action&&void 0!==caught.link.lines||(caught.link.lines=[]),caught.link.lines.push({start:[startLoc[1],startLoc[0]],end:[startLoc[1],startLoc[0]],name:caught.link.name+""}),this.m.lining=caught.link.lines[caught.link.lines.length-1],_Pubbly.drawPage_dispatch()}else-1<["draw-chalk","draw-eraser","draw-marker","draw-pen","draw-pencil"].indexOf(caught.action)?(this.m.action=caught.action,_Pubbly.drawPage_dispatch()):"editText"===caught.action&&this.f.edit(caught.link,loc);_Pubbly.cursors.set(cursorAction,cursorLibrary)},up:function(e){if(this.m.down){if(!_Pubbly.sequence.running){var loc=this.getLoc(e,this.offsets),caught=!1;if("turning"==this.m.action)this.getDir(this.m.lastMouseLocs)==this.m.turning?_Pubbly.turns.handlers.end.call(_Pubbly.turns,this.m.turning):_Pubbly.turns.handlers.reset.call(_Pubbly.turns);else if("dragging"==this.m.action||"cloning"==this.m.action)if(this.m.dragging.moved)if((caught=_Pubbly.checkLocFor(loc,"dragStops",this.m.dragging.what.name))[0]){var what=this.m.dragging.what;if(_Pubbly.data.info.snapDrops){var polyCenter=centerOfPoly(caught[0].link.poly);this.m.dragging.what.droppedLoc=[polyCenter[0]-what.height/2,polyCenter[1]-what.width/2]}else this.m.dragging.what.droppedLoc=[what.loc[0]+what.offsets[0],what.loc[1]+what.offsets[1]];what.offsets=!1,_Pubbly.drawPage_dispatch()}else this.a.dragRevert.clear(),this.a.dragRevert.endStamp=now()+this.a.dragRevert.speed,this.a.dragRevert.what=this.m.dragging.what,this.a.dragRevert.origOffsets=[1*this.m.dragging.what.offsets[0],1*this.m.dragging.what.offsets[1]],this.a.dragRevert.animate();else"cloning"===this.m.action&&(this.m.dragging.what.markedForDeletion=!0,_Pubbly.clearClones(),_Pubbly.drawPage_dispatch());else"lining"==this.m.action?(caught=_Pubbly.checkLocFor(loc,"lineStops",this.m.lining.name))[0]?_Pubbly.data.info.snapLinesToCenter&&(this.m.lining.end=centerOfPoly(caught[0].link.poly)):(this.m.lining.start=!1,this.m.lining.end=!1,this.m.lining.markedForDeletion=!0,_Pubbly.clearLines(),_Pubbly.drawPage_dispatch()):-1<["draw-chalk","draw-eraser","draw-marker","draw-pen","draw-pencil"].indexOf(this.m.action)?_Pubbly.drawingTools.drawStop():(caught=_Pubbly.checkLocFor(loc,"clicks"))[0];caught[0]&&(_Pubbly.sequence.startNew(caught[0],this.m.action),caught[0].link.clickHighlight&&(caught[0].link.clickHighlightOn=!0,_Pubbly.drawPage_dispatch(),window.setTimeout(function(){caught[0].link.clickHighlightOn=!1,_Pubbly.drawPage_dispatch()},_Pubbly.data.info.HighlightLinkTime)))}this.m.reset()}}},function(){var moveHandler=function(e){e.preventDefault(),_Events.enabled&&_Events.raw.move.call(_Events,e)},downHandler=function(e){e.preventDefault(),_Events.enabled&&_Events.raw.down.call(_Events,e)},upHandler=function(e){e.preventDefault(),_Events.enabled&&_Events.raw.up.call(_Events,e)};["mousemove","touchmove"].forEach(function(e){_Pubbly.dom.canvases[0].addEventListener(e,moveHandler,!1)}),["mousedown","touchstart"].forEach(function(e){_Pubbly.dom.canvases[0].addEventListener(e,downHandler,!1)}),["mouseup","mouseout","touchend"].forEach(function(e){_Pubbly.dom.canvases[0].addEventListener(e,upHandler,!1)}),$("#header .navigationUI .previous img").click(function(){$(this).parent().hasClass("disabled")||_Pubbly.states.checkInterruptionsAndSave(function(){_Pubbly.turns.handlers.auto.left()})}),$("#header .navigationUI .next img").click(function(){$(this).parent().hasClass("disabled")||_Pubbly.states.checkInterruptionsAndSave(function(){_Pubbly.turns.handlers.auto.right()})}),$("#header .navigationUI .goto select").mousedown(function(e){$(this).parent().hasClass("disabled")&&(e.preventDefault(),this.blur(),window.focus())}),$("#header .navigationUI .goto select").change(function(){if(!$(this).parent().hasClass("disabled")){var newPage=this.selectedIndex;_Pubbly.states.checkInterruptionsAndSave(function(){newPage!==_Pubbly.curPage&&_Pubbly.changeCurPage_dispatch.call(_Pubbly,newPage)})}})}.call(this)}function CursorInput(){this.getLoc=function(e,offsets){return e.changedTouches&&e.changedTouches[0]&&e.changedTouches[0].pageX?[e.changedTouches[0].pageX+offsets.pageOffsetX,e.changedTouches[0].pageY+offsets.pageOffsetY,now()]:e.offsetX?[e.offsetX+offsets.pageOffsetX,e.offsetY+offsets.pageOffsetY,now()]:(console.warn("Can't get touch or mouse loc"),[!1,!1,now()])}}function Links(pubblyScope){var _Pubbly=pubblyScope;this.testing={outlineAllLinksOnPage:function(p){null===p&&(p=_Pubbly.curPage);for(var l=0;l<this.links[p].length;l++);}},this.getLinksOnPage=function(){for(var curPage=0<arguments.length&&void 0!==arguments[0]?arguments[0]:_Pubbly.curPage,links=[],graphicLinks=_Pubbly.data.pages[curPage].links.graphic,l=0;l<graphicLinks.length;l++)links.push(graphicLinks[l]);return links},this.checkLocForLinks=function(loc,priority){for(var curPage=2<arguments.length&&void 0!==arguments[2]?arguments[2]:_Pubbly.curPage,caught=[],links=this.getLinksOnPage(curPage),l=0;l<links.length;l++){var link=links[l];inside(loc,link.poly)&&caught.push(link)}return!!(caught=caught.filter(function(link){return!!link.enabled&&link}))[0]&&caught[0]},this.init=function(){for(var p=0;p<_Pubbly.data.pages.length;p++)_Pubbly.data.pages[p]},this.init()}function NavigationUI(buildSpecs,container){this.specs={display:"",bookLength:0,initShown:!0,initEnabled:!0,startPage:0,lastPageSpread:!0},this.elems={cont:!1,next:!1,prev:!1,goto:!1,gotoSelect:!1,gotoCover:!1},this.getCurPageString=function(updatePage){if(0==updatePage)return"COVER";if("composite"!==this.specs.display)return updatePage;if(updatePage!=this.specs.bookLength-1||this.specs.lastPageSpread){var firstNum=2*updatePage;return firstNum+"-"+(1+firstNum)}return 2*(this.specs.bookLength-1)},this.enable=function(){$(".navigationUI .next").removeClass("disabled"),$(".navigationUI .goto").removeClass("disabled"),$(".navigationUI .previous").removeClass("disabled")},this.disable=function(){$(".navigationUI .next").addClass("disabled"),$(".navigationUI .goto").addClass("disabled"),$(".navigationUI .previous").addClass("disabled")},this.hide=function(){$(".navigationUI").css("display","none")},this.show=function(){$(".navigationUI").css("display","inline-block")},this.update=function(newPage){$(".goto p.cover").html(this.getCurPageString(newPage)),$(".goto select option:selected")[0]&&$(".goto select option:selected")[0].removeAttribute("selected"),$(".goto select option.page_"+newPage)[0]&&$(".goto select option.page_"+newPage)[0].setAttribute("selected",""),newPage+1==this.specs.bookLength?$(".navigationUI .next").addClass("noTurn"):$(".navigationUI .next").removeClass("noTurn"),0==newPage?$(".navigationUI .previous").addClass("noTurn"):$(".navigationUI .previous").removeClass("noTurn")},this.init=function(){var errMessage="";for(var prop in this.specs)void 0===buildSpecs[prop]?errMessage+="Missing buildSpecs property '"+prop+"'\r\n":this.specs[prop]=buildSpecs[prop];if(""!==errMessage)error("fatal","navigationUI",errMessage+"\r\nCheck top of constructor for how to init");else{this.specs.display=buildSpecs.display,this.specs.length=buildSpecs.bookLength;for(var options="<option class='page_0'>COVER</option>",p=1;p<this.specs.bookLength;p++)options+="\r\n<option class='page_"+p+"'>"+this.getCurPageString(p)+"</option>";container.append("\n<div class='navigationUI'>\n    <div class='previous'>\n        <img />\n    </div>\n    <div class='goto'>\n        <p class='cover'>COVER</p>\n        <select class='dropdown'>\n            ".concat(options,"\n        </select>\n    </div>\n    <div class='next'>\n        <img />\n    </div>\n</div>")),this.elems.cont=container.find(".navigationUI"),buildSpecs.initShown||this.hide(),this.update(this.specs.startPage),this.disable()}},this.init()}var PubblyPresetAssets=function(){function PubblyPresetAssets(rootToEngine){_classCallCheck(this,PubblyPresetAssets),this.list=[],this.loader=new AssetListLoader,this.load=this.loader.load.bind(this.loader,this.list),this.add({type:"image",relPath:rootToEngine+"assets/texture_blackboard.png"}),this.add({type:"image",relPath:rootToEngine+"assets/cursor_pencil.png"}),this.add({type:"image",relPath:rootToEngine+"assets/cursor_chalk.png"}),this.add({type:"image",relPath:rootToEngine+"assets/cursor_eraser.png"}),this.add({type:"image",relPath:rootToEngine+"assets/cursor_pencil.png"}),this.add({type:"image",relPath:rootToEngine+"assets/logo_fill_letters.png"})}return _createClass(PubblyPresetAssets,[{key:"add",value:function(asset){this.list.push(asset)}}]),PubblyPresetAssets}();function Sq_Player(type,scopes,callbacks,target){var _This=this;for(var c in this._Sequence=scopes[0],this._Pubbly=scopes[1],this.logName,this.target=target,this.readied=!1,this.ready=function(){this.readied=!0,this.ready_child&&this.ready_child(),_This.callAll.call(_This,"readied")},this.playing=!1,this.play=function(){this.playing||(this.play_child&&this.play_child(),this.callAll.call(this,"playing"),this.playing=!0)},this.finished=!1,this.finish=function(){this.finished||(this.finished=!0,this.playing=!1,this.finish_child&&this.finish_child(),this.callAll.call(this,"finished"))},this.killed=!1,this.kill=function(){this.killed||(this.killed=!0,this.playing=!1,this.finished=!1,this.kill_child&&this.kill_child(),this.callAll.call(this,"killed"))},this.errored=!1,this.error=function(){this.playing=!1,this.finished=!1,this.errored=!0,this.error_child&&this.error_child(),_This.callAll.call(_This,"errored")},this.cbs={readied:[],playing:[],finished:[],killed:[],errored:[]},this.cbs)callbacks&&callbacks[c]&&this.cbs[c].push(callbacks[c]);this.callAll=function(what){var callBacksToCallBack=this.cbs[what];if(callBacksToCallBack.length)for(var _c2=0;_c2<callBacksToCallBack.length;_c2++)callBacksToCallBack[_c2].call(this)},this.postTarget=function(){_This._Sequence.postTarget.call(_This._Sequence,_This.target)},Sq_Players_Child[type]?(this.buildChild=Sq_Players_Child[type],this.buildChild()):error("fatal","sequence player","Unknown player subtype of "+type)}var Sq_Players_Child={animation:function(){var _This=this;this.obj=this._Pubbly.find(this.target.chosenDestination,"object"),this.obj.animations.playing=this.target.value,this.obj.animations.at=0,this.obj.animations.end=this.obj.animations[this.target.value].totTime,this.play_child=function(){this.obj.animations.startTime=now(),this._Pubbly.redrawDependency.add(this),this.animInt=window.setInterval(function(){_This.obj.animations.at=now()-_This.obj.animations.startTime,_This.obj.animations.at>_This.obj.animations.end&&_This.finish()},10)},this.finish_child=function(){window.clearInterval(this.animInt),this.obj.animations.at=this.obj.animations.end;var objProps=this._Pubbly.getRealObjDescription(_This.obj);this.obj.height=objProps.height,this.obj.width=objProps.width,this.obj.loc=[objProps.top,objProps.left],this.obj.opacity=objProps.opacity,this.obj.layer=objProps.layer,this.obj.angle=objProps.angle||0,this.obj.droppedLoc&&(this.obj.droppedLoc=this.obj.loc),this.obj.animations.playing=!1,this._Pubbly.redrawDependency.remove(this)},this.kill_child=function(){window.clearInterval(this.animInt),this._Pubbly.redrawDependency.remove(this)},this.logName="Animation: "+this.obj.name+" -> "+this.target.value},audio:function(){var _This=this,audioName=this.target.chosenDestination,pageIdent=this._Pubbly.curPage,audEntry=this._Pubbly.data.pages[pageIdent].auds.find(function(aud){return aud.name==audioName});audEntry.fSrc?this.elem=this._Pubbly.pageBuffer.assetListLoaders[pageIdent].byFileSource[audEntry.fSrc].elem:this.elem=this._Pubbly.pageBuffer.assetListLoaders[pageIdent].byFileName[audEntry.fName].elem,this.on_canplay=function(){_This.elem.removeEventListener("canplaythrough",_This.on_canplay),_This.ready()},this.on_playing=function(){_This.elem.removeEventListener("playing",_This.on_playing),_This.play()},this.on_ended=function(){_This.elem.removeEventListener("ended",_This.on_ended),_This.finish()},this.on_error=function(){_This.elem.removeEventListener("error",_This.on_error),_This.error()},this.play_child=function(){this.elem.volume=this._Pubbly.runtimeProps.masterVolume||1,this.elem.play()},this.finish_child=function(){_This.elem.removeEventListener("ended",_This.on_ended),this.elem.preload=!1,this.elem.pause&&this.elem.pause(),this.elem.currentTime=0,this.elem.volume=0},this.kill_child=function(){this.finish_child()},this.cbs.readied.push(this.play_child),this.elem.addEventListener("canplaythrough",this.on_canplay,!1),this.elem.addEventListener("playing",this.on_playing,!1),this.elem.addEventListener("ended",this.on_ended,!1),this.elem.addEventListener("error",this.on_error,!1),4==this.elem.readyState?this.on_canplay():this.elem.load(),this.logName="Audio: "+this.target.chosenDestination},flash:function(){var _This=this;this.objs=this._Pubbly.findAll(this.target.chosenDestination,"object"),this.flashInt=100,this.states=[],"flashon"!==this.target.action&&(error("log","sequence","unknown flash action of "+this.target.action+". Defaulting to flashon"),this.target.action="flashon");var last=!1;this.objs[0].vis&&this.states.push(!1);for(var _i4=0;_i4<2*this.target.num-1;_i4++)this.states.push(!last),last=!last;this.play_child=function(){this.flashInt=window.setInterval(function(){var newState=_This.states.shift();_This.objs.map(function(obj){obj.vis=newState}),_This._Pubbly.drawPage_dispatch(),_This.states.length||_This.finish()},this.target.stateChangeInterval)},this.finish_child=function(){window.clearInterval(this.flashInt)},this.kill_child=function(){window.clearInterval(this.flashInt)},this.logName="Flash: "+this.target.chosenDestination},gif:function(){var _This=this;this.drawInt=!1,this.loopsLeft=1*this.target.loops,this.play_child=function(){this.elem.currentTime=0,$("#assetVisitorCenter").append(this.elem),_This._Pubbly.redrawDependency.add(this),this.elem.play()},this.finish_child=function(){_This._Pubbly.redrawDependency.remove(this),this.elem.pause()},this.kill_child=function(){_This._Pubbly.redrawDependency.remove(this),this.elem.pause(),this.elem.removeEventListener("canPlayThrough",this.on_canplay),this.elem.removeEventListener("playing",this.on_playing),this.elem.removeEventListener("ended",this.on_ended),this.elem.removeEventListener("error",this.on_error)},this.on_canplay=function(){_This.elem.removeEventListener("canPlayThrough",_This.on_canplay),_This.play()},this.on_ended=function(){_This.elem.removeEventListener("ended",_This.on_ended),_This.loopsLeft--,_This.loopsLeft?(this.currentTime=0,this.play()):_This.finish()},this.on_error=function(err){_This.elem.removeEventListener("error",_This.on_error),_This.error()},this.elem=this._Pubbly.buffer.assets[this.target.chosenDestination+".mp4"].elem,this.elem.addEventListener("canplaythrough",this.on_canplay,!1),this.elem.addEventListener("ended",this.on_ended,!1),this.elem.addEventListener("error",this.on_error,!1),this.logName="Gif: "+this.target.chosenDestination},sequence:function(){var _This=this;this.drawInt=!1,this.loopsLeft=1*this.target.loops,this.obj=_This._Pubbly.find(this.target.chosenDestination,"object"),this.obj.at=0,this.frames=this.obj.frames,this.framerate=this.target.framerate,this.play_child=function(){_This._Pubbly.redrawDependency.add(this),_This.drawInt=window.setInterval(function(){if(_This.obj.at+2>_This.frames.length)if(_This.loopsLeft--,0<_This.loopsLeft)_This.obj.at=0;else{_This.obj.at=0,_This.finish()}else _This.obj.at++},1e3/_This.framerate)},this.finish_child=function(){window.clearInterval(_This.drawInt),_This._Pubbly.redrawDependency.remove(_This)},this.kill_child=function(){window.clearInterval(_This.drawInt),_This._Pubbly.redrawDependency.remove(_This)},this.logName="Img Sequence: "+this.target.chosenDestination},wait:function(){var _This=this;this.timeout=window.setTimeout(function(){_This.finish()},1e3*this.target.chosenDestination),this.finish_child=function(){window.clearTimeout(this.timeout)},this.kill_child=function(){window.clearTimeout(this.timeout)},this.logName="Wait: "+1e3*this.target.chosenDestination},video:function(){var _This=this;this.obj=this._Pubbly.find(this.target.chosenDestination,"video"),this.elem=this._Pubbly.pageBuffer.assetListLoaders[this._Pubbly.curPage].byFileName[this.obj.fileName].elem,this.kill_child=function(){this.elem.pause(),this.elem.currentTime=0},this._Pubbly.redrawDependency.add(this),this.on_canplay=function(){_This.elem.removeEventListener("canplaythrough",_This.on_canplay),_This.elem.play()},this.on_playing=function(){_This.elem.removeEventListener("playing",_This.on_playing),_This.elem.volume=1,_This.play()},this.on_ended=function(){_This.elem.removeEventListener("ended",_This.on_ended),_This.elem.currentTime=0,_This.elem.volume=0,_This.finish()},this.on_error=function(){_This.elem.removeEventListener("error",_This.on_error),_This.error()},this.elem.addEventListener("canplaythrough",this.on_canplay,!1),this.elem.addEventListener("playing",this.on_playing,!1),this.elem.addEventListener("ended",this.on_ended,!1),this.elem.addEventListener("error",this.on_error,!1),4===this.elem.readyState?this.on_canplay():this.elem.load()},spokenfield:function(){var _This=this;this.syncInt=!1,this.sentenceBreakTimeout=!1;var auds,pageIdent=this._Pubbly.curPage,curPage=this._Pubbly.data.pages[pageIdent],pub=this._Pubbly;this.audios=[],auds="object"==_typeof(this.target.chosenDestination)&&this.target.chosenDestination.length?this.target.chosenDestination:[this.target.chosenDestination],this.audios=auds.map(function(audioName){var audEntry=curPage.auds.find(function(aud){return aud.name==audioName});return audEntry.fSrc?pub.pageBuffer.assetListLoaders[pageIdent].byFileSource[audEntry.fSrc].elem:pub.pageBuffer.assetListLoaders[pageIdent].byFileName[audEntry.fName].elem}),this.sentences=[],this.sentenceToField={};var fieldToCleanSentences=function(field){var paragraph=field.contents;for(i=0;i<paragraph.split(".").length;i++){var clean=paragraph.split(".")[i].replace(/(\r\n|\n|\r)/gm," ");""!==(clean=(clean=clean.replace(/  /g,"")).trim())&&(this.sentenceToField[this.sentences.length]=field.name,this.sentences.push(clean))}}.bind(this);if("object"==_typeof(this.target.value)&&this.target.value.length)this.target.value.map(function(fieldName){var field=pub.find(fieldName,"field");fieldToCleanSentences(field)});else{var field=pub.find(this.target.value,"field");fieldToCleanSentences(field)}this.audios.length!==this.sentences.length?(alert("Error: The number of audio files does not match the number of sentences to highlight. Spoken fields must have an equal number of sentences and audio files"),this.callAll("errored")):(this.curSentenceI=-1,this.nextSentence=function(){if(this.curSentenceI++,this.audios[this.curSentenceI]){if(this.curAudio=this.audios[this.curSentenceI],this.curSentence=this.sentences[this.curSentenceI],this.curField=this._Pubbly.find(this.sentenceToField[this.curSentenceI],"field"),4==this.curAudio.readyState)this.prepSync();else{var playingListener=function(){this.curAudio.removeEventListener("playing",playingListener),this.prepSync()}.bind(this);this.curAudio.addEventListener("playing",playingListener,!1)}var endedListener=function(){this.curAudio.removeEventListener("ended",endedListener),window.clearInterval(this.syncInt),this.curAudio.pause(),this.curAudio.currentTime=0,this.curAudio.volume=0;var silence=100*this.curMarkers.shift();this.sentenceBreakTimeout=window.setTimeout(function(){this.curField.highlight.wordNum=!1,this.nextSentence()}.bind(this),silence)}.bind(this);this.curAudio.addEventListener("ended",endedListener,!1),this.curAudio.play()}else this._Pubbly.drawPage_dispatch(),this.finish_child()}.bind(this),this.prepSync=function(){this.curMarkers=[];var words=this.curSentence.split(" ");this.curAudio.duration,words.length;this.curMarkers=getSpokenFieldTimes(this.curAudio,words);for(var _i5=this.priorWordCount=0;_i5<this.curSentenceI;_i5++)this.sentenceToField[_i5]===this.curField.name&&(this.priorWordCount+=this.sentences[_i5].split(" ").length);this.curField.highlight.wordNum=this.priorWordCount,this.startSync()},this.startSync=function(){this._Pubbly.drawPage_dispatch(),this.curAudio.volume=1,this.syncInt=window.setInterval(function(){this.curAudio.currentTime>=this.curMarkers[0]&&(this.curMarkers.shift(),this.curField.highlight.wordNum++,this._Pubbly.drawPage_dispatch())}.bind(this),10)},this.finish_child=function(){window.clearInterval(this.syncInt),window.clearTimeout(this.sentenceBreakTimeout),this.curField.highlight.wordNum=!1,_This.curAudio&&_This.curAudio.pause&&_This.curAudio.pause(),_This.curAudio.currentTime=0,_This.curAudio.volume=0},this.kill_child=function(){this.finish_child()},this.logName="Spoken Field: "+this.sentences.join(". "),this.playing=!0,this.nextSentence())}};function Sequence(pubblyScope){var _Pubbly=pubblyScope,_Sequence=this;this.show=_Pubbly.runtimeProps.showSequence||!1,this.running=!1,this.players={waits:[],audios:[],animations:[],flashes:[],gifs:[],sequences:[],countdowns:[],videos:[],spokenfields:[]},this.targets=[],this.nextTarget=function(){if(this.running){var target=this.targets.shift();if(target)this.preTarget(target);else{this.preTarget({hold:"all",type:"finishSequence"})}}},this.preTarget=function(target){target.hold?this.waitFor(target,target.hold,function(){this.runTarget(target)}):this.runTarget(target)},this.runTarget=function(target){if(target.chosenDestination=target.destination,target.random){var options=target.random.options.slice();if("send"===target.type&&(options=options.filter(function(linkName){return _Pubbly.find(linkName,"link").enabled})),0===options.length)console.warn("All links in random send list are disabled"),target.type="skip";else{var num=rand(options.length-1);if(target.chosenDestination=options[num],target.random.removeChoice){var at=target.random.options.indexOf(target.chosenDestination);target.random.options.splice(at,1);1===options.length&&(target.random.options=target.random.init.options.slice())}}}var autoPost=!0,autoDraw=!1,obj=!1;this.show,console.log(""+JSON.stringify(target));var targType=target.type;switch(void 0!==target.run&&(target.run>=target.runLimit?targType="skip":target.run++),targType){case"drawing tool":var tool={type:target.chosenDestination,color:target.value,width:target.width,height:target.height};_Pubbly.drawingTools.change(tool);break;case"animation":var animation=new Sq_Player("animation",[_Sequence,_Pubbly],{},target);target.player={name:"animations",loc:this.players.animations.length},this.players.animations.push(animation),animation.play();break;case"audio":autoPost=!1;var aud=new Sq_Player("audio",[_Sequence,_Pubbly],{playing:function(){this.postTarget()},error:function(){this.postTarget()}},target);target.player={name:"audios",loc:this.players.audios.length},this.players.audios.push(aud);break;case"video":autoPost=!1;var vid=new Sq_Player("video",[_Sequence,_Pubbly],{playing:function(){this.postTarget()},error:function(){this.postTarget()}},target);target.player={name:"videos",loc:this.players.videos.length},this.players.videos.push(vid);break;case"spokenfield":autopost=!1;var sfld=new Sq_Player("spokenfield",[_Sequence,_Pubbly],{playing:function(){this.postTarget()},error:function(){this.postTarget()}},target);target.player={name:"spokenfields",loc:this.players.spokenfields.length},this.players.spokenfields.push(sfld);break;case"flash":if(obj=_Pubbly.find(target.chosenDestination,"object")){var flash=new Sq_Player("flash",[_Sequence,_Pubbly],{},target);target.player={name:"flashes",loc:this.players.flashes.length},this.players.flashes.push(flash),flash.play()}break;case"log":"function"==typeof console[target.action]?console[target.action]("SEQUENCE LOG: "+target.value):"alert"==target.action?window.alert("SEQUENCE ALERT: "+target.value):console.log("LOG: "+target.value);break;case"send":var targets=target.passive=!1,link=(_Pubbly.data,_Pubbly.find(target.chosenDestination,"link"));link&&link.triggers[plurals[target.action]]&&link.enabled&&("click"==target.action?targets=link.triggers[plurals[target.action]][0].targets:target.action),targets?this.addTargets(targets):error("log","sequence","No targets to add");break;case"point":autoDraw=!0;var pointLoc,localCheck=_Pubbly.data.pages[_Pubbly.curPage].points,globalCheck=_Pubbly.data.points;if(void 0===localCheck[target.chosenDestination]&&void 0===globalCheck[target.chosenDestination])console.log("warn","sequence","Uninitiated point value");else switch(-1===(pointLoc=void 0===localCheck[target.chosenDestination]?globalCheck:localCheck).changed.indexOf(target.chosenDestination)&&pointLoc.changed.push(target.chosenDestination),target.action){case"+":pointLoc[target.chosenDestination]+=target.value;break;case"-":pointLoc[target.chosenDestination]-=target.value;break;case"*":pointLoc[target.chosenDestination]*=target.value;break;case"/":pointLoc[target.chosenDestination]/=target.value;break;case"=":pointLoc[target.chosenDestination]=target.value;break;default:autoDraw=!1,error("log","Sequence","Unknown point modification of "+target.action)}break;case"finishSequence":this.finish();break;case"propertyChange":var things=[];things="all links"===target.destination?_Pubbly.data.pages[_Pubbly.curPage].links:"all objects"===target.destination?_Pubbly.data.pages[_Pubbly.curPage].objs:void 0===target.destination.pop?target.chosenDestination!==target.destination?[target.chosenDestination]:[target.destination]:target.destination.slice();var foundList=[];things.map(function(thing){var things=!1;(things="object"===_typeof(thing)?_Pubbly.findAll(thing):_Pubbly.findAll(thing,target.destinationType))&&(foundList=foundList.concat(things))});for(var t=0;t<foundList.length;t++){var thing=foundList[t];if(void 0!==thing[target.attribute])thing[target.attribute]=target.value;else if("center"===target.attribute&&"object"===target.destinationType){var objDesc=_Pubbly.getRealObjDescription(thing);thing.loc=[target.value.y-objDesc.height/2,target.value.x-objDesc.width/2],thing.droppedLoc&&delete thing.droppedLoc}else console.error("Unknown "+target.destinationType+"property of "+target.attribute)}!1!==target.autoDraw&&(autoDraw=!0);break;case"gif":if(obj=_Pubbly.find(target.chosenDestination,"object")){var gif=new Sq_Player(obj.type,[_Sequence,_Pubbly],{},target);target.player={name:"gifs",loc:this.players.gifs.length},this.players[plurals[obj.type]].push(gif),gif.play()}break;case"wait":if("waits"==target.blocking){var wait=new Sq_Player("wait",[_Sequence,_Pubbly],{},target);target.player={name:"waits",loc:this.players.waits.length},this.players.waits.push(wait),wait.play()}break;case"countdown":"function"==typeof _Pubbly.countdown[target.action]?_Pubbly.countdown[target.action](target.value):console.error("Unknown countdown target action "+target.action);break;case"reset":autoDraw=!0;var resetType=target.action.split(" ")[0],searchStarts=[];"object"==resetType?searchStarts=_Pubbly.findAll(target.destination,"object"):"link"==resetType?searchStarts=_Pubbly.findAll(target.destination,"link"):"page"==resetType&&(searchStarts=[_Pubbly.data.pages[_Pubbly.curPage]]);searchStarts.map(function(s){return function reset(level){var init=level.init;for(var prop in level)init&&void 0!==init[prop]?level[prop]=dupeAnyType(init[prop]):"object"===_typeof(level[prop])&&null!==level[prop]&&("Object"!==level.constructor.name&&"Array"!==level.constructor.name||reset(level[prop]))}(s)}),_Pubbly.clearClones();break;case"navigation":"navigate"==target.action&&("pubbly"==target.destination?"relative"==target.attribute?"next"==target.value?_Pubbly.turns.handlers.auto.right():"previous"==target.value?_Pubbly.turns.handlers.auto.left():error("warn","sequence","Unknown navigation value: "+target.value):"absolute"==target.attribute?_Pubbly.updatePage.call(_Pubbly,target.value):error("warn","sequence","Unknown navigation attribute: "+target.attribute):"browser"==target.destination&&_Pubbly.urlNav.go(target.value,target.attribute));break;case"info":"set"==target.action&&_Pubbly.data.info[target.destination]?(_Pubbly.data.info[target.destination]=target.value,"navigation"==target.destination&&(target.value?_Pubbly.navigationUI.show():_Pubbly.navigationUI.hide())):(console.warn("Unknown set type: "),console.warn(""+JSON.stringify(target)));break;case"skip":break;default:console.warn("Unknown target: "),console.warn(""+JSON.stringify(target))}autoDraw&&_Pubbly.drawPage_dispatch(),autoPost&&this.postTarget(target)},this.postTarget=function(target){window.testing&&target.id==_Pubbly.runtimeProps.stopAtTarget?console.warn("stopAtTarget set and met. HODLING!!"):target.blocking?this.waitFor(target,target.blocking,function(){this.nextTarget()}):this.nextTarget()},this.waitFor=function(target,what,cb){var waits=this.getPlayers(what);(function nextWait(){var cur=waits.shift();cur?function(what,cb){var waits=0;function finished(){--waits<=0&&cb.call(_Sequence)}var waitLog="Waiting for ";if(this.players[what])for(var w=0;w<this.players[what].length;w++)this.players[what][w].finished||(waits++,this.players[what][w].cbs.finished.push(finished),waitLog+=this.players[what][w].logName+", ");else"self"==what?target.player&&!target.player.finished&&(waits++,this.players[target.player.name][target.player.loc].cbs.finished.push(finished),waitLog+="self, "):error("log","sequence","Unknown wait of "+what+", skipping.");0==waits?cb.call(_Sequence):this.show&&console.log(waitLog)}.call(this,cur,nextWait):cb.call(this)}).call(this)},this.getPlayers=function(what){var ret=[];if("object"==_typeof(what))for(var w=0;w<what.length;w++)this.players[what[w]]?ret.push(what[w]):"self"==what[w]?ret.push("self"):console.error("Unknown player type "+what[w]);else if("all"==what)for(var player in this.players)ret.push(player);else"undefined"!==this.players[what]&&(ret=[what]);return 0==ret.length&&console.error("Unknown wait of "+what+", calling back immediately"),ret},this.startNew=function(link,trigger,loc){this.linkName=link.name,_Pubbly.analytics&&_Pubbly.analytics.add({type:"st",linkname:this.linkName}),this.running&&this.kill(),trigger.run++,this.start(link,trigger,loc)},this.start=function(caught){if(_Pubbly.ready){_Pubbly.analytics&&_Pubbly.analytics.add({type:"ss",linkname:this.linkName}),!1===_Pubbly.data.info.interrupt&&_Pubbly.navigationUI.disable();var link=caught.link,action=caught.action,loc=caught.loc;this.show&&console.log(link.name+" starting");var targets=link.triggers[action][loc].targets;targets?(this.addTargets(targets),this.running=!0,this.nextTarget()):console.error("Bad stuff check here")}else console.info("Triggered sequence but pubbly not loaded... ignored")},this.addTargets=function(targets){for(var t=0;t<targets.length;t++)this.targets.push(targets[t])},this.finish=function(){_Pubbly.runtimeProps.saveStates&&_Pubbly.states.save(),_Pubbly.navigationUI.enable(),this.kill_players(),this.targets=[],this.show&&console.log(" -- Sequence finished -- "),_Pubbly.analytics&&_Pubbly.analytics.add({type:"sf",linkname:this.linkName}),window.setTimeout(function(){_Pubbly.checkPageFor("points")},1)},this.kill=function(){this.kill_players(),this.targets=[],_Pubbly.checkPageFor("points")},this.kill_players=function(){var stops=this.getPlayers("all");for(var pt in this.running=!1,stops){for(var player=stops[pt],p=0;p<this.players[player].length;p++)this.players[player][p].playing&&this.players[player][p].kill(),this.players[player][p]=null,delete this.players[player][p];this.players[player]=[]}},this.init=function(){},this.init()}function getSpokenFieldTimes(aud,words){var ret=[],sylls=[];words.forEach(function(word){var syllC=syll_count(word);sylls.push(syllC)}),sylls=sylls.map(function(syll,i){return 4<=syll&&(syll*=.9),1<words[i].split(",").length&&(syll+=2),words[i].length<=3&&(syll=.7),syll});var totalChunks=0;sylls.forEach(function(syllC){totalChunks+=syllC}),totalChunks++;var chunkLength=aud.duration/totalChunks,accumulator=0;return sylls.forEach(function(syllC){accumulator+=chunkLength*syllC,ret.push(accumulator)}),ret[ret.length-1]=accumulator+3*chunkLength,ret}function syll_count(word){word=word.toLowerCase();var exceptionLength=0,baseWord=word;[["every",2],["where",1],["ing",1],["alive",2]].map(function(item){var split=baseWord.split(item[0]);1<split.length&&(exceptionLength+=(split.length-1)*item[1],baseWord=split.filter(function(i){return""!==i}).join(""))});var match=(baseWord=(baseWord=baseWord.replace(/(?:[^laeiouy]es|ed|[^laeiouy]e)$/,"")).replace(/^y/,"")).match(/[aeiouy]{1,2}/g);return(match?match.length:0)+exceptionLength||1}function States(PubblyScope){var _Pubbly=PubblyScope;return this.states=[],this.limit=5,this.save=function(){this.states.push(JSON.stringify(_Pubbly.data)),this.states.length>this.limit&&this.states.shift()},this.load=function(rel){rel=void 0===rel?-1:rel;var compressed=this.states[this.states.length+rel];if(compressed){var attempt=this.states.push(JSON.parse(compressed));attempt&&(_Pubbly.data=attempt,_Pubbly.drawPage_dispatch())}else console.error("Cannot find relative state to load")},this.checkInterruptionsAndSave=function(unblocked_cb){_Pubbly.sequence.running?!0===_Pubbly.data.info.interrupt&&(_Pubbly.sequence.kill(),_Pubbly.data.info.saveStates&&_Pubbly.states.load(-1),unblocked_cb()):unblocked_cb()},this.save(),this}function Turns(pubblyScope){var display=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"single",_Pubbly=pubblyScope,_Turns=this;this.speed=[],this.prepped=!1,this.turnStartOffset=0,this.cans={},this.moving=!1,this.display=display,this.type=!1,this.lastPercent=!1,this.prepTurn=function(dir){var percent=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;_Pubbly.navigationUI.disable(),0<=_Pubbly.curPage-1&&_Pubbly.drawPage_dispatch(_Pubbly.curPage-1),(_Pubbly.curPage+1<=_Pubbly.data.pages.length-1||!_Pubbly.data.info.lastPageSpread)&&_Pubbly.drawPage_dispatch(_Pubbly.curPage+1),this.turnStartOffset=percent,this.turnStartBellCurve=1/(1-percent),this.prepped=dir;var cover=$("#pubbly_main #canvases #cancover");if(this.cans.all=cover.find("div.canPlacer"),this.cans.previous=cover.find("div.previous"),this.cans.current=cover.find("div.current"),this.cans.next=cover.find("div.next"),"composite"==this.display&&(this.cans.currentSpreadLeft=cover.find("div.currentSpreadLeft"),this.cans.currentSpreadRight=cover.find("div.currentSpreadRight"),this.cans.nextSpreadLeft=cover.find("div.nextSpreadLeft"),this.cans.nextSpreadRight=cover.find("div.nextSpreadRight"),this.cans.previousSpreadLeft=cover.find("div.previousSpreadLeft"),this.cans.previousSpreadRight=cover.find("div.previousSpreadRight")),"single"==this.display)"right"==dir?(this.type="singleRight",this.cans.previous.css("z-index",2),this.cans.current.css("z-index",3),this.cans.next.css("z-index",1)):"left"==dir&&(this.type="singleLeft",this.cans.previous.css("z-index",1),this.cans.current.css("z-index",3),this.cans.next.css("z-index",2));else switch(this.cans.previous.css("z-index",-1),this.cans.next.css("z-index",-1),0==_Pubbly.curPage?this.type="frontToSpread":1==_Pubbly.curPage&&"right"==dir?this.type="spreadToFront":_Pubbly.curPage!=_Pubbly.data.pages.length-1||_Pubbly.data.info.lastPageSpread?_Pubbly.curPage!=_Pubbly.data.pages.length-2||"left"!=dir||_Pubbly.data.info.lastPageSpread?this.type="left"==dir?"spreadToSpreadLeft":"spreadToSpreadRight":this.type="spreadToBack":this.type="backToSpread",this.cans.all.css("display","none"),this.type){case"frontToSpread":this.cans.current.css({"z-index":2,display:"block"}),this.cans.nextSpreadLeft.css({"z-index":3,display:"block"}),this.cans.nextSpreadRight.css({"z-index":1,display:"block"});break;case"spreadToFront":this.cans.previous.css({"z-index":2,display:"block"}),this.cans.currentSpreadLeft.css({"z-index":3,display:"block","margin-left":"0%"}),this.cans.currentSpreadRight.css({"z-index":1,display:"block","margin-left":"50%"});break;case"backToSpread":this.cans.current.css({"z-index":1,display:"block"}),this.cans.previousSpreadLeft.css({"z-index":2,display:"block"}),this.cans.previousSpreadRight.css({"z-index":3,display:"block"});break;case"spreadToBack":this.cans.current.css({"z-index":1,display:"block"}),this.cans.next.css({"z-index":2,display:"block"});break;case"spreadToSpreadLeft":this.cans.current.css({"z-index":2,display:"block"}),this.cans.nextSpreadLeft.css({"z-index":3,display:"block"}),this.cans.nextSpreadRight.css({"z-index":1,display:"block"});break;case"spreadToSpreadRight":this.cans.current.css({"z-index":1,display:"block"}),this.cans.previousSpreadLeft.css({"z-index":3,display:"block"}),this.cans.previousSpreadRight.css({"z-index":2,display:"block"}),$(".previousSpreadRight canvas").css("margin-left","calc(100% - "+_Pubbly.data.info.width+"px)")}},this.manualAnimate=function(speed,revert){this.manualAnimation={revert:revert,lastPercent:1*this.lastPercent,dir:this.prepped,endStamp:now()+1e3*speed,speed:1e3*speed,interval:!1},this.manualAnimation.interval=window.setInterval(function(){var truePercent,info=_Turns.manualAnimation,left=info.endStamp-now(),animationPercent=Math.abs(left/info.speed-1);truePercent=info.revert?info.lastPercent-animationPercent*info.lastPercent:info.lastPercent+animationPercent*(1-info.lastPercent),0<left?_Turns.handlers.set.call(_Turns,info.dir,truePercent):(_Turns.handlers.set.call(_Turns,info.dir,!info.revert),window.clearInterval(_Turns.manualAnimation.interval),info.revert&&(_Turns.prepped=!1),_Turns.manualAnimation={},window.setTimeout(function(){_Turns.endTurn.call(_Turns)},10))},10)},this.handlers={manual:{left:function(percent){_Turns.handlers.set.call(_Turns,"right",percent)},right:function(percent){_Turns.handlers.set.call(_Turns,"left",percent)}},auto:{left:function(){_Turns.handlers.end.call(_Turns,"right")},right:function(){_Turns.handlers.end.call(_Turns,"left")}},canTurn:function(dir){var curPage=_Pubbly.curPage,lastPage=_Pubbly.data.pages.length,canTurn="left"==dir&&curPage<lastPage-1||"right"==dir&&1<=curPage;return canTurn},set:function(dir,percent){if(this.handlers.canTurn(dir)){this.prepped||this.prepTurn(dir,percent),this.lastPercent=percent;var vals,smoothPercent=Math.max(percent-this.turnStartOffset,0)*this.turnStartBellCurve;if("singleRight"==this.type)vals={previous:{marginLeft:100*smoothPercent-100},current:{marginLeft:100*smoothPercent},next:{marginLeft:100}};else if("singleLeft"==this.type)vals={previous:{marginLeft:-100},current:{marginLeft:-100*smoothPercent},next:{marginLeft:100+-100*smoothPercent}};else if("frontToSpread"==this.type){var tp1=Math.min(3*smoothPercent,1),tp2=Math.max(0,1.5*(smoothPercent-1/3));vals={current:{marginLeft:25+25*tp1,width:50-100*tp2},nextSpreadLeft:{marginLeft:100-100*tp2,width:50*tp2},nextSpreadRight:{marginLeft:25+25*tp1,width:50}}}else if("spreadToFront"==this.type){var inverse=Math.abs(smoothPercent-1),_tp=Math.min(3*inverse,1),_tp2=Math.max(0,1.5*(inverse-1/3));vals={previous:{marginLeft:25+25*_tp,width:50-100*_tp2},currentSpreadLeft:{marginLeft:100-100*_tp2,width:50*_tp2},currentSpreadRight:{marginLeft:25+25*_tp,width:50}}}else if("spreadToSpreadLeft"==this.type){var _inverse=Math.abs(smoothPercent-1);vals={current:{marginLeft:0,width:100*_inverse},nextSpreadLeft:{marginLeft:100*_inverse,width:50*smoothPercent},nextSpreadRight:{marginLeft:50,width:50}}}else if("spreadToSpreadRight"==this.type){Math.abs(smoothPercent-1);vals={current:{marginLeft:0,width:100},previousSpreadRight:{marginLeft:50*smoothPercent,width:50*smoothPercent},previousSpreadLeft:{marginLeft:0,width:50*smoothPercent}}}else if("spreadToBack"==this.type){var _tp3=Math.min(1.5*smoothPercent,1),_tp4=3*Math.max(0,smoothPercent-2/3);vals={current:{marginLeft:0,width:100*Math.abs(_tp3-1)},next:{marginLeft:Math.max(100*Math.abs(_tp3-1),25*_tp4),width:50*_tp3}}}else if("backToSpread"==this.type){var _tp5=Math.min(3*smoothPercent,1),_tp6=Math.max(0,1.5*(smoothPercent-1/3));vals={current:{marginLeft:25*Math.abs(_tp5-1),width:50},previousSpreadRight:{marginLeft:50*_tp6,width:50*_tp6},previousSpreadLeft:{marginLeft:0,width:50*_tp6}}}else error("fatal","turning","Unknown turn type of "+this.type);for(var v in vals)for(var p in vals[v])this.cans[v]&&this.cans[v].css(p,vals[v][p]+"%")}},end:function(dir){1<arguments.length&&void 0!==arguments[1]&&arguments[1];this.handlers.canTurn(dir)&&(this.moving?error("log","Page turn end","Cannot end pageturn, animation in progress"):(this.prepped||this.prepTurn(dir),this.moving=!0,this.manualAnimate.call(this,.5,!1)))},reset:function(){var speed=0<arguments.length&&void 0!==arguments[0]?arguments[0]:.5;this.prepped&&this.manualAnimate.call(this,speed,!0)}},this.endTurn=function(){$(".previousSpreadRight canvas").css("margin-left",""),_Pubbly.navigationUI.enable();var dir=this.prepped,newPage=_Pubbly.curPage;"left"==dir?newPage++:"right"==dir&&newPage--,this.moving=!1,this.prepped=!1,this.lastPercent=!1,_Pubbly.changeCurPage_dispatch(newPage,{done:function(){_Pubbly.checkPageFor("openPages")}})},this.init=function(){},this.init()}function UrlNav(environment){var _UrlNav=this;this.environment=environment,this.clean=function(url){var ret;return"http://"==url.substring(0,7)||"https://"==url.substring(0,8)||(ret="www."==url.substring(0,4)?"http://"+url:"http://www."+url),ret},this.popup=function(url,error){var popup=window.open(url,"_blank","height=page.x,width=page.y");null!=popup&&popup?(window.sameWindowCheck="test")==popup.sameWindowCheck?error("popup"):popup.focus():error("popup")},this.tab=function(url,error){var tab=window.open(url,"_blank");null!=tab&&tab?(window.sameWindowCheck="test")==tab.sameWindowCheck?error("tab"):tab.focus():error("tab")},this.window=function(url,error){var rootLoc=window.location.href.split("#")[0],rootUrl=url.split("#")[0];rootLoc==rootUrl&&window.history.pushState("",document.title,window.location.pathname),pubbly.reloadCheck="test",window.location.href=url,rootLoc==rootUrl&&window.location.reload()};function backupOpen(from){var nextAttempt={popup:"tab",tab:"window",window:!1}[from];nextAttempt&&"function"==typeof _UrlNav[nextAttempt]?_UrlNav[nextAttempt].call(_UrlNav,_UrlNav.url,backupOpen):error("fatal","UrlNav","Could not open url "+this.url+" in any way")}this.previous=function(){window.history.go(-1)},this.home=function(){},this.go=function(url,preference){if("previouswebpage"==url.toLowerCase())this.previous();else{if("homewebpage"==url.toLowerCase()){this.url="https://www.pubbly.com"}else if("#"==url.substring(0,1)){for(var curUrl=window.location.href.split("?"),urlVars=curUrl[1].split("&"),newVars=[],v=0;v<urlVars.length;v++)"a"!==urlVars[v].split("=")[0]&&newVars.push(urlVars[v]);"#"==url.substring(1,2)||newVars.push("a="+encodeURI(url.substring(1))),this.url=curUrl[0]+"?"+newVars.join("&")}else if("?"==url.substring(0,1)){var _curUrl=window.location.href.split("?");if("app"===this.environment||"offline"===this.environment){var props=url.split("?")[1].split("&").map(function(a){return a.split("=")});props.find(function(p){return"t"==p[0]&&"m"==p[1]})&&(this.url=props.find(function(p){return"nn"==p[0]})[1]+".html")}else this.url=_curUrl[0]+url}else this.url=this.clean(url);"popup"==preference?this.popup(this.url,backupOpen):"tab"==preference?this.tab(this.url,backupOpen):("window"==preference||error("warn","UrlNav","Unknown preference type '"+preference+"'. Defaulting to window"),this.window(this.url,backupOpen))}}}function changeExtFromPath(path,changeTo){var tmp=path.split(".");return tmp.splice(tmp.length-1,1,changeTo),tmp.join(".")}function getFileSourceFromPath(path){return path.split("/").pop()}function getExtFromPath(path){return path.split("/").pop().split(".").pop()}function getFileNameFromPath(path){if(path){var tmp1=path.split("/").pop().split(".");return tmp1.pop(),tmp1.join(".")}return!1}function getExtFromRelPath(relPath){try{var fileName=relPath.split("/").pop();return 1<fileName.split(".").length&&fileName.split(".").pop()}catch(e){return!1}}function stripNoReplaceProps(props){var dirty=[],clean={};for(var name in props)if("string"==typeof props[name]){var str=props[name].toString();"{"===str.charAt()&&"}"===str.charAt(str.length-1)?str.length<100?clean[name]=props[name]:dirty.push(name):clean[name]=props[name]}else clean[name]=props[name];return dirty.length&&(console.warn("Some of the to be found and replace runtime props were NOT replaced. They have been stripped for convienence, but in the future, please clean up your HTML. Dawg."),console.warn("Bad props: "+dirty.join(" -- "))),clean}function findDifferenceBetweenTwoArrays(arr1,arr2){var leftDif=arr1.filter(function(i){return-1===arr2.indexOf(i)}),rightDif=arr2.filter(function(i){return-1===arr1.indexOf(i)});return leftDif.concat(rightDif)}function rand(n1,n2){var upper,lower;lower=void 0===n2?(upper=n1,0):(upper=n2,n1);var dif=upper-lower;return lower+Math.floor(Math.random()*(1+dif))}function randInArray(arr){return arr[rand(arr.length-1)]}var RedrawDependency=function(){function RedrawDependency(redrawCallback,options){_classCallCheck(this,RedrawDependency),"function"!=typeof redrawCallback?console.error("RedrawDependency.constructor (fatal): redrawCallback argument is NOT a function..."):(this.add=this.add.bind(this),this.remove=this.remove.bind(this),this.redrawCallback=redrawCallback,this.options=_extends({frameRate:1},options),this.depList=[],this.interval=!1)}return _createClass(RedrawDependency,[{key:"add",value:function(what){this.depList.push(what),this.interval||(this.interval=window.setInterval(this.redrawCallback,this.options.frameRate))}},{key:"remove",value:function(what){var origL=this.depList.lengh;this.depList=this.depList.filter(function(elem){return elem!==what}),origL===this.depList.length&&console.warn("RedrawDependency.remove: Argument passed is not in depedency list... Nothing removed"),0===this.depList.length&&(window.clearInterval(this.interval),this.interval=!1,this.redrawCallback())}}]),RedrawDependency}(),VariableInt=function(){function VariableInt(time,cbs){_classCallCheck(this,VariableInt),this.next=this.next.bind(this),this.time=time,this.cbs=cbs,this.endStamp=Date.now()+this.time,this.int=window.setInterval(this.next,10)}return _createClass(VariableInt,[{key:"next",value:function(){var percentDone=1-(this.endStamp-now())/this.time;1<=percentDone?(this.cbs.end(),window.clearInterval(this.int)):this.cbs.next(percentDone)}}]),VariableInt}(),AssetListLoader=function(){function AssetListLoader(){_classCallCheck(this,AssetListLoader),this.load=this.load.bind(this),this.unload=this.unload.bind(this),this.loadSingleSpecificOrVagueAsset=this.loadSingleSpecificOrVagueAsset.bind(this),this.addLoadedAsset=this.addLoadedAsset.bind(this),this.download=this.download.bind(this),this.searchForVagueAsset=this.searchForVagueAsset.bind(this),this.keys={},this.byFileSource={},this.byFileName={}}return _createClass(AssetListLoader,[{key:"loadList",value:function(assets,cbs){this.inLoop?this.killBack=function(){this.killBack=!1,this.load(assets,cbs)}.bind(this):this.load(assets,cbs)}},{key:"load",value:function(assets,cbs){if(this.inLoop=!0,cbs=assignDefaultCallbacks(cbs),assets||console.error("No asset to load"),void 0===assets.length)this.loadSingleSpecificOrVagueAsset(assets,cbs);else{var found=0,missing=0,total=assets.length,checkList=function(asset){var _this6=this;if(this.killBack)this.killBack();else if(found==total)this.inList=!1,cbs.done();else if(found+missing==total){var _missing=assets.map(function(e){return e.relPath}).filter(function(w){return void 0===_this6.keys[w]},this);cbs.fail("Missing assets in list",_missing)}else cbs.prog&&(cbs.prog((found+missing)/total),nextAsset())}.bind(this),a=-1,nextAsset=function(){var asset=assets[++a];window.setTimeout(function(){asset.elem?(found++,checkList(asset)):this.load(asset,{done:function(){found++,checkList(asset)},fail:function(){missing++,checkList(asset)}})}.bind(this),0)}.bind(this);nextAsset()}}},{key:"unload",value:function(assets){var _this7=this;void 0===assets.length?this.unloadSingle(assets):assets.forEach(function(asset){return _this7.unloadSingle(asset)})}},{key:"unloadSingle",value:function(relPath){this.keys[relPath]&&this.keys[relPath].elem?(this.keys[relPath].elem=null,delete this.keys[relPath]):"string"==typeof relPath?console.warn("Asset.removeLoadedAsset: Cannot find asset with relPath of "+relPath):console.warn("Asset.removeLoadedAsset: Bad call. Call with the relPath string of the asset you wish to remove")}},{key:"loadSingleSpecificOrVagueAsset",value:function(asset,cbs){var supportedExts={image:["png","jpg","jpeg"],audio:["ogg","mp3","wav"],video:["mp4","avi"],gif:["gif"]};if(void 0!==asset.type&&void 0!==supportedExts[asset.type]&&void 0!==asset.relPath)if(asset.ext=getExtFromRelPath(asset.relPath),!1===asset.ext){var possibleExts=supportedExts[asset.type].slice();asset.possibles=possibleExts.map(function(e){return asset.relPath+"."+e}),this.searchForVagueAsset(asset,cbs)}else-1!==supportedExts[asset.type].indexOf(asset.ext)?this.download(asset,cbs):(console.error("AssetListLoader.loadSingleSpecificOrVagueAsset: Asset ext '"+asset.ext+"' not supported. Please only use "+supportedExts[asset.type].join(",")+" files for "+asset.type+" files."),cbs.fail());else console.error("AssetListLoader.loadSingleSpecificOrVagueAsset: Asset "+JSON.stringify(asset)+" does not have a type and relPath, cannot load."),cbs.fail()}},{key:"addLoadedAsset",value:function(asset){this.keys[asset.relPath]=asset,this.byFileSource[getFileSourceFromPath(asset.relPath)]=this.keys[asset.relPath],this.byFileName[getFileNameFromPath(asset.relPath)]=this.keys[asset.relPath]}},{key:"download",value:function(asset,cbs){var loadEvent="load";"image"===asset.type||"gif"===asset.type?asset.elem=new Image:"audio"===asset.type?(asset.elem=new Audio,asset.elem.autostart=0,asset.elem.volume=0,loadEvent="canplaythrough"):"video"===asset.type?(asset.elem=document.createElement("video"),asset.elem.volume=0,loadEvent="canplaythrough"):console.error("Unknown asset type of "+asset.type);var that=this;asset.elem.addEventListener(loadEvent,function loaded(){asset.elem.removeEventListener(loadEvent,loaded),that.addLoadedAsset(asset),cbs.done()}),asset.elem.onerror=cbs.fail,asset.elem.setAttribute("src",asset.relPath)}},{key:"searchForVagueAsset",value:function(asset,cbs){var check=asset.possibles.shift();if(check)asset.relPath=check,this.download(asset,{done:function(){delete asset.possibles,cbs.done()},fail:this.searchForVagueAsset.bind(this,asset,cbs)});else{var tmp=asset.relPath.split(".");tmp.pop(),asset.relPath=tmp.join("."),cbs.fail()}}}]),AssetListLoader}(),PubblyPageBuffer=function(){function PubblyPageBuffer(data){var _this9=this;_classCallCheck(this,PubblyPageBuffer),this.loadPage=this.loadPage.bind(this),this.unloadPage=this.unloadPage.bind(this),this.getPageUnloadedAssetCount=this.getPageUnloadedAssetCount.bind(this),this.assetListLoaders=[],this.assets=[];for(var _loop3=function(p){var audLoads=data.pages[p].auds.map(function(aud){return aud.relPath?{type:"audio",relPath:aud.relPath}:aud.relPathNoExt?{type:"audio",relPath:aud.relPathNoExt}:void console.error("PubblyPageBuffer.constructor: Cannot load audio, does not have relPath or relPathNoExt")}),imgLoads=[],gifLoads=[],vidLoads=[];data.pages[p].objs.forEach(function(obj){"image"==obj.type?imgLoads.push({type:"image",relPath:obj.relPath}):"sequence"==obj.type?obj.frames.forEach(function(frame){imgLoads.push({type:"image",relPath:frame.relPath})}):"video"==obj.type?vidLoads.push({type:obj.type,relPath:obj.relPath}):"gif"==obj.type&&gifLoads.push({type:obj.type,relPath:obj.relPath})}),_this9.assetListLoaders[p]=new AssetListLoader,_this9.assets[p]=imgLoads.concat(audLoads).concat(gifLoads).concat(vidLoads)},p=0;p<data.pages.length;p++)_loop3(p)}return _createClass(PubblyPageBuffer,[{key:"loadPage",value:function(p,cbs){this.checkPageExists(p)?this.assetListLoaders[p].loadList(this.assets[p],cbs):console.error("PubblyPageBuffer.loadPage: Page "+p+" not found")}},{key:"unloadPage",value:function(p){this.checkPageExists(p)?this.assetListLoaders[p].unload(this.assets[p]):console.error("PubblyPageBuffer.loadPage: Page "+p+" not found")}},{key:"loadMultiplePages",value:function(pages,cbs){var _this8=this;cbs=assignDefaultCallbacks(cbs);var totalPages=pages.length,totalAssets=0;pages=pages.filter(function(p){var pCount=_this8.getPageUnloadedAssetCount(p);return totalAssets+=pCount,pCount});var nextPageFunc=function(){var nextPage=pages.shift();void 0!==nextPage?this.loadPage(nextPage,{done:nextPageFunc,fail:cbs.fail,prog:function(decimal){var at=decimal,pageAdjustment=(totalPages-pages.length-1+at)/totalPages;cbs.prog(pageAdjustment)}}):cbs.done()}.bind(this);totalAssets?nextPageFunc():cbs.done()}},{key:"getPageUnloadedAssetCount",value:function(p){return findDifferenceBetweenTwoArrays(this.assets[p].map(function(a){return a.relPath}),Object.keys(this.assetListLoaders[p].keys)).length}},{key:"checkPageLoaded",value:function(p){return!1}},{key:"checkPageExists",value:function(p){return this.assetListLoaders[p]&&this.assets[p]}}]),PubblyPageBuffer}();function pubColor(name,format){var codes={purple:{hex:"8768AE",rgb:[136,103,172]},blue:{hex:"3B4D83",rgb:[57,77,129]},orange:{hex:"E06515",rgb:[226,98,35]},red:{hex:"B02927",rgb:[179,36,42]},darkred:{hex:"6B161A",rgb:[107,22,26]},lightblue:{hex:"5EABC6",rgb:[91,173,198]},green:{hex:"92BC3A",rgb:[145,188,72]},white:{hex:"000000",rgb:[0,0,0]}};return format=format?"rgb"==format?"rgb":"hex":"rgb",codes[name]?codes[name][format]:(error("warn","colors","Unknown color code of "+name+", returning white "+format),codes.default[format])}var Cursors=function(){function Cursors(elem){_classCallCheck(this,Cursors),this.elem=elem,this.construct_library(),this.set=this.set.bind(this)}return _createClass(Cursors,[{key:"set",value:function(pubblyAction){var _this10=this,mouseAction=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"default",cursor=this.library[mouseAction][pubblyAction]||this.library.default[pubblyAction];this.elem[0].classList.forEach(function(c){c.split("cursor-")[1]&&_this10.elem.removeClass(c)}),this.elem.addClass("cursor-"+cursor)}},{key:"construct_library",value:function(){this.library={default:{undefined:"default",false:"default",drag:"grabbing",clone:"grabbing",single:"crosshair",multiple:"crosshair",field:"text",clicks:"pointer","draw-none":"default","draw-eraser":"eraser","draw-pencil":"pencil","draw-chalk":"chalk",editText:"text"},down:{},hover:{drag:"grab",clone:"grab",single:"cell",multiple:"cell"},drag:{drop:"grabbing","no-drop":"grabbing"},line:{},interruptableSequence:{drag:"progress",clone:"progress",single:"progress",multiple:"progress",field:"progress",clicks:"progress",draw:"progress",editText:"progress"},uninterruptableSequence:{undefined:"wait",false:"wait",drag:"wait",clone:"wait",single:"wait",multiple:"wait",field:"wait",clicks:"wait",draw:"wait",editText:"wait"}}}}]),Cursors}();function assignDefaultCallbacks(cbs){return _extends({done:function(){},fail:function(){},prog:function(){}},cbs)}function error(level,type,message){level=!0===level?"fatal":level.toString().toLowerCase();message="";message+=autocase(type=type.toLowerCase()),message+=" error:\n",message+=message,"update"===level?changeHTML(messyHTML("newEngineUpdate")):"fatal"===level?window.testing?console.error("Fatal error"):fatalProductionError(message):"warn"===level?console.warn(message):("log"===level||console.error("Unknown error level of ".concat(level,", logging: ")),console.log(message))}function fatalProductionError(msg){console.error(msg)}function changeHTML(html){window.htmlChanged||(window.htmlChanged=!0,document.body.innerHTML=html)}for(var singular in window.reservedWords={points:["changed","Fixed Text"]},window.plurals={image:"images",gif:"gifs",click:"clicks",drop:"drops",line:"lines",trigger:"triggers",dragStart:"dragStarts",dragStop:"dragStops",lineStart:"lineStarts",lineStop:"lineStops",countdown:"countdowns",openPage:"openPages",sequence:"sequences",draft:"drafts",book:"books",point:"points"},window.singulars={},window.plurals)window.singulars[window.plurals[singular]]=singular;function imgToPoly(img){var poly=[];return poly.push([img.loc[1],img.loc[0]]),poly.push([img.loc[1]+img.width,img.loc[0]]),poly.push([img.loc[1]+img.width,img.loc[0]+img.height]),poly.push([img.loc[1],img.loc[0]+img.height]),poly.push([img.loc[1],img.loc[0]]),poly}function cutLink(val){switch(_typeof(val)){case"string":return val+"";case"number":return 1*val;case"undefined":return;case"null":return null;case"array":return val.slice();case"object":return Array.isArray(val)?val.slice():jQuery.extend(!0,{},val);case"boolean":return 1==val}}function centerOfPoly(poly){for(var xMax=0,yMax=0,xMin=poly[0][0],yMin=poly[0][1],p=0;p<poly.length;p++)xMax=Math.max(xMax,poly[p][0]),xMin=Math.min(xMin,poly[p][0]),yMax=Math.max(yMax,poly[p][1]),yMin=Math.min(yMin,poly[p][1]);return[yMin+(yMax-yMin)/2,xMin+(xMax-xMin)/2]}function ptOffset(pt,offset){return ptsOffset([pt],offset)[0]}function ptsOffset(pts,offset){if(pts.length){for(var p=0;p<pts.length;p++)pts[p][0]+=offset[0],pts[p][1]+=offset[1];return pts}return[pts[0]+offset[0],pts[1]+offset[1]]}function animLegNextByPercent(cur,next,percent){return cur+(next-cur)*percent}function dupeAnyType(newVal){var propType=_typeof(newVal);return"number"==propType?newVal*=1:"string"==propType?newVal+="":"boolean"==propType?newVal=!!newVal:"object"==propType&&(newVal="undefined"!==newVal.length?newVal.slice():jQuery.extend({},newVal)),newVal}function now(){return Date.now()}function useTouch(){return"ontouchstart"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints}function autocase(text){return text.replace(/(&)?([a-z])([a-z]{2,})(;)?/gi,function(all,prefix,letter,word,suffix){return prefix&&suffix?all:letter.toUpperCase()+word.toLowerCase()})}function arrayToHuman(arr){var outStr="";return 1===arr.length?outStr=arr[0]:2===arr.length?outStr=arr.join(" and "):2<arr.length&&(outStr=arr.slice(0,-1).join(", ")+", and "+arr.slice(-1)),outStr}function inside(point,vs){for(var x=point[0],y=point[1],inside=!1,i=0,j=vs.length-1;i<vs.length;j=i++){var xi=vs[i][0],yi=vs[i][1],xj=vs[j][0],yj=vs[j][1];y<yi!=y<yj&&x<(xj-xi)*(y-yi)/(yj-yi)+xi&&(inside=!inside)}return inside}function messyHTML(which){switch(which){case"killDraft":return"<div class=fatal><p>Page couldn't load</p><p>Check console for error log</p></div>";case"killPublication":return"";case"newEngineUpdate":return"<div id=fatal><h2>Warning</h2><p>This book was created for the old pubbly engine and needs to be manually updated. Please follow <a href='../update.php?bookID="+window.bookID+"'>this link</a>. Allow the script to fully execute; You will return to this draft once finished.</p></div>";case"nav":return'<img class="previous" />\n                <select class=goto>\n                </select>\n                </div>\n                <img class="next" />';case"fatalProductionError":return'\n        <style>\n            body {\n            }\n            .errCover {\n                position:absolute;\n                height:480px;\n                width:480px;\n                top:calc(50% - 240px);\n                left:calc(50% - 240px);\n                border-radius:35px;\n                cursor:pointer;\n                transition:0.2s;\n            }\n            .errCover .rabbitHole {\n                position:absolute;\n                height:100%;\n                width:100%;\n                transition:0.3s;\n            }\n        </style>\n        <a href="index.php">\n            <div class="errCover">\n                <video class="rabbitHole normal" autoplay="true">\n                    <source src="'.concat(window.engineLoc,'/../assets/error/rabbit_hole_normal.webm"  type="video/webm">\n                </video>\n            </div>\n        </a>');default:return""}}function ProgressGraph(type,container){this.elem=!1,this.globalAt=!1,this.globalLeft=!1,this.messyLoader={vertical_letters:{html:"\n                <div class='transformCenterCont'>\n                    <div class='transformCenter'>\n                        <style>\n                            .loadColorsCont {\n                                position:absolute;\n                                height:calc(100% - 4px);\n                                margin-top:2px;\n                                /* This, plus an extra 1px white margin on source image, means no overflow lines and no cut off colors */\n                                width: calc(100% - 2px);\n                                margin-left: 1px;\n                            }\n                            .loadColor {\n                                position:absolute;\n                                bottom:0;\n                                height:0%;\n                                width:".concat(100/6,"%;\n                                /* Added transition for smoother fill */\n                                transition-duration:0s;\n                                transition-timing-function:linear;\n                            }\n                            .loadColor[letter=p] {\n                                background-color:#").concat(pubColor("purple","hex"),";\n                                left:").concat(0,"%;\n                            }\n                            .loadColor[letter=u] {\n                                background-color:#").concat(pubColor("blue","hex"),";\n                                left:").concat(100/6*1,"%;\n                            }\n                            .loadColor[letter=b1] {\n                                background-color:#").concat(pubColor("orange","hex"),";\n                                left:").concat(100/6*2,"%;\n                            }\n                            .loadColor[letter=b2] {\n                                background-color:#").concat(pubColor("red","hex"),";\n                                left:").concat(50,"%;\n                            }\n                            .loadColor[letter=l] {\n                                background-color:#").concat(pubColor("lightblue","hex"),";\n                                left:").concat(100/6*4,"%;\n                            }\n                            .loadColor[letter=y] {\n                                background-color:#").concat(pubColor("green","hex"),";\n                                left:").concat(100/6*5,"%;\n                            }\n                            .loadColor.errored {\n                                background-color:#").concat(pubColor("red","hex"),";\n                                animation: pulse 1s infinite;\n                                animation-direction: alternate;\n                            }\n                            @keyframes pulse {\n                                0%   {\n                                     background-color:#").concat(pubColor("red","hex"),";\n                                }\n                                100% { \n                                     background-color:#").concat(pubColor("darkred","hex"),";\n                                }\n                            }\n                            .positionImg, .displayImg {\n                                /* max-width:500px; */\n                            }\n                            .positionImg {\n                                visibility:hidden;\n                            }\n                            .displayImg {\n                                position:absolute;\n                                top:0;\n                                left:0;\n                                z-index:5;\n                                /* This to cover the little line of position rounding */\n                                /* NOT WORKING, because the bg blocks the colors. Stupid\n                                 * padding:50px;\n                                 * margin:-50px;\n                                 * background-color:white;\n                                 */\n                            }\n                            .text_cont {\n                                height:0;\n                                margin:0;\n                            }\n                            .loader_text {\n                                position:absolute;\n                                width:100%;\n                                text-align:center;\n                                font-size:24px;\n                                color:#3B4D83;\n                                /* Known load height, this can be fixed */\n                                max-height:180px;\n                                overflow-x:hidden;\n                                overflow-y:scroll;\n                            }\n                            .loader_confirm {\n                                position:absolute;\n                                width:100px;\n                                height:40px;\n                                left:50%;\n                                margin-left:-50px;\n                                margin-top:-50px;\n                            }\n                            .loader_confirm.hide {\n                                visibility:hidden\n                            }\n                        </style>\n                        <button class='loader_confirm hide'>Text</button>\n                        <div class='loadColorsCont'>\n                            <div class='loadColor' letter='p'></div>\n                            <div class='loadColor' letter='u'></div>\n                            <div class='loadColor' letter='b1'></div>\n                            <div class='loadColor' letter='b2'></div>\n                            <div class='loadColor' letter='l'></div>\n                            <div class='loadColor' letter='y'></div>\n                        </div>\n                        \x3c!-- One image for positioning (make cont size of img) --\x3e\n                        <img class='positionImg _asset_logoEmptyColors' />\n                        \x3c!-- The other to actually display, and overlay the colored blocks below --\x3e\n                        <img class='displayImg _asset_logoEmptyColors' />\n                        <div class='text_cont'>\n                            <p class=loader_text></p>\n                        </div>\n                    </div>\n                </div>"),css:[{cssSelector:".loadColor",attr:"height",from:0,to:100,valTypeChar:"%"}],textElem:".loader_text",confirmElem:".loader_confirm"},vertical_letters_preflight:{html:"\n                <div class='transformCenterCont'>\n                    <div class='transformCenter'>\n                        <style>\n                            .loadColorsCont {\n                                position:absolute;\n                                height:calc(100% - 4px);\n                                margin-top:2px;\n                                /* This, plus an extra 1px white margin on source image, means no overflow lines and no cut off colors */\n                                width: calc(100% - 2px);\n                                margin-left: 1px;\n                            }\n                            .loadColor {\n                                position:absolute;\n                                bottom:0;\n                                height:0%;\n                                width:".concat(100/6,"%;\n                                /* Added transition for smoother fill */\n                                transition-duration:0s;\n                                transition-timing-function:linear;\n                            }\n                            .loadColor[letter=p] {\n                                background-color:#").concat(pubColor("purple","hex"),";\n                                left:").concat(0,"%;\n                            }\n                            .loadColor[letter=u] {\n                                background-color:#").concat(pubColor("blue","hex"),";\n                                left:").concat(100/6*1,"%;\n                            }\n                            .loadColor[letter=b1] {\n                                background-color:#").concat(pubColor("orange","hex"),";\n                                left:").concat(100/6*2,"%;\n                            }\n                            .loadColor[letter=b2] {\n                                background-color:#").concat(pubColor("red","hex"),";\n                                left:").concat(50,"%;\n                            }\n                            .loadColor[letter=l] {\n                                background-color:#").concat(pubColor("lightblue","hex"),";\n                                left:").concat(100/6*4,"%;\n                            }\n                            .loadColor[letter=y] {\n                                background-color:#").concat(pubColor("green","hex"),";\n                                left:").concat(100/6*5,"%;\n                            }\n                            .loadColor.errored {\n                                background-color:#").concat(pubColor("red","hex"),";\n                                animation: pulse 1s infinite;\n                                animation-direction: alternate;\n                            }\n                            @keyframes pulse {\n                                0%   {\n                                     background-color:#").concat(pubColor("red","hex"),";\n                                }\n                                100% { \n                                     background-color:#").concat(pubColor("darkred","hex"),";\n                                }\n                            }\n                            .positionImg, .displayImg {\n                                /* max-width:500px; */\n                            }\n                            .positionImg {\n                                visibility:hidden;\n                            }\n                            .displayImg {\n                                position:absolute;\n                                top:0;\n                                z-index:5;\n                                /* This to cover the little line of position rounding */\n                                /* NOT WORKING, because the bg blocks the colors. Stupid\n                                 * padding:50px;\n                                 * margin:-50px;\n                                 * background-color:white;\n                                 */\n                            }\n                            .text_cont {\n                                height:0;\n                                margin:0;\n                            }\n                            .loader_text {\n                                position:absolute;\n                                width:100%;\n                                text-align:center;\n                                font-size:24px;\n                                color:#3B4D83;\n                                /* Known load height, this can be fixed */\n                                max-height:180px;\n                                overflow-x:hidden;\n                                overflow-y:scroll;\n                            }\n                            .loader_title {\n                                position:absolute;\n                                width:200px;\n                                height:110px;\n                                font-size:24px;\n                                left:50%;\n                                margin-left:-100px;\n                                margin-top:-100px;\n                                text-align:center;\n                            }\n                            .loader_confirm.hide {\n                                visibility:hidden\n                            }\n                        </style>\n                        <p class='loader_title'>First time load (authors only)</p>\n                        <div class='loadColorsCont'>\n                            <div class='loadColor' letter='p'></div>\n                            <div class='loadColor' letter='u'></div>\n                            <div class='loadColor' letter='b1'></div>\n                            <div class='loadColor' letter='b2'></div>\n                            <div class='loadColor' letter='l'></div>\n                            <div class='loadColor' letter='y'></div>\n                        </div>\n                        \x3c!-- One image for positioning (make cont size of img) --\x3e\n                        <img class='positionImg _asset_logoEmptyColors' />\n                        \x3c!-- The other to actually display, and overlay the colored blocks below --\x3e\n                        <img class='displayImg _asset_logoEmptyColors' />\n                        <div class='text_cont'>\n                            <p class=loader_text></p>\n                        </div>\n                    </div>\n                </div>"),css:[{cssSelector:".loadColor",attr:"height",from:0,to:100,valTypeChar:"%"}],textElem:".loader_text",confirmElem:".loader_confirm"},text_only:{html:"<p>Loading first time export: </p><span class=loadPercent></span><span>%</span>",textElem:".loadPercent",confirmElem:".loadPercent"},carrot_eat:{html:"\n            <style>\n            .carrot_eat {\n                max-width:100%;\n                max-height:100%;\n                display:block;\n                margin:auto;\n            }\n            </style>\n<div class='transformCenterCont'>\n    <div class='transformCenter'>\n        <img class='carrot_eat _asset_eatCarrotGif' />\n        <p class='textElem' style='display:none'></p>\n    </div>\n</div>",css:[]}},this.clear=function(){this.set(0),this.globalAt=!1,this.globalLeft=!1,this.loadTimers=[]},this.set=function(percent){if(percent=Math.min(Math.max(percent,0),100),this.loadSpecs.css)for(var e=0;e<this.loadSpecs.css.length;e++){var elemSpecs=this.loadSpecs.css[e],jqElem=this.elem.find(elemSpecs.cssSelector),decimal=percent/100,coverage=(elemSpecs.to-elemSpecs.from)*decimal,at=elemSpecs.from+coverage;jqElem.css(elemSpecs.attr,at+elemSpecs.valTypeChar)}},this.say=function(what){if(this.loadSpecs.textElem){var speaker=this.elem.find(this.loadSpecs.textElem);speaker?speaker.html(what):console.error("Loader element described, but not found")}else console.info("Loader says: "+what)},this.confirm=function(message,cb){var confirm=this.elem.find(this.loadSpecs.confirmElem);confirm?(confirm.html(message),confirm.onclick=cb,confirm.removeClass("hide")):window.confirm(message,cb)},this.error=function(){this.set(100),$(".loadColor").addClass("errored")},this.show=function(){this.elem.css({display:"block"})},this.hide=function(){this.elem.css({display:"none"})},this.kill=function(){this.elem.remove()},this.loadTimers=[],this.blindCalculatePrep=function(totalAssets){this.globalLeft=totalAssets,this.globalAt=0},this.blindCalculate=function(){!1===this.globalAt||!1===this.globalLeft?console.error("ERROR: Call blindCalculatePrep FIRST, with the number of total assets. Then blindCalculate()"):(this.globalAt++,this.calculate(this.globalAt,this.globalLeft))},this.end=function(cb){this.set(100),this.hide(),this.clear(),cb&&cb()},this.calculate=function(decimal){var dryPercent=100*decimal;this.loadTimers.push(now());var avgTime=0;if(this.loadTimers.length%2==0){for(var t=1;t<this.loadTimers.length;t++)avgTime+=this.loadTimers[t]-this.loadTimers[t-1];avgTime/=this.loadTimers.length-1,avgTime/=1e3,avgTime*=1.2;for(var e=0;e<this.loadSpecs.css.length;e++){var elemSpecs=this.loadSpecs.css[e];this.elem.find(elemSpecs.cssSelector).css("transition-duration",avgTime+"s")}}this.set(dryPercent)},this.init=function(){this.calculate=this.calculate.bind(this),this.clear=this.clear.bind(this),this.set=this.set.bind(this),this.say=this.say.bind(this),this.confirm=this.confirm.bind(this),this.error=this.error.bind(this),this.messyLoader[type]?(this.loadSpecs=this.messyLoader[type],container.append("<div class='loader' style='display:none'></div>"),this.elem=$(container.find(".loader").last()),this.elem.append(this.loadSpecs.html),this.set(0),this.show()):(error("fatal","progress","Unknown loader type "+type+", please make it or specify a known one. List of known"),console.log(Object.keys(this.messyLoader)))},this.init()}function testLoader(){var at=0,timertimer=window.setInterval(function(){at++,pubbly.progressGraph.calculate(at,10),10<=at&&(window.clearInterval(timertimer),alert("DONE"))},1e3)}function detectAutoplay(acceptable_delay,cbs){cbs=_extends({done:function(){},fail:function(){},prog:function(){}},cbs);var autoplay_test_content=document.createElement("video"),mp4=document.createElement("source");mp4.src="data:video/mp4;base64,AAAAFGZ0eXBNU05WAAACAE1TTlYAAAOUbW9vdgAAAGxtdmhkAAAAAM9ghv7PYIb+AAACWAAACu8AAQAAAQAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAnh0cmFrAAAAXHRraGQAAAAHz2CG/s9ghv4AAAABAAAAAAAACu8AAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAABAAAAAAFAAAAA4AAAAAAHgbWRpYQAAACBtZGhkAAAAAM9ghv7PYIb+AAALuAAANq8AAAAAAAAAIWhkbHIAAAAAbWhscnZpZGVBVlMgAAAAAAABAB4AAAABl21pbmYAAAAUdm1oZAAAAAAAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAVdzdGJsAAAAp3N0c2QAAAAAAAAAAQAAAJdhdmMxAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAFAAOABIAAAASAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGP//AAAAEmNvbHJuY2xjAAEAAQABAAAAL2F2Y0MBTUAz/+EAGGdNQDOadCk/LgIgAAADACAAAAMA0eMGVAEABGjuPIAAAAAYc3R0cwAAAAAAAAABAAAADgAAA+gAAAAUc3RzcwAAAAAAAAABAAAAAQAAABxzdHNjAAAAAAAAAAEAAAABAAAADgAAAAEAAABMc3RzegAAAAAAAAAAAAAADgAAAE8AAAAOAAAADQAAAA0AAAANAAAADQAAAA0AAAANAAAADQAAAA0AAAANAAAADQAAAA4AAAAOAAAAFHN0Y28AAAAAAAAAAQAAA7AAAAA0dXVpZFVTTVQh0k/Ou4hpXPrJx0AAAAAcTVREVAABABIAAAAKVcQAAAAAAAEAAAAAAAAAqHV1aWRVU01UIdJPzruIaVz6ycdAAAAAkE1URFQABAAMAAAAC1XEAAACHAAeAAAABBXHAAEAQQBWAFMAIABNAGUAZABpAGEAAAAqAAAAASoOAAEAZABlAHQAZQBjAHQAXwBhAHUAdABvAHAAbABhAHkAAAAyAAAAA1XEAAEAMgAwADAANQBtAGUALwAwADcALwAwADYAMAA2ACAAMwA6ADUAOgAwAAABA21kYXQAAAAYZ01AM5p0KT8uAiAAAAMAIAAAAwDR4wZUAAAABGjuPIAAAAAnZYiAIAAR//eBLT+oL1eA2Nlb/edvwWZflzEVLlhlXtJvSAEGRA3ZAAAACkGaAQCyJ/8AFBAAAAAJQZoCATP/AOmBAAAACUGaAwGz/wDpgAAAAAlBmgQCM/8A6YEAAAAJQZoFArP/AOmBAAAACUGaBgMz/wDpgQAAAAlBmgcDs/8A6YEAAAAJQZoIBDP/AOmAAAAACUGaCQSz/wDpgAAAAAlBmgoFM/8A6YEAAAAJQZoLBbP/AOmAAAAACkGaDAYyJ/8AFBAAAAAKQZoNBrIv/4cMeQ==";var webm=document.createElement("source");webm.src="data:video/webm;base64,GkXfo49CgoR3ZWJtQoeBAUKFgQEYU4BnAQAAAAAAF60RTZt0vE27jFOrhBVJqWZTrIIQA027jFOrhBZUrmtTrIIQbE27jFOrhBFNm3RTrIIXmU27jFOrhBxTu2tTrIIWs+xPvwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFUmpZuQq17GDD0JATYCjbGliZWJtbCB2MC43LjcgKyBsaWJtYXRyb3NrYSB2MC44LjFXQY9BVlNNYXRyb3NrYUZpbGVEiYRFnEAARGGIBc2Lz1QNtgBzpJCy3XZ0KNuKNZS4+fDpFxzUFlSua9iu1teBAXPFhL4G+bmDgQG5gQGIgQFVqoEAnIEAbeeBASMxT4Q/gAAAVe6BAIaFVl9WUDiqgQEj44OEE95DVSK1nIN1bmTgkbCBULqBPJqBAFSwgVBUuoE87EQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB9DtnVB4eeBAKC4obaBAAAAkAMAnQEqUAA8AABHCIWFiIWEiAICAAamYnoOC6cfJa8f5Zvda4D+/7YOf//nNefQYACgnKGWgQFNANEBAAEQEAAYABhYL/QACIhgAPuC/rOgnKGWgQKbANEBAAEQEAAYABhYL/QACIhgAPuC/rKgnKGWgQPoANEBAAEQEAAYABhYL/QACIhgAPuC/rOgnKGWgQU1ANEBAAEQEAAYABhYL/QACIhgAPuC/rOgnKGWgQaDANEBAAEQEAAYABhYL/QACIhgAPuC/rKgnKGWgQfQANEBAAEQEAAYABhYL/QACIhgAPuC/rOgnKGWgQkdANEBAAEQEBRgAGFgv9AAIiGAAPuC/rOgnKGWgQprANEBAAEQEAAYABhYL/QACIhgAPuC/rKgnKGWgQu4ANEBAAEQEAAYABhYL/QACIhgAPuC/rOgnKGWgQ0FANEBAAEQEAAYABhYL/QACIhgAPuC/rOgnKGWgQ5TANEBAAEQEAAYABhYL/QACIhgAPuC/rKgnKGWgQ+gANEBAAEQEAAYABhYL/QACIhgAPuC/rOgnKGWgRDtANEBAAEQEAAYABhYL/QACIhgAPuC/rOgnKGWgRI7ANEBAAEQEAAYABhYL/QACIhgAPuC/rIcU7trQOC7jLOBALeH94EB8YIUzLuNs4IBTbeH94EB8YIUzLuNs4ICm7eH94EB8YIUzLuNs4ID6LeH94EB8YIUzLuNs4IFNbeH94EB8YIUzLuNs4IGg7eH94EB8YIUzLuNs4IH0LeH94EB8YIUzLuNs4IJHbeH94EB8YIUzLuNs4IKa7eH94EB8YIUzLuNs4ILuLeH94EB8YIUzLuNs4INBbeH94EB8YIUzLuNs4IOU7eH94EB8YIUzLuNs4IPoLeH94EB8YIUzLuNs4IQ7beH94EB8YIUzLuNs4ISO7eH94EB8YIUzBFNm3SPTbuMU6uEH0O2dVOsghTM",autoplay_test_content.appendChild(webm),autoplay_test_content.appendChild(mp4),autoplay_test_content.id="base64_test_video",autoplay_test_content.autoplay=!0,autoplay_test_content.style.position="fixed",autoplay_test_content.style.left="5000px",document.getElementsByTagName("body")[0].appendChild(autoplay_test_content);var base64_test_video=document.getElementById("base64_test_video");setTimeout(function(){base64_test_video.paused?cbs.fail():cbs.done(),document.getElementsByTagName("body")[0].removeChild(autoplay_test_content)}.bind(this),acceptable_delay)}console.open=function(what){console.log(JSON.stringify(what,void 0,2))},function(a,b){"object"==("undefined"==typeof module?"undefined":_typeof(module))&&"object"==_typeof(module.exports)?module.exports=a.document?b(a,!0):function(a){if(!a.document)throw new Error("jQuery requires a window with a document");return b(a)}:b(a)}("undefined"!=typeof window?window:void 0,function(a,b){var c=[],d=c.slice,e=c.concat,f=c.push,g=c.indexOf,h={},i=h.toString,j=h.hasOwnProperty,k="".trim,l={},m="1.11.0",n=function n(a,b){return new n.fn.init(a,b)},o=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,p=/^-ms-/,q=/-([\da-z])/gi,r=function(a,b){return b.toUpperCase()};function s(a){var b=a.length,c=n.type(a);return"function"!==c&&!n.isWindow(a)&&(!(1!==a.nodeType||!b)||("array"===c||0===b||"number"==typeof b&&0<b&&b-1 in a))}n.fn=n.prototype={jquery:m,constructor:n,selector:"",length:0,toArray:function(){return d.call(this)},get:function(a){return null!=a?a<0?this[a+this.length]:this[a]:d.call(this)},pushStack:function(a){var b=n.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return n.each(this,a,b)},map:function(a){return this.pushStack(n.map(this,function(b,c){return a.call(b,c,b)}))},slice:function(){return this.pushStack(d.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(a<0?b:0);return this.pushStack(0<=c&&c<b?[this[c]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:f,sort:c.sort,splice:c.splice},n.extend=n.fn.extend=function(){var a,b,c,d,e,f,g=arguments[0]||{},h=1,i=arguments.length,j=!1;for("boolean"==typeof g&&(j=g,g=arguments[h]||{},h++),"object"==_typeof(g)||n.isFunction(g)||(g={}),h===i&&(g=this,h--);h<i;h++)if(null!=(e=arguments[h]))for(d in e)a=g[d],g!==(c=e[d])&&(j&&c&&(n.isPlainObject(c)||(b=n.isArray(c)))?(f=b?(b=!1,a&&n.isArray(a)?a:[]):a&&n.isPlainObject(a)?a:{},g[d]=n.extend(j,f,c)):void 0!==c&&(g[d]=c));return g},n.extend({expando:"jQuery"+(m+Math.random()).replace(/\D/g,""),isReady:!0,error:function(a){throw new Error(a)},noop:function(){},isFunction:function(a){return"function"===n.type(a)},isArray:Array.isArray||function(a){return"array"===n.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return 0<=a-parseFloat(a)},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},isPlainObject:function(a){var b;if(!a||"object"!==n.type(a)||a.nodeType||n.isWindow(a))return!1;try{if(a.constructor&&!j.call(a,"constructor")&&!j.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}if(l.ownLast)for(b in a)return j.call(a,b);for(b in a);return void 0===b||j.call(a,b)},type:function(a){return null==a?a+"":"object"==_typeof(a)||"function"==typeof a?h[i.call(a)]||"object":_typeof(a)},globalEval:function(b){b&&n.trim(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(p,"ms-").replace(q,r)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,c){var e=0,f=a.length,g=s(a);if(c){if(g)for(;e<f&&!1!==b.apply(a[e],c);e++);else for(e in a)if(!1===b.apply(a[e],c))break}else if(g)for(;e<f&&!1!==b.call(a[e],e,a[e]);e++);else for(e in a)if(!1===b.call(a[e],e,a[e]))break;return a},trim:k&&!k.call("\ufeff ")?function(a){return null==a?"":k.call(a)}:function(a){return null==a?"":(a+"").replace(o,"")},makeArray:function(a,b){var c=b||[];return null!=a&&(s(Object(a))?n.merge(c,"string"==typeof a?[a]:a):f.call(c,a)),c},inArray:function(a,b,c){var d;if(b){if(g)return g.call(b,a,c);for(d=b.length,c=c?c<0?Math.max(0,d+c):c:0;c<d;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,b){for(var c=+b.length,d=0,e=a.length;d<c;)a[e++]=b[d++];if(c!=c)for(;void 0!==b[d];)a[e++]=b[d++];return a.length=e,a},grep:function(a,b,c){for(var e=[],f=0,g=a.length,h=!c;f<g;f++)!b(a[f],f)!=h&&e.push(a[f]);return e},map:function(a,b,c){var d,f=0,g=a.length,i=[];if(s(a))for(;f<g;f++)null!=(d=b(a[f],f,c))&&i.push(d);else for(f in a)null!=(d=b(a[f],f,c))&&i.push(d);return e.apply([],i)},guid:1,proxy:function(a,b){var c,e,f;return"string"==typeof b&&(f=a[b],b=a,a=f),n.isFunction(a)?(c=d.call(arguments,2),(e=function(){return a.apply(b||this,c.concat(d.call(arguments)))}).guid=a.guid=a.guid||n.guid++,e):void 0},now:function(){return+new Date},support:l}),n.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){h["[object "+b+"]"]=b.toLowerCase()});var t=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s="sizzle"+-new Date,t=a.document,u=0,v=0,w=eb(),x=eb(),y=eb(),z=function(a,b){return a===b&&(j=!0),0},A="undefined",C={}.hasOwnProperty,D=[],E=D.pop,F=D.push,G=D.push,H=D.slice,I=D.indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(this[b]===a)return b;return-1},J="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",K="[\\x20\\t\\r\\n\\f]",L="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",M=L.replace("w","w#"),N="\\["+K+"*("+L+")"+K+"*(?:([*^$|!~]?=)"+K+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+M+")|)|)"+K+"*\\]",O=":("+L+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+N.replace(3,8)+")*)|.*)\\)|)",P=new RegExp("^"+K+"+|((?:^|[^\\\\])(?:\\\\.)*)"+K+"+$","g"),Q=new RegExp("^"+K+"*,"+K+"*"),R=new RegExp("^"+K+"*([>+~]|"+K+")"+K+"*"),S=new RegExp("="+K+"*([^\\]'\"]*?)"+K+"*\\]","g"),T=new RegExp(O),U=new RegExp("^"+M+"$"),V={ID:new RegExp("^#("+L+")"),CLASS:new RegExp("^\\.("+L+")"),TAG:new RegExp("^("+L.replace("w","w*")+")"),ATTR:new RegExp("^"+N),PSEUDO:new RegExp("^"+O),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+K+"*(even|odd|(([+-]|)(\\d*)n|)"+K+"*(?:([+-]|)"+K+"*(\\d+)|))"+K+"*\\)|)","i"),bool:new RegExp("^(?:"+J+")$","i"),needsContext:new RegExp("^"+K+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+K+"*((?:-\\d)?\\d*)"+K+"*\\)|)(?=[^-]|$)","i")},W=/^(?:input|select|textarea|button)$/i,X=/^h\d$/i,Y=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,$=/[+~]/,_=/'|\\/g,ab=new RegExp("\\\\([\\da-f]{1,6}"+K+"?|("+K+")|.)","ig"),bb=function(a,b,c){var d="0x"+b-65536;return d!=d||c?b:d<0?String.fromCharCode(65536+d):String.fromCharCode(d>>10|55296,1023&d|56320)};try{G.apply(D=H.call(t.childNodes),t.childNodes),D[t.childNodes.length].nodeType}catch(cb){G={apply:D.length?function(a,b){F.apply(a,H.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}function db(a,b,d,e){var f,g,h,i,j,m,p,q,u,v;if((b?b.ownerDocument||b:t)!==l&&k(b),d=d||[],!a||"string"!=typeof a)return d;if(1!==(i=(b=b||l).nodeType)&&9!==i)return[];if(n&&!e){if(f=Z.exec(a))if(h=f[1]){if(9===i){if(!(g=b.getElementById(h))||!g.parentNode)return d;if(g.id===h)return d.push(g),d}else if(b.ownerDocument&&(g=b.ownerDocument.getElementById(h))&&r(b,g)&&g.id===h)return d.push(g),d}else{if(f[2])return G.apply(d,b.getElementsByTagName(a)),d;if((h=f[3])&&c.getElementsByClassName&&b.getElementsByClassName)return G.apply(d,b.getElementsByClassName(h)),d}if(c.qsa&&(!o||!o.test(a))){if(q=p=s,u=b,v=9===i&&a,1===i&&"object"!==b.nodeName.toLowerCase()){for(m=ob(a),(p=b.getAttribute("id"))?q=p.replace(_,"\\$&"):b.setAttribute("id",q),q="[id='"+q+"'] ",j=m.length;j--;)m[j]=q+pb(m[j]);u=$.test(a)&&mb(b.parentNode)||b,v=m.join(",")}if(v)try{return G.apply(d,u.querySelectorAll(v)),d}catch(w){}finally{p||b.removeAttribute("id")}}}return xb(a.replace(P,"$1"),b,d,e)}function eb(){var a=[];return function b(c,e){return a.push(c+" ")>d.cacheLength&&delete b[a.shift()],b[c+" "]=e}}function fb(a){return a[s]=!0,a}function gb(a){var b=l.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function hb(a,b){for(var c=a.split("|"),e=a.length;e--;)d.attrHandle[c[e]]=b}function ib(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||1<<31)-(~a.sourceIndex||1<<31);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function jb(a){return function(b){return"input"===b.nodeName.toLowerCase()&&b.type===a}}function kb(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function lb(a){return fb(function(b){return b=+b,fb(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function mb(a){return a&&_typeof(a.getElementsByTagName)!==A&&a}for(b in c=db.support={},f=db.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return!!b&&"HTML"!==b.nodeName},k=db.setDocument=function(a){var b,e=a?a.ownerDocument||a:t,g=e.defaultView;return e!==l&&9===e.nodeType&&e.documentElement?(m=(l=e).documentElement,n=!f(e),g&&g!==g.top&&(g.addEventListener?g.addEventListener("unload",function(){k()},!1):g.attachEvent&&g.attachEvent("onunload",function(){k()})),c.attributes=gb(function(a){return a.className="i",!a.getAttribute("className")}),c.getElementsByTagName=gb(function(a){return a.appendChild(e.createComment("")),!a.getElementsByTagName("*").length}),c.getElementsByClassName=Y.test(e.getElementsByClassName)&&gb(function(a){return a.innerHTML="<div class='a'></div><div class='a i'></div>",a.firstChild.className="i",2===a.getElementsByClassName("i").length}),c.getById=gb(function(a){return m.appendChild(a).id=s,!e.getElementsByName||!e.getElementsByName(s).length}),c.getById?(d.find.ID=function(a,b){if(_typeof(b.getElementById)!==A&&n){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},d.filter.ID=function(a){var b=a.replace(ab,bb);return function(a){return a.getAttribute("id")===b}}):(delete d.find.ID,d.filter.ID=function(a){var b=a.replace(ab,bb);return function(a){var c=_typeof(a.getAttributeNode)!==A&&a.getAttributeNode("id");return c&&c.value===b}}),d.find.TAG=c.getElementsByTagName?function(a,b){return _typeof(b.getElementsByTagName)!==A?b.getElementsByTagName(a):void 0}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"!==a)return f;for(;c=f[e++];)1===c.nodeType&&d.push(c);return d},d.find.CLASS=c.getElementsByClassName&&function(a,b){return _typeof(b.getElementsByClassName)!==A&&n?b.getElementsByClassName(a):void 0},p=[],o=[],(c.qsa=Y.test(e.querySelectorAll))&&(gb(function(a){a.innerHTML="<select t=''><option selected=''></option></select>",a.querySelectorAll("[t^='']").length&&o.push("[*^$]="+K+"*(?:''|\"\")"),a.querySelectorAll("[selected]").length||o.push("\\["+K+"*(?:value|"+J+")"),a.querySelectorAll(":checked").length||o.push(":checked")}),gb(function(a){var b=e.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("name","D"),a.querySelectorAll("[name=d]").length&&o.push("name"+K+"*[*^$|!~]?="),a.querySelectorAll(":enabled").length||o.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),o.push(",.*:")})),(c.matchesSelector=Y.test(q=m.webkitMatchesSelector||m.mozMatchesSelector||m.oMatchesSelector||m.msMatchesSelector))&&gb(function(a){c.disconnectedMatch=q.call(a,"div"),q.call(a,"[s!='']:x"),p.push("!=",O)}),o=o.length&&new RegExp(o.join("|")),p=p.length&&new RegExp(p.join("|")),b=Y.test(m.compareDocumentPosition),r=b||Y.test(m.contains)?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},z=b?function(a,b){if(a===b)return j=!0,0;var d=!a.compareDocumentPosition-!b.compareDocumentPosition;return d||(1&(d=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1)||!c.sortDetached&&b.compareDocumentPosition(a)===d?a===e||a.ownerDocument===t&&r(t,a)?-1:b===e||b.ownerDocument===t&&r(t,b)?1:i?I.call(i,a)-I.call(i,b):0:4&d?-1:1)}:function(a,b){if(a===b)return j=!0,0;var c,d=0,f=a.parentNode,g=b.parentNode,h=[a],k=[b];if(!f||!g)return a===e?-1:b===e?1:f?-1:g?1:i?I.call(i,a)-I.call(i,b):0;if(f===g)return ib(a,b);for(c=a;c=c.parentNode;)h.unshift(c);for(c=b;c=c.parentNode;)k.unshift(c);for(;h[d]===k[d];)d++;return d?ib(h[d],k[d]):h[d]===t?-1:k[d]===t?1:0},e):l},db.matches=function(a,b){return db(a,null,null,b)},db.matchesSelector=function(a,b){if((a.ownerDocument||a)!==l&&k(a),b=b.replace(S,"='$1']"),!(!c.matchesSelector||!n||p&&p.test(b)||o&&o.test(b)))try{var d=q.call(a,b);if(d||c.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return 0<db(b,l,null,[a]).length},db.contains=function(a,b){return(a.ownerDocument||a)!==l&&k(a),r(a,b)},db.attr=function(a,b){(a.ownerDocument||a)!==l&&k(a);var e=d.attrHandle[b.toLowerCase()],f=e&&C.call(d.attrHandle,b.toLowerCase())?e(a,b,!n):void 0;return void 0!==f?f:c.attributes||!n?a.getAttribute(b):(f=a.getAttributeNode(b))&&f.specified?f.value:null},db.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)},db.uniqueSort=function(a){var b,d=[],e=0,f=0;if(j=!c.detectDuplicates,i=!c.sortStable&&a.slice(0),a.sort(z),j){for(;b=a[f++];)b===a[f]&&(e=d.push(f));for(;e--;)a.splice(d[e],1)}return i=null,a},e=db.getText=function(a){var b,c="",d=0,f=a.nodeType;if(f){if(1===f||9===f||11===f){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=e(a)}else if(3===f||4===f)return a.nodeValue}else for(;b=a[d++];)c+=e(b);return c},(d=db.selectors={cacheLength:50,createPseudo:fb,match:V,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(ab,bb),a[3]=(a[4]||a[5]||"").replace(ab,bb),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||db.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&db.error(a[0]),a},PSEUDO:function(a){var b,c=!a[5]&&a[2];return V.CHILD.test(a[0])?null:(a[3]&&void 0!==a[4]?a[2]=a[4]:c&&T.test(c)&&(b=ob(c,!0))&&(b=c.indexOf(")",c.length-b)-c.length)&&(a[0]=a[0].slice(0,b),a[2]=c.slice(0,b)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(ab,bb).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=w[a+" "];return b||(b=new RegExp("(^|"+K+")"+a+"("+K+"|$)"))&&w(a,function(a){return b.test("string"==typeof a.className&&a.className||_typeof(a.getAttribute)!==A&&a.getAttribute("class")||"")})},ATTR:function(a,b,c){return function(d){var e=db.attr(d,a);return null==e?"!="===b:!b||(e+="","="===b?e===c:"!="===b?e!==c:"^="===b?c&&0===e.indexOf(c):"*="===b?c&&-1<e.indexOf(c):"$="===b?c&&e.slice(-c.length)===c:"~="===b?-1<(" "+e+" ").indexOf(c):"|="===b&&(e===c||e.slice(0,c.length+1)===c+"-"))}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!=g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),t=!i&&!h;if(q){if(f){for(;p;){for(l=b;l=l[p];)if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&t){for(n=(j=(k=q[s]||(q[s]={}))[a]||[])[0]===u&&j[1],m=j[0]===u&&j[2],l=n&&q.childNodes[n];l=++n&&l&&l[p]||(m=n=0)||o.pop();)if(1===l.nodeType&&++m&&l===b){k[a]=[u,n,m];break}}else if(t&&(j=(b[s]||(b[s]={}))[a])&&j[0]===u)m=j[1];else for(;(l=++n&&l&&l[p]||(m=n=0)||o.pop())&&((h?l.nodeName.toLowerCase()!==r:1!==l.nodeType)||!++m||(t&&((l[s]||(l[s]={}))[a]=[u,m]),l!==b)););return(m-=e)===d||m%d==0&&0<=m/d}}},PSEUDO:function(a,b){var c,e=d.pseudos[a]||d.setFilters[a.toLowerCase()]||db.error("unsupported pseudo: "+a);return e[s]?e(b):1<e.length?(c=[a,a,"",b],d.setFilters.hasOwnProperty(a.toLowerCase())?fb(function(a,c){for(var d,f=e(a,b),g=f.length;g--;)a[d=I.call(a,f[g])]=!(c[d]=f[g])}):function(a){return e(a,0,c)}):e}},pseudos:{not:fb(function(a){var b=[],c=[],d=g(a.replace(P,"$1"));return d[s]?fb(function(a,b,c,e){for(var f,g=d(a,null,e,[]),h=a.length;h--;)(f=g[h])&&(a[h]=!(b[h]=f))}):function(a,e,f){return b[0]=a,d(b,null,f,c),!c.pop()}}),has:fb(function(a){return function(b){return 0<db(a,b).length}}),contains:fb(function(a){return function(b){return-1<(b.textContent||b.innerText||e(b)).indexOf(a)}}),lang:fb(function(a){return U.test(a||"")||db.error("unsupported lang: "+a),a=a.replace(ab,bb).toLowerCase(),function(b){var c;do{if(c=n?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return(c=c.toLowerCase())===a||0===c.indexOf(a+"-")}while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===m},focus:function(a){return a===l.activeElement&&(!l.hasFocus||l.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return!1===a.disabled},disabled:function(a){return!0===a.disabled},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,!0===a.selected},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeType<6)return!1;return!0},parent:function(a){return!d.pseudos.empty(a)},header:function(a){return X.test(a.nodeName)},input:function(a){return W.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||"text"===b.toLowerCase())},first:lb(function(){return[0]}),last:lb(function(a,b){return[b-1]}),eq:lb(function(a,b,c){return[c<0?c+b:c]}),even:lb(function(a,b){for(var c=0;c<b;c+=2)a.push(c);return a}),odd:lb(function(a,b){for(var c=1;c<b;c+=2)a.push(c);return a}),lt:lb(function(a,b,c){for(var d=c<0?c+b:c;0<=--d;)a.push(d);return a}),gt:lb(function(a,b,c){for(var d=c<0?c+b:c;++d<b;)a.push(d);return a})}}).pseudos.nth=d.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})d.pseudos[b]=jb(b);for(b in{submit:!0,reset:!0})d.pseudos[b]=kb(b);function nb(){}function ob(a,b){var c,e,f,g,h,i,j,k=x[a+" "];if(k)return b?0:k.slice(0);for(h=a,i=[],j=d.preFilter;h;){for(g in c&&!(e=Q.exec(h))||(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),c=!1,(e=R.exec(h))&&(c=e.shift(),f.push({value:c,type:e[0].replace(P," ")}),h=h.slice(c.length)),d.filter)!(e=V[g].exec(h))||j[g]&&!(e=j[g](e))||(c=e.shift(),f.push({value:c,type:g,matches:e}),h=h.slice(c.length));if(!c)break}return b?h.length:h?db.error(a):x(a,i).slice(0)}function pb(a){for(var b=0,c=a.length,d="";b<c;b++)d+=a[b].value;return d}function qb(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=v++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j=[u,f];if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e){if((h=(i=b[s]||(b[s]={}))[d])&&h[0]===u&&h[1]===f)return j[2]=h[2];if((i[d]=j)[2]=a(b,c,g))return!0}}}function rb(a){return 1<a.length?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function sb(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;h<i;h++)!(f=a[h])||c&&!c(f,d,e)||(g.push(f),j&&b.push(h));return g}function tb(a,b,c,d,e,f){return d&&!d[s]&&(d=tb(d)),e&&!e[s]&&(e=tb(e,f)),fb(function(f,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=f||function(a,b,c){for(var d=0,e=b.length;d<e;d++)db(a,b[d],c);return c}(b||"*",h.nodeType?[h]:h,[]),q=!a||!f&&b?p:sb(p,m,a,h,i),r=c?e||(f?a:o||d)?[]:g:q;if(c&&c(q,r,h,i),d)for(j=sb(r,n),d(j,[],h,i),k=j.length;k--;)(l=j[k])&&(r[n[k]]=!(q[n[k]]=l));if(f){if(e||a){if(e){for(j=[],k=r.length;k--;)(l=r[k])&&j.push(q[k]=l);e(null,r=[],j,i)}for(k=r.length;k--;)(l=r[k])&&-1<(j=e?I.call(f,l):m[k])&&(f[j]=!(g[j]=l))}}else r=sb(r===g?r.splice(o,r.length):r),e?e(null,g,r,i):G.apply(g,r)})}function ub(a){for(var b,c,e,f=a.length,g=d.relative[a[0].type],i=g||d.relative[" "],j=g?1:0,k=qb(function(a){return a===b},i,!0),l=qb(function(a){return-1<I.call(b,a)},i,!0),m=[function(a,c,d){return!g&&(d||c!==h)||((b=c).nodeType?k(a,c,d):l(a,c,d))}];j<f;j++)if(c=d.relative[a[j].type])m=[qb(rb(m),c)];else{if((c=d.filter[a[j].type].apply(null,a[j].matches))[s]){for(e=++j;e<f&&!d.relative[a[e].type];e++);return tb(1<j&&rb(m),1<j&&pb(a.slice(0,j-1).concat({value:" "===a[j-2].type?"*":""})).replace(P,"$1"),c,j<e&&ub(a.slice(j,e)),e<f&&ub(a=a.slice(e)),e<f&&pb(a))}m.push(c)}return rb(m)}function vb(a,b){var c=0<b.length,e=0<a.length,f=function(_f,g,i,j,k){var m,n,o,p=0,q="0",r=_f&&[],s=[],t=h,v=_f||e&&d.find.TAG("*",k),w=u+=null==t?1:Math.random()||.1,x=v.length;for(k&&(h=g!==l&&g);q!==x&&null!=(m=v[q]);q++){if(e&&m){for(n=0;o=a[n++];)if(o(m,g,i)){j.push(m);break}k&&(u=w)}c&&((m=!o&&m)&&p--,_f&&r.push(m))}if(p+=q,c&&q!==p){for(n=0;o=b[n++];)o(r,s,g,i);if(_f){if(0<p)for(;q--;)r[q]||s[q]||(s[q]=E.call(j));s=sb(s)}G.apply(j,s),k&&!_f&&0<s.length&&1<p+b.length&&db.uniqueSort(j)}return k&&(u=w,h=t),r};return c?fb(f):f}function xb(a,b,e,f){var h,i,j,k,l,m=ob(a);if(!f&&1===m.length){if(2<(i=m[0]=m[0].slice(0)).length&&"ID"===(j=i[0]).type&&c.getById&&9===b.nodeType&&n&&d.relative[i[1].type]){if(!(b=(d.find.ID(j.matches[0].replace(ab,bb),b)||[])[0]))return e;a=a.slice(i.shift().value.length)}for(h=V.needsContext.test(a)?0:i.length;h--&&(j=i[h],!d.relative[k=j.type]);)if((l=d.find[k])&&(f=l(j.matches[0].replace(ab,bb),$.test(i[0].type)&&mb(b.parentNode)||b))){if(i.splice(h,1),!(a=f.length&&pb(i)))return G.apply(e,f),e;break}}return g(a,m)(f,b,!n,e,$.test(a)&&mb(b.parentNode)||b),e}return nb.prototype=d.filters=d.pseudos,d.setFilters=new nb,g=db.compile=function(a,b){var c,d=[],e=[],f=y[a+" "];if(!f){for(b||(b=ob(a)),c=b.length;c--;)(f=ub(b[c]))[s]?d.push(f):e.push(f);f=y(a,vb(e,d))}return f},c.sortStable=s.split("").sort(z).join("")===s,c.detectDuplicates=!!j,k(),c.sortDetached=gb(function(a){return 1&a.compareDocumentPosition(l.createElement("div"))}),gb(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||hb("type|href|height|width",function(a,b,c){return c?void 0:a.getAttribute(b,"type"===b.toLowerCase()?1:2)}),c.attributes&&gb(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||hb("value",function(a,b,c){return c||"input"!==a.nodeName.toLowerCase()?void 0:a.defaultValue}),gb(function(a){return null==a.getAttribute("disabled")})||hb(J,function(a,b,c){var d;return c?void 0:!0===a[b]?b.toLowerCase():(d=a.getAttributeNode(b))&&d.specified?d.value:null}),db}(a);n.find=t,n.expr=t.selectors,n.expr[":"]=n.expr.pseudos,n.unique=t.uniqueSort,n.text=t.getText,n.isXMLDoc=t.isXML,n.contains=t.contains;var u=n.expr.match.needsContext,v=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,w=/^.[^:#\[\.,]*$/;function x(a,b,c){if(n.isFunction(b))return n.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return n.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(w.test(b))return n.filter(b,a,c);b=n.filter(b,a)}return n.grep(a,function(a){return 0<=n.inArray(a,b)!==c})}n.filter=function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?n.find.matchesSelector(d,a)?[d]:[]:n.find.matches(a,n.grep(b,function(a){return 1===a.nodeType}))},n.fn.extend({find:function(a){var b,c=[],d=this,e=d.length;if("string"!=typeof a)return this.pushStack(n(a).filter(function(){for(b=0;b<e;b++)if(n.contains(d[b],this))return!0}));for(b=0;b<e;b++)n.find(a,d[b],c);return(c=this.pushStack(1<e?n.unique(c):c)).selector=this.selector?this.selector+" "+a:a,c},filter:function(a){return this.pushStack(x(this,a||[],!1))},not:function(a){return this.pushStack(x(this,a||[],!0))},is:function(a){return!!x(this,"string"==typeof a&&u.test(a)?n(a):a||[],!1).length}});var y,z=a.document,A=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(n.fn.init=function(a,b){var c,d;if(!a)return this;if("string"!=typeof a)return a.nodeType?(this.context=this[0]=a,this.length=1,this):n.isFunction(a)?void 0!==y.ready?y.ready(a):a(n):(void 0!==a.selector&&(this.selector=a.selector,this.context=a.context),n.makeArray(a,this));if(!(c="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&3<=a.length?[null,a,null]:A.exec(a))||!c[1]&&b)return!b||b.jquery?(b||y).find(a):this.constructor(b).find(a);if(c[1]){if(b=b instanceof n?b[0]:b,n.merge(this,n.parseHTML(c[1],b&&b.nodeType?b.ownerDocument||b:z,!0)),v.test(c[1])&&n.isPlainObject(b))for(c in b)n.isFunction(this[c])?this[c](b[c]):this.attr(c,b[c]);return this}if((d=z.getElementById(c[2]))&&d.parentNode){if(d.id!==c[2])return y.find(a);this.length=1,this[0]=d}return this.context=z,this.selector=a,this}).prototype=n.fn,y=n(z);var C=/^(?:parents|prev(?:Until|All))/,D={children:!0,contents:!0,next:!0,prev:!0};function E(a,b){for(;(a=a[b])&&1!==a.nodeType;);return a}n.extend({dir:function(a,b,c){for(var d=[],e=a[b];e&&9!==e.nodeType&&(void 0===c||1!==e.nodeType||!n(e).is(c));)1===e.nodeType&&d.push(e),e=e[b];return d},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}}),n.fn.extend({has:function(a){var b,c=n(a,this),d=c.length;return this.filter(function(){for(b=0;b<d;b++)if(n.contains(this,c[b]))return!0})},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=u.test(a)||"string"!=typeof a?n(a,b||this.context):0;d<e;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(c.nodeType<11&&(g?-1<g.index(c):1===c.nodeType&&n.find.matchesSelector(c,a))){f.push(c);break}return this.pushStack(1<f.length?n.unique(f):f)},index:function(a){return a?"string"==typeof a?n.inArray(this[0],n(a)):n.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){return this.pushStack(n.unique(n.merge(this.get(),n(a,b))))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),n.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return n.dir(a,"parentNode")},parentsUntil:function(a,b,c){return n.dir(a,"parentNode",c)},next:function(a){return E(a,"nextSibling")},prev:function(a){return E(a,"previousSibling")},nextAll:function(a){return n.dir(a,"nextSibling")},prevAll:function(a){return n.dir(a,"previousSibling")},nextUntil:function(a,b,c){return n.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return n.dir(a,"previousSibling",c)},siblings:function(a){return n.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return n.sibling(a.firstChild)},contents:function(a){return n.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:n.merge([],a.childNodes)}},function(a,b){n.fn[a]=function(c,d){var e=n.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=n.filter(d,e)),1<this.length&&(D[a]||(e=n.unique(e)),C.test(a)&&(e=e.reverse())),this.pushStack(e)}});var I,F=/\S+/g,G={};function J(){z.addEventListener?(z.removeEventListener("DOMContentLoaded",K,!1),a.removeEventListener("load",K,!1)):(z.detachEvent("onreadystatechange",K),a.detachEvent("onload",K))}function K(){!z.addEventListener&&"load"!==event.type&&"complete"!==z.readyState||(J(),n.ready())}n.Callbacks=function(a){a="string"==typeof a?G[a]||function(a){var b=G[a]={};return n.each(a.match(F)||[],function(a,c){b[c]=!0}),b}(a):n.extend({},a);function j(l){for(c=a.memory&&l,d=!0,f=g||0,g=0,e=h.length,b=!0;h&&f<e;f++)if(!1===h[f].apply(l[0],l[1])&&a.stopOnFalse){c=!1;break}b=!1,h&&(i?i.length&&j(i.shift()):c?h=[]:k.disable())}var b,c,d,e,f,g,h=[],i=!a.once&&[],k={add:function(){if(h){var d=h.length;!function f(b){n.each(b,function(b,c){var d=n.type(c);"function"===d?a.unique&&k.has(c)||h.push(c):c&&c.length&&"string"!==d&&f(c)})}(arguments),b?e=h.length:c&&(g=d,j(c))}return this},remove:function(){return h&&n.each(arguments,function(a,c){for(var d;-1<(d=n.inArray(c,h,d));)h.splice(d,1),b&&(d<=e&&e--,d<=f&&f--)}),this},has:function(a){return a?-1<n.inArray(a,h):!(!h||!h.length)},empty:function(){return h=[],e=0,this},disable:function(){return h=i=c=void 0,this},disabled:function(){return!h},lock:function(){return i=void 0,c||k.disable(),this},locked:function(){return!i},fireWith:function(a,c){return!h||d&&!i||(c=[a,(c=c||[]).slice?c.slice():c],b?i.push(c):j(c)),this},fire:function(){return k.fireWith(this,arguments),this},fired:function(){return!!d}};return k},n.extend({Deferred:function(a){var b=[["resolve","done",n.Callbacks("once memory"),"resolved"],["reject","fail",n.Callbacks("once memory"),"rejected"],["notify","progress",n.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return n.Deferred(function(c){n.each(b,function(b,f){var g=n.isFunction(a[b])&&a[b];e[f[1]](function(){var a=g&&g.apply(this,arguments);a&&n.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[f[0]+"With"](this===d?c.promise():this,g?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?n.extend(a,d):d}},e={};return d.pipe=d.then,n.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var i,j,k,b=0,c=d.call(arguments),e=c.length,f=1!==e||a&&n.isFunction(a.promise)?e:0,g=1===f?a:n.Deferred(),h=function(a,b,c){return function(e){b[a]=this,c[a]=1<arguments.length?d.call(arguments):e,c===i?g.notifyWith(b,c):--f||g.resolveWith(b,c)}};if(1<e)for(i=new Array(e),j=new Array(e),k=new Array(e);b<e;b++)c[b]&&n.isFunction(c[b].promise)?c[b].promise().done(h(b,k,c)).fail(g.reject).progress(h(b,j,i)):--f;return f||g.resolveWith(k,c),g.promise()}}),n.fn.ready=function(a){return n.ready.promise().done(a),this},n.extend({isReady:!1,readyWait:1,holdReady:function(a){a?n.readyWait++:n.ready(!0)},ready:function(a){if(!0===a?!--n.readyWait:!n.isReady){if(!z.body)return setTimeout(n.ready);(n.isReady=!0)!==a&&0<--n.readyWait||(I.resolveWith(z,[n]),n.fn.trigger&&n(z).trigger("ready").off("ready"))}}}),n.ready.promise=function(b){if(!I)if(I=n.Deferred(),"complete"===z.readyState)setTimeout(n.ready);else if(z.addEventListener)z.addEventListener("DOMContentLoaded",K,!1),a.addEventListener("load",K,!1);else{z.attachEvent("onreadystatechange",K),a.attachEvent("onload",K);var c=!1;try{c=null==a.frameElement&&z.documentElement}catch(d){}c&&c.doScroll&&!function e(){if(!n.isReady){try{c.doScroll("left")}catch(a){return setTimeout(e,50)}J(),n.ready()}}()}return I.promise(b)};var M,L="undefined";for(M in n(l))break;l.ownLast="0"!==M,l.inlineBlockNeedsLayout=!1,n(function(){var a,b,c=z.getElementsByTagName("body")[0];c&&((a=z.createElement("div")).style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",b=z.createElement("div"),c.appendChild(a).appendChild(b),_typeof(b.style.zoom)!==L&&(b.style.cssText="border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1",(l.inlineBlockNeedsLayout=3===b.offsetWidth)&&(c.style.zoom=1)),c.removeChild(a),a=b=null)}),function(){var a=z.createElement("div");if(null==l.deleteExpando){l.deleteExpando=!0;try{delete a.test}catch(b){l.deleteExpando=!1}}a=null}(),n.acceptData=function(a){var b=n.noData[(a.nodeName+" ").toLowerCase()],c=+a.nodeType||1;return(1===c||9===c)&&(!b||!0!==b&&a.getAttribute("classid")===b)};var N=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,O=/([A-Z])/g;function P(a,b,c){if(void 0===c&&1===a.nodeType){var d="data-"+b.replace(O,"-$1").toLowerCase();if("string"==typeof(c=a.getAttribute(d))){try{c="true"===c||"false"!==c&&("null"===c?null:+c+""===c?+c:N.test(c)?n.parseJSON(c):c)}catch(e){}n.data(a,b,c)}else c=void 0}return c}function Q(a){var b;for(b in a)if(("data"!==b||!n.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;return!0}function R(a,b,d,e){if(n.acceptData(a)){var f,g,h=n.expando,i=a.nodeType,j=i?n.cache:a,k=i?a[h]:a[h]&&h;if(k&&j[k]&&(e||j[k].data)||void 0!==d||"string"!=typeof b)return k||(k=i?a[h]=c.pop()||n.guid++:h),j[k]||(j[k]=i?{}:{toJSON:n.noop}),"object"!=_typeof(b)&&"function"!=typeof b||(e?j[k]=n.extend(j[k],b):j[k].data=n.extend(j[k].data,b)),g=j[k],e||(g.data||(g.data={}),g=g.data),void 0!==d&&(g[n.camelCase(b)]=d),"string"==typeof b?null==(f=g[b])&&(f=g[n.camelCase(b)]):f=g,f}}function S(a,b,c){if(n.acceptData(a)){var d,e,f=a.nodeType,g=f?n.cache:a,h=f?a[n.expando]:n.expando;if(g[h]){if(b&&(d=c?g[h]:g[h].data)){e=(b=n.isArray(b)?b.concat(n.map(b,n.camelCase)):b in d?[b]:(b=n.camelCase(b))in d?[b]:b.split(" ")).length;for(;e--;)delete d[b[e]];if(c?!Q(d):!n.isEmptyObject(d))return}(c||(delete g[h].data,Q(g[h])))&&(f?n.cleanData([a],!0):l.deleteExpando||g!=g.window?delete g[h]:g[h]=null)}}}n.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(a){return!!(a=a.nodeType?n.cache[a[n.expando]]:a[n.expando])&&!Q(a)},data:function(a,b,c){return R(a,b,c)},removeData:function(a,b){return S(a,b)},_data:function(a,b,c){return R(a,b,c,!0)},_removeData:function(a,b){return S(a,b,!0)}}),n.fn.extend({data:function(a,b){var c,d,e,f=this[0],g=f&&f.attributes;if(void 0!==a)return"object"==_typeof(a)?this.each(function(){n.data(this,a)}):1<arguments.length?this.each(function(){n.data(this,a,b)}):f?P(f,a,n.data(f,a)):void 0;if(this.length&&(e=n.data(f),1===f.nodeType&&!n._data(f,"parsedAttrs"))){for(c=g.length;c--;)0===(d=g[c].name).indexOf("data-")&&P(f,d=n.camelCase(d.slice(5)),e[d]);n._data(f,"parsedAttrs",!0)}return e},removeData:function(a){return this.each(function(){n.removeData(this,a)})}}),n.extend({queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=n._data(a,b),c&&(!d||n.isArray(c)?d=n._data(a,b,n.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=n.queue(a,b),d=c.length,e=c.shift(),f=n._queueHooks(a,b);"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,function(){n.dequeue(a,b)},f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return n._data(a,c)||n._data(a,c,{empty:n.Callbacks("once memory").add(function(){n._removeData(a,b+"queue"),n._removeData(a,c)})})}}),n.fn.extend({queue:function(a,b){var c=2;return"string"!=typeof a&&(b=a,a="fx",c--),arguments.length<c?n.queue(this[0],a):void 0===b?this:this.each(function(){var c=n.queue(this,a,b);n._queueHooks(this,a),"fx"===a&&"inprogress"!==c[0]&&n.dequeue(this,a)})},dequeue:function(a){return this.each(function(){n.dequeue(this,a)})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,b){var c,d=1,e=n.Deferred(),f=this,g=this.length,h=function(){--d||e.resolveWith(f,[f])};for("string"!=typeof a&&(b=a,a=void 0),a=a||"fx";g--;)(c=n._data(f[g],a+"queueHooks"))&&c.empty&&(d++,c.empty.add(h));return h(),e.promise(b)}});var T=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,U=["Top","Right","Bottom","Left"],V=function(a,b){return a=b||a,"none"===n.css(a,"display")||!n.contains(a.ownerDocument,a)},W=n.access=function(a,b,c,d,e,f,g){var h=0,i=a.length,j=null==c;if("object"===n.type(c))for(h in e=!0,c)n.access(a,b,h,c[h],!0,f,g);else if(void 0!==d&&(e=!0,n.isFunction(d)||(g=!0),j&&(b=g?(b.call(a,d),null):(j=b,function(a,_b2,c){return j.call(n(a),c)})),b))for(;h<i;h++)b(a[h],c,g?d:d.call(a[h],h,b(a[h],c)));return e?a:j?b.call(a):i?b(a[0],c):f},X=/^(?:checkbox|radio)$/i;!function(){var a=z.createDocumentFragment(),b=z.createElement("div"),c=z.createElement("input");if(b.setAttribute("className","t"),b.innerHTML="  <link/><table></table><a href='/a'>a</a>",l.leadingWhitespace=3===b.firstChild.nodeType,l.tbody=!b.getElementsByTagName("tbody").length,l.htmlSerialize=!!b.getElementsByTagName("link").length,l.html5Clone="<:nav></:nav>"!==z.createElement("nav").cloneNode(!0).outerHTML,c.type="checkbox",c.checked=!0,a.appendChild(c),l.appendChecked=c.checked,b.innerHTML="<textarea>x</textarea>",l.noCloneChecked=!!b.cloneNode(!0).lastChild.defaultValue,a.appendChild(b),b.innerHTML="<input type='radio' checked='checked' name='t'/>",l.checkClone=b.cloneNode(!0).cloneNode(!0).lastChild.checked,l.noCloneEvent=!0,b.attachEvent&&(b.attachEvent("onclick",function(){l.noCloneEvent=!1}),b.cloneNode(!0).click()),null==l.deleteExpando){l.deleteExpando=!0;try{delete b.test}catch(d){l.deleteExpando=!1}}a=b=c=null}(),function(){var b,c,d=z.createElement("div");for(b in{submit:!0,change:!0,focusin:!0})c="on"+b,(l[b+"Bubbles"]=c in a)||(d.setAttribute(c,"t"),l[b+"Bubbles"]=!1===d.attributes[c].expando);d=null}();var Y=/^(?:input|select|textarea)$/i,Z=/^key/,$=/^(?:mouse|contextmenu)|click/,_=/^(?:focusinfocus|focusoutblur)$/,ab=/^([^.]*)(?:\.(.+)|)$/;function bb(){return!0}function cb(){return!1}function db(){try{return z.activeElement}catch(a){}}function eb(a){var b=fb.split("|"),c=a.createDocumentFragment();if(c.createElement)for(;b.length;)c.createElement(b.pop());return c}n.event={global:{},add:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=n._data(a);if(r){for(c.handler&&(c=(i=c).handler,e=i.selector),c.guid||(c.guid=n.guid++),(g=r.events)||(g=r.events={}),(k=r.handle)||((k=r.handle=function(a){return _typeof(n)===L||a&&n.event.triggered===a.type?void 0:n.event.dispatch.apply(k.elem,arguments)}).elem=a),h=(b=(b||"").match(F)||[""]).length;h--;)o=q=(f=ab.exec(b[h])||[])[1],p=(f[2]||"").split(".").sort(),o&&(j=n.event.special[o]||{},o=(e?j.delegateType:j.bindType)||o,j=n.event.special[o]||{},l=n.extend({type:o,origType:q,data:d,handler:c,guid:c.guid,selector:e,needsContext:e&&n.expr.match.needsContext.test(e),namespace:p.join(".")},i),(m=g[o])||((m=g[o]=[]).delegateCount=0,j.setup&&!1!==j.setup.call(a,d,p,k)||(a.addEventListener?a.addEventListener(o,k,!1):a.attachEvent&&a.attachEvent("on"+o,k))),j.add&&(j.add.call(a,l),l.handler.guid||(l.handler.guid=c.guid)),e?m.splice(m.delegateCount++,0,l):m.push(l),n.event.global[o]=!0);a=null}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,o,p,q,r=n.hasData(a)&&n._data(a);if(r&&(k=r.events)){for(j=(b=(b||"").match(F)||[""]).length;j--;)if(o=q=(h=ab.exec(b[j])||[])[1],p=(h[2]||"").split(".").sort(),o){for(l=n.event.special[o]||{},m=k[o=(d?l.delegateType:l.bindType)||o]||[],h=h[2]&&new RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"),i=f=m.length;f--;)g=m[f],!e&&q!==g.origType||c&&c.guid!==g.guid||h&&!h.test(g.namespace)||d&&d!==g.selector&&("**"!==d||!g.selector)||(m.splice(f,1),g.selector&&m.delegateCount--,l.remove&&l.remove.call(a,g));i&&!m.length&&(l.teardown&&!1!==l.teardown.call(a,p,r.handle)||n.removeEvent(a,o,r.handle),delete k[o])}else for(o in k)n.event.remove(a,o+b[j],c,d,!0);n.isEmptyObject(k)&&(delete r.handle,n._removeData(a,"events"))}},trigger:function(b,c,d,e){var f,g,h,i,k,l,m,o=[d||z],p=j.call(b,"type")?b.type:b,q=j.call(b,"namespace")?b.namespace.split("."):[];if(h=l=d=d||z,3!==d.nodeType&&8!==d.nodeType&&!_.test(p+n.event.triggered)&&(0<=p.indexOf(".")&&(p=(q=p.split(".")).shift(),q.sort()),g=p.indexOf(":")<0&&"on"+p,(b=b[n.expando]?b:new n.Event(p,"object"==_typeof(b)&&b)).isTrigger=e?2:3,b.namespace=q.join("."),b.namespace_re=b.namespace?new RegExp("(^|\\.)"+q.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,b.result=void 0,b.target||(b.target=d),c=null==c?[b]:n.makeArray(c,[b]),k=n.event.special[p]||{},e||!k.trigger||!1!==k.trigger.apply(d,c))){if(!e&&!k.noBubble&&!n.isWindow(d)){for(i=k.delegateType||p,_.test(i+p)||(h=h.parentNode);h;h=h.parentNode)o.push(h),l=h;l===(d.ownerDocument||z)&&o.push(l.defaultView||l.parentWindow||a)}for(m=0;(h=o[m++])&&!b.isPropagationStopped();)b.type=1<m?i:k.bindType||p,(f=(n._data(h,"events")||{})[b.type]&&n._data(h,"handle"))&&f.apply(h,c),(f=g&&h[g])&&f.apply&&n.acceptData(h)&&(b.result=f.apply(h,c),!1===b.result&&b.preventDefault());if(b.type=p,!e&&!b.isDefaultPrevented()&&(!k._default||!1===k._default.apply(o.pop(),c))&&n.acceptData(d)&&g&&d[p]&&!n.isWindow(d)){(l=d[g])&&(d[g]=null),n.event.triggered=p;try{d[p]()}catch(r){}n.event.triggered=void 0,l&&(d[g]=l)}return b.result}},dispatch:function(a){a=n.event.fix(a);var b,c,e,f,g,h=[],i=d.call(arguments),j=(n._data(this,"events")||{})[a.type]||[],k=n.event.special[a.type]||{};if((i[0]=a).delegateTarget=this,!k.preDispatch||!1!==k.preDispatch.call(this,a)){for(h=n.event.handlers.call(this,a,j),b=0;(f=h[b++])&&!a.isPropagationStopped();)for(a.currentTarget=f.elem,g=0;(e=f.handlers[g++])&&!a.isImmediatePropagationStopped();)a.namespace_re&&!a.namespace_re.test(e.namespace)||(a.handleObj=e,a.data=e.data,void 0!==(c=((n.event.special[e.origType]||{}).handle||e.handler).apply(f.elem,i))&&!1===(a.result=c)&&(a.preventDefault(),a.stopPropagation()));return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,b){var c,d,e,f,g=[],h=b.delegateCount,i=a.target;if(h&&i.nodeType&&(!a.button||"click"!==a.type))for(;i!=this;i=i.parentNode||this)if(1===i.nodeType&&(!0!==i.disabled||"click"!==a.type)){for(e=[],f=0;f<h;f++)void 0===e[c=(d=b[f]).selector+" "]&&(e[c]=d.needsContext?0<=n(c,this).index(i):n.find(c,this,null,[i]).length),e[c]&&e.push(d);e.length&&g.push({elem:i,handlers:e})}return h<b.length&&g.push({elem:this,handlers:b.slice(h)}),g},fix:function(a){if(a[n.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];for(g||(this.fixHooks[e]=g=$.test(e)?this.mouseHooks:Z.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new n.Event(f),b=d.length;b--;)a[c=d[b]]=f[c];return a.target||(a.target=f.srcElement||z),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey=!!a.metaKey,g.filter?g.filter(a,f):a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,b){var c,d,e,f=b.button,g=b.fromElement;return null==a.pageX&&null!=b.clientX&&(e=(d=a.target.ownerDocument||z).documentElement,c=d.body,a.pageX=b.clientX+(e&&e.scrollLeft||c&&c.scrollLeft||0)-(e&&e.clientLeft||c&&c.clientLeft||0),a.pageY=b.clientY+(e&&e.scrollTop||c&&c.scrollTop||0)-(e&&e.clientTop||c&&c.clientTop||0)),!a.relatedTarget&&g&&(a.relatedTarget=g===a.target?b.toElement:g),a.which||void 0===f||(a.which=1&f?1:2&f?3:4&f?2:0),a}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==db()&&this.focus)try{return this.focus(),!1}catch(a){}},delegateType:"focusin"},blur:{trigger:function(){return this===db()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return n.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(a){return n.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){void 0!==a.result&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=n.extend(new n.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?n.event.trigger(e,null,b):n.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},n.removeEvent=z.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){var d="on"+b;a.detachEvent&&(_typeof(a[d])===L&&(a[d]=null),a.detachEvent(d,c))},n.Event=function(a,b){return this instanceof n.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||void 0===a.defaultPrevented&&(!1===a.returnValue||a.getPreventDefault&&a.getPreventDefault())?bb:cb):this.type=a,b&&n.extend(this,b),this.timeStamp=a&&a.timeStamp||n.now(),void(this[n.expando]=!0)):new n.Event(a,b)},n.Event.prototype={isDefaultPrevented:cb,isPropagationStopped:cb,isImmediatePropagationStopped:cb,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=bb,a&&(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=bb,a&&(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=bb,this.stopPropagation()}},n.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){n.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,e=a.relatedTarget,f=a.handleObj;return e&&(e===this||n.contains(this,e))||(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),l.submitBubbles||(n.event.special.submit={setup:function(){return!n.nodeName(this,"form")&&void n.event.add(this,"click._submit keypress._submit",function(a){var b=a.target,c=n.nodeName(b,"input")||n.nodeName(b,"button")?b.form:void 0;c&&!n._data(c,"submitBubbles")&&(n.event.add(c,"submit._submit",function(a){a._submit_bubble=!0}),n._data(c,"submitBubbles",!0))})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&n.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){return!n.nodeName(this,"form")&&void n.event.remove(this,"._submit")}}),l.changeBubbles||(n.event.special.change={setup:function(){return Y.test(this.nodeName)?("checkbox"!==this.type&&"radio"!==this.type||(n.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=!0)}),n.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1),n.event.simulate("change",this,a,!0)})),!1):void n.event.add(this,"beforeactivate._change",function(a){var b=a.target;Y.test(b.nodeName)&&!n._data(b,"changeBubbles")&&(n.event.add(b,"change._change",function(a){!this.parentNode||a.isSimulated||a.isTrigger||n.event.simulate("change",this.parentNode,a,!0)}),n._data(b,"changeBubbles",!0))})},handle:function(a){var b=a.target;return this!==b||a.isSimulated||a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type?a.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return n.event.remove(this,"._change"),!Y.test(this.nodeName)}}),l.focusinBubbles||n.each({focus:"focusin",blur:"focusout"},function(a,b){var c=function(a){n.event.simulate(b,a.target,n.event.fix(a),!0)};n.event.special[b]={setup:function(){var d=this.ownerDocument||this,e=n._data(d,b);e||d.addEventListener(a,c,!0),n._data(d,b,(e||0)+1)},teardown:function(){var d=this.ownerDocument||this,e=n._data(d,b)-1;e?n._data(d,b,e):(d.removeEventListener(a,c,!0),n._removeData(d,b))}}}),n.fn.extend({on:function(a,b,c,d,e){var f,g;if("object"==_typeof(a)){for(f in"string"!=typeof b&&(c=c||b,b=void 0),a)this.on(f,b,c,a[f],e);return this}if(null==c&&null==d?(d=b,c=b=void 0):null==d&&("string"==typeof b?(d=c,c=void 0):(d=c,c=b,b=void 0)),!1===d)d=cb;else if(!d)return this;return 1===e&&(g=d,(d=function(a){return n().off(a),g.apply(this,arguments)}).guid=g.guid||(g.guid=n.guid++)),this.each(function(){n.event.add(this,a,d,c,b)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,b,c){var d,e;if(a&&a.preventDefault&&a.handleObj)return d=a.handleObj,n(a.delegateTarget).off(d.namespace?d.origType+"."+d.namespace:d.origType,d.selector,d.handler),this;if("object"!=_typeof(a))return!1!==b&&"function"!=typeof b||(c=b,b=void 0),!1===c&&(c=cb),this.each(function(){n.event.remove(this,a,c,b)});for(e in a)this.off(e,b,a[e]);return this},trigger:function(a,b){return this.each(function(){n.event.trigger(a,b,this)})},triggerHandler:function(a,b){var c=this[0];return c?n.event.trigger(a,b,c,!0):void 0}});var fb="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",gb=/ jQuery\d+="(?:null|\d+)"/g,hb=new RegExp("<(?:"+fb+")[\\s/>]","i"),ib=/^\s+/,jb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,kb=/<([\w:]+)/,lb=/<tbody/i,mb=/<|&#?\w+;/,nb=/<(?:script|style|link)/i,ob=/checked\s*(?:[^=]|=\s*.checked.)/i,pb=/^$|\/(?:java|ecma)script/i,qb=/^true\/(.*)/,rb=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,sb={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:l.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},ub=eb(z).appendChild(z.createElement("div"));function vb(a,b){var c,d,e=0,f=_typeof(a.getElementsByTagName)!==L?a.getElementsByTagName(b||"*"):_typeof(a.querySelectorAll)!==L?a.querySelectorAll(b||"*"):void 0;if(!f)for(f=[],c=a.childNodes||a;null!=(d=c[e]);e++)!b||n.nodeName(d,b)?f.push(d):n.merge(f,vb(d,b));return void 0===b||b&&n.nodeName(a,b)?n.merge([a],f):f}function wb(a){X.test(a.type)&&(a.defaultChecked=a.checked)}function xb(a,b){return n.nodeName(a,"table")&&n.nodeName(11!==b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function yb(a){return a.type=(null!==n.find.attr(a,"type"))+"/"+a.type,a}function zb(a){var b=qb.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function Ab(a,b){for(var c,d=0;null!=(c=a[d]);d++)n._data(c,"globalEval",!b||n._data(b[d],"globalEval"))}function Bb(a,b){if(1===b.nodeType&&n.hasData(a)){var c,d,e,f=n._data(a),g=n._data(b,f),h=f.events;if(h)for(c in delete g.handle,g.events={},h)for(d=0,e=h[c].length;d<e;d++)n.event.add(b,c,h[c][d]);g.data&&(g.data=n.extend({},g.data))}}function Cb(a,b){var c,d,e;if(1===b.nodeType){if(c=b.nodeName.toLowerCase(),!l.noCloneEvent&&b[n.expando]){for(d in(e=n._data(b)).events)n.removeEvent(b,d,e.handle);b.removeAttribute(n.expando)}"script"===c&&b.text!==a.text?(yb(b).text=a.text,zb(b)):"object"===c?(b.parentNode&&(b.outerHTML=a.outerHTML),l.html5Clone&&a.innerHTML&&!n.trim(b.innerHTML)&&(b.innerHTML=a.innerHTML)):"input"===c&&X.test(a.type)?(b.defaultChecked=b.checked=a.checked,b.value!==a.value&&(b.value=a.value)):"option"===c?b.defaultSelected=b.selected=a.defaultSelected:"input"!==c&&"textarea"!==c||(b.defaultValue=a.defaultValue)}}sb.optgroup=sb.option,sb.tbody=sb.tfoot=sb.colgroup=sb.caption=sb.thead,sb.th=sb.td,n.extend({clone:function(a,b,c){var d,e,f,g,h,i=n.contains(a.ownerDocument,a);if(l.html5Clone||n.isXMLDoc(a)||!hb.test("<"+a.nodeName+">")?f=a.cloneNode(!0):(ub.innerHTML=a.outerHTML,ub.removeChild(f=ub.firstChild)),!(l.noCloneEvent&&l.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||n.isXMLDoc(a)))for(d=vb(f),h=vb(a),g=0;null!=(e=h[g]);++g)d[g]&&Cb(e,d[g]);if(b)if(c)for(h=h||vb(a),d=d||vb(f),g=0;null!=(e=h[g]);g++)Bb(e,d[g]);else Bb(a,f);return 0<(d=vb(f,"script")).length&&Ab(d,!i&&vb(a,"script")),d=h=e=null,f},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k,m=a.length,o=eb(b),p=[],q=0;q<m;q++)if((f=a[q])||0===f)if("object"===n.type(f))n.merge(p,f.nodeType?[f]:f);else if(mb.test(f)){for(h=h||o.appendChild(b.createElement("div")),i=(kb.exec(f)||["",""])[1].toLowerCase(),k=sb[i]||sb._default,h.innerHTML=k[1]+f.replace(jb,"<$1></$2>")+k[2],e=k[0];e--;)h=h.lastChild;if(!l.leadingWhitespace&&ib.test(f)&&p.push(b.createTextNode(ib.exec(f)[0])),!l.tbody)for(e=(f="table"!==i||lb.test(f)?"<table>"!==k[1]||lb.test(f)?0:h:h.firstChild)&&f.childNodes.length;e--;)n.nodeName(j=f.childNodes[e],"tbody")&&!j.childNodes.length&&f.removeChild(j);for(n.merge(p,h.childNodes),h.textContent="";h.firstChild;)h.removeChild(h.firstChild);h=o.lastChild}else p.push(b.createTextNode(f));for(h&&o.removeChild(h),l.appendChecked||n.grep(vb(p,"input"),wb),q=0;f=p[q++];)if((!d||-1===n.inArray(f,d))&&(g=n.contains(f.ownerDocument,f),h=vb(o.appendChild(f),"script"),g&&Ab(h),c))for(e=0;f=h[e++];)pb.test(f.type||"")&&c.push(f);return h=null,o},cleanData:function(a,b){for(var d,e,f,g,h=0,i=n.expando,j=n.cache,k=l.deleteExpando,m=n.event.special;null!=(d=a[h]);h++)if((b||n.acceptData(d))&&(g=(f=d[i])&&j[f])){if(g.events)for(e in g.events)m[e]?n.event.remove(d,e):n.removeEvent(d,e,g.handle);j[f]&&(delete j[f],k?delete d[i]:_typeof(d.removeAttribute)!==L?d.removeAttribute(i):d[i]=null,c.push(f))}}}),n.fn.extend({text:function(a){return W(this,function(a){return void 0===a?n.text(this):this.empty().append((this[0]&&this[0].ownerDocument||z).createTextNode(a))},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||xb(this,a).appendChild(a)})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=xb(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?n.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||n.cleanData(vb(c)),c.parentNode&&(b&&n.contains(c.ownerDocument,c)&&Ab(vb(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++){for(1===a.nodeType&&n.cleanData(vb(a,!1));a.firstChild;)a.removeChild(a.firstChild);a.options&&n.nodeName(a,"select")&&(a.options.length=0)}return this},clone:function(a,b){return a=null!=a&&a,b=null==b?a:b,this.map(function(){return n.clone(this,a,b)})},html:function(a){return W(this,function(a){var b=this[0]||{},c=0,d=this.length;if(void 0===a)return 1===b.nodeType?b.innerHTML.replace(gb,""):void 0;if(!("string"!=typeof a||nb.test(a)||!l.htmlSerialize&&hb.test(a)||!l.leadingWhitespace&&ib.test(a)||sb[(kb.exec(a)||["",""])[1].toLowerCase()])){a=a.replace(jb,"<$1></$2>");try{for(;c<d;c++)1===(b=this[c]||{}).nodeType&&(n.cleanData(vb(b,!1)),b.innerHTML=a);b=0}catch(e){}}b&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=arguments[0];return this.domManip(arguments,function(b){a=this.parentNode,n.cleanData(vb(this)),a&&a.replaceChild(b,this)}),a&&(a.length||a.nodeType)?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b){a=e.apply([],a);var c,d,f,g,h,i,j=0,k=this.length,m=this,o=k-1,p=a[0],q=n.isFunction(p);if(q||1<k&&"string"==typeof p&&!l.checkClone&&ob.test(p))return this.each(function(c){var d=m.eq(c);q&&(a[0]=p.call(this,c,d.html())),d.domManip(a,b)});if(k&&(c=(i=n.buildFragment(a,this[0].ownerDocument,!1,this)).firstChild,1===i.childNodes.length&&(i=c),c)){for(f=(g=n.map(vb(i,"script"),yb)).length;j<k;j++)d=i,j!==o&&(d=n.clone(d,!0,!0),f&&n.merge(g,vb(d,"script"))),b.call(this[j],d,j);if(f)for(h=g[g.length-1].ownerDocument,n.map(g,zb),j=0;j<f;j++)d=g[j],pb.test(d.type||"")&&!n._data(d,"globalEval")&&n.contains(h,d)&&(d.src?n._evalUrl&&n._evalUrl(d.src):n.globalEval((d.text||d.textContent||d.innerHTML||"").replace(rb,"")));i=c=null}return this}}),n.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){n.fn[a]=function(a){for(var c,d=0,e=[],g=n(a),h=g.length-1;d<=h;d++)c=d===h?this:this.clone(!0),n(g[d])[b](c),f.apply(e,c.get());return this.pushStack(e)}});var Db,Eb={};function Fb(b,c){var d=n(c.createElement(b)).appendTo(c.body),e=a.getDefaultComputedStyle?a.getDefaultComputedStyle(d[0]).display:n.css(d[0],"display");return d.detach(),e}function Gb(a){var b=z,c=Eb[a];return c||("none"!==(c=Fb(a,b))&&c||((b=((Db=(Db||n("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement))[0].contentWindow||Db[0].contentDocument).document).write(),b.close(),c=Fb(a,b),Db.detach()),Eb[a]=c),c}!function(){var a,b,c=z.createElement("div");c.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",(a=c.getElementsByTagName("a")[0]).style.cssText="float:left;opacity:.5",l.opacity=/^0.5/.test(a.style.opacity),l.cssFloat=!!a.style.cssFloat,c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",l.clearCloneStyle="content-box"===c.style.backgroundClip,a=c=null,l.shrinkWrapBlocks=function(){var a,c,e;if(null==b){if(!(a=z.getElementsByTagName("body")[0]))return;"border:0;width:0;height:0;position:absolute;top:0;left:-9999px",c=z.createElement("div"),e=z.createElement("div"),a.appendChild(c).appendChild(e),b=!1,_typeof(e.style.zoom)!==L&&(e.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0;width:1px;padding:1px;zoom:1",e.innerHTML="<div></div>",e.firstChild.style.width="5px",b=3!==e.offsetWidth),a.removeChild(c),a=c=e=null}return b}}();var Jb,Kb,Hb=/^margin/,Ib=new RegExp("^("+T+")(?!px)[a-z%]+$","i"),Lb=/^(top|right|bottom|left)$/;function Mb(a,b){return{get:function(){var c=a();if(null!=c)return c?void delete this.get:(this.get=b).apply(this,arguments)}}}a.getComputedStyle?(Jb=function(a){return a.ownerDocument.defaultView.getComputedStyle(a,null)},Kb=function(a,b,c){var d,e,f,g,h=a.style;return g=(c=c||Jb(a))?c.getPropertyValue(b)||c[b]:void 0,c&&(""!==g||n.contains(a.ownerDocument,a)||(g=n.style(a,b)),Ib.test(g)&&Hb.test(b)&&(d=h.width,e=h.minWidth,f=h.maxWidth,h.minWidth=h.maxWidth=h.width=g,g=c.width,h.width=d,h.minWidth=e,h.maxWidth=f)),void 0===g?g:g+""}):z.documentElement.currentStyle&&(Jb=function(a){return a.currentStyle},Kb=function(a,b,c){var d,e,f,g,h=a.style;return null==(g=(c=c||Jb(a))?c[b]:void 0)&&h&&h[b]&&(g=h[b]),Ib.test(g)&&!Lb.test(b)&&(d=h.left,(f=(e=a.runtimeStyle)&&e.left)&&(e.left=a.currentStyle.left),h.left="fontSize"===b?"1em":g,g=h.pixelLeft+"px",h.left=d,f&&(e.left=f)),void 0===g?g:g+""||"auto"}),function(){var b,c,d,e,f,g,h=z.createElement("div"),i="border:0;width:0;height:0;position:absolute;top:0;left:-9999px";function k(){var b,c,h=z.getElementsByTagName("body")[0];h&&(b=z.createElement("div"),c=z.createElement("div"),b.style.cssText=i,h.appendChild(b).appendChild(c),c.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;display:block;padding:1px;border:1px;width:4px;margin-top:1%;top:1%",n.swap(h,null!=h.style.zoom?{zoom:1}:{},function(){d=4===c.offsetWidth}),g=!(f=!(e=!0)),a.getComputedStyle&&(f="1%"!==(a.getComputedStyle(c,null)||{}).top,e="4px"===(a.getComputedStyle(c,null)||{width:"4px"}).width),h.removeChild(b),c=h=null)}h.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",(b=h.getElementsByTagName("a")[0]).style.cssText="float:left;opacity:.5",l.opacity=/^0.5/.test(b.style.opacity),l.cssFloat=!!b.style.cssFloat,h.style.backgroundClip="content-box",h.cloneNode(!0).style.backgroundClip="",l.clearCloneStyle="content-box"===h.style.backgroundClip,b=h=null,n.extend(l,{reliableHiddenOffsets:function(){if(null!=c)return c;var a,b,d,e=z.createElement("div"),f=z.getElementsByTagName("body")[0];return f?(e.setAttribute("className","t"),e.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",(a=z.createElement("div")).style.cssText=i,f.appendChild(a).appendChild(e),e.innerHTML="<table><tr><td></td><td>t</td></tr></table>",(b=e.getElementsByTagName("td"))[0].style.cssText="padding:0;margin:0;border:0;display:none",d=0===b[0].offsetHeight,b[0].style.display="",b[1].style.display="none",c=d&&0===b[0].offsetHeight,f.removeChild(a),e=f=null,c):void 0},boxSizing:function(){return null==d&&k(),d},boxSizingReliable:function(){return null==e&&k(),e},pixelPosition:function(){return null==f&&k(),f},reliableMarginRight:function(){var b,c,d,e;if(null==g&&a.getComputedStyle){if(!(b=z.getElementsByTagName("body")[0]))return;c=z.createElement("div"),d=z.createElement("div"),c.style.cssText=i,b.appendChild(c).appendChild(d),(e=d.appendChild(z.createElement("div"))).style.cssText=d.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0",e.style.marginRight=e.style.width="0",d.style.width="1px",g=!parseFloat((a.getComputedStyle(e,null)||{}).marginRight),b.removeChild(c)}return g}})}(),n.swap=function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];for(f in e=c.apply(a,d||[]),b)a.style[f]=g[f];return e};var Nb=/alpha\([^)]*\)/i,Ob=/opacity\s*=\s*([^)]*)/,Pb=/^(none|table(?!-c[ea]).+)/,Qb=new RegExp("^("+T+")(.*)$","i"),Rb=new RegExp("^([+-])=("+T+")","i"),Sb={position:"absolute",visibility:"hidden",display:"block"},Tb={letterSpacing:0,fontWeight:400},Ub=["Webkit","O","Moz","ms"];function Vb(a,b){if(b in a)return b;for(var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=Ub.length;e--;)if((b=Ub[e]+c)in a)return b;return d}function Wb(a,b){for(var c,d,e,f=[],g=0,h=a.length;g<h;g++)(d=a[g]).style&&(f[g]=n._data(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&V(d)&&(f[g]=n._data(d,"olddisplay",Gb(d.nodeName)))):f[g]||(e=V(d),(c&&"none"!==c||!e)&&n._data(d,"olddisplay",e?c:n.css(d,"display"))));for(g=0;g<h;g++)(d=a[g]).style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function Xb(a,b,c){var d=Qb.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function Yb(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;f<4;f+=2)"margin"===c&&(g+=n.css(a,c+U[f],!0,e)),d?("content"===c&&(g-=n.css(a,"padding"+U[f],!0,e)),"margin"!==c&&(g-=n.css(a,"border"+U[f]+"Width",!0,e))):(g+=n.css(a,"padding"+U[f],!0,e),"padding"!==c&&(g+=n.css(a,"border"+U[f]+"Width",!0,e)));return g}function Zb(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=Jb(a),g=l.boxSizing()&&"border-box"===n.css(a,"boxSizing",!1,f);if(e<=0||null==e){if(((e=Kb(a,b,f))<0||null==e)&&(e=a.style[b]),Ib.test(e))return e;d=g&&(l.boxSizingReliable()||e===a.style[b]),e=parseFloat(e)||0}return e+Yb(a,b,c||(g?"border":"content"),d,f)+"px"}function $b(a,b,c,d,e){return new $b.prototype.init(a,b,c,d,e)}n.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Kb(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:l.cssFloat?"cssFloat":"styleFloat"},style:function(a,b,c,d){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var e,f,g,h=n.camelCase(b),i=a.style;if(b=n.cssProps[h]||(n.cssProps[h]=Vb(i,h)),g=n.cssHooks[b]||n.cssHooks[h],void 0===c)return g&&"get"in g&&void 0!==(e=g.get(a,!1,d))?e:i[b];if("string"===(f=_typeof(c))&&(e=Rb.exec(c))&&(c=(e[1]+1)*e[2]+parseFloat(n.css(a,b)),f="number"),null!=c&&c==c&&("number"!==f||n.cssNumber[h]||(c+="px"),l.clearCloneStyle||""!==c||0!==b.indexOf("background")||(i[b]="inherit"),!(g&&"set"in g&&void 0===(c=g.set(a,c,d)))))try{i[b]="",i[b]=c}catch(j){}}},css:function(a,b,c,d){var e,f,g,h=n.camelCase(b);return b=n.cssProps[h]||(n.cssProps[h]=Vb(a.style,h)),(g=n.cssHooks[b]||n.cssHooks[h])&&"get"in g&&(f=g.get(a,!0,c)),void 0===f&&(f=Kb(a,b,d)),"normal"===f&&b in Tb&&(f=Tb[b]),""===c||c?(e=parseFloat(f),!0===c||n.isNumeric(e)?e||0:f):f}}),n.each(["height","width"],function(a,b){n.cssHooks[b]={get:function(a,c,d){return c?0===a.offsetWidth&&Pb.test(n.css(a,"display"))?n.swap(a,Sb,function(){return Zb(a,b,d)}):Zb(a,b,d):void 0},set:function(a,c,d){var e=d&&Jb(a);return Xb(0,c,d?Yb(a,b,d,l.boxSizing()&&"border-box"===n.css(a,"boxSizing",!1,e),e):0)}}}),l.opacity||(n.cssHooks.opacity={get:function(a,b){return Ob.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=n.isNumeric(b)?"alpha(opacity="+100*b+")":"",f=d&&d.filter||c.filter||"";((c.zoom=1)<=b||""===b)&&""===n.trim(f.replace(Nb,""))&&c.removeAttribute&&(c.removeAttribute("filter"),""===b||d&&!d.filter)||(c.filter=Nb.test(f)?f.replace(Nb,e):f+" "+e)}}),n.cssHooks.marginRight=Mb(l.reliableMarginRight,function(a,b){return b?n.swap(a,{display:"inline-block"},Kb,[a,"marginRight"]):void 0}),n.each({margin:"",padding:"",border:"Width"},function(a,b){n.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];d<4;d++)e[a+U[d]+b]=f[d]||f[d-2]||f[0];return e}},Hb.test(a)||(n.cssHooks[a+b].set=Xb)}),n.fn.extend({css:function(a,b){return W(this,function(a,b,c){var d,e,f={},g=0;if(n.isArray(b)){for(d=Jb(a),e=b.length;g<e;g++)f[b[g]]=n.css(a,b[g],!1,d);return f}return void 0!==c?n.style(a,b,c):n.css(a,b)},a,b,1<arguments.length)},show:function(){return Wb(this,!0)},hide:function(){return Wb(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){V(this)?n(this).show():n(this).hide()})}}),((n.Tween=$b).prototype={constructor:$b,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(n.cssNumber[c]?"":"px")},cur:function(){var a=$b.propHooks[this.prop];return a&&a.get?a.get(this):$b.propHooks._default.get(this)},run:function(a){var b,c=$b.propHooks[this.prop];return this.pos=b=this.options.duration?n.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):$b.propHooks._default.set(this),this}}).init.prototype=$b.prototype,($b.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=n.css(a.elem,a.prop,""))&&"auto"!==b?b:0:a.elem[a.prop]},set:function(a){n.fx.step[a.prop]?n.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[n.cssProps[a.prop]]||n.cssHooks[a.prop])?n.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}}).scrollTop=$b.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},n.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},n.fx=$b.prototype.init,n.fx.step={};var _b,ac,bc=/^(?:toggle|show|hide)$/,cc=new RegExp("^(?:([+-])=|)("+T+")([a-z%]*)$","i"),dc=/queueHooks$/,ec=[function(a,b,c){var d,e,f,g,h,i,j,k,m=this,o={},p=a.style,q=a.nodeType&&V(a),r=n._data(a,"fxshow");for(d in c.queue||(null==(h=n._queueHooks(a,"fx")).unqueued&&(h.unqueued=0,i=h.empty.fire,h.empty.fire=function(){h.unqueued||i()}),h.unqueued++,m.always(function(){m.always(function(){h.unqueued--,n.queue(a,"fx").length||h.empty.fire()})})),1===a.nodeType&&("height"in b||"width"in b)&&(c.overflow=[p.overflow,p.overflowX,p.overflowY],j=n.css(a,"display"),k=Gb(a.nodeName),"none"===j&&(j=k),"inline"===j&&"none"===n.css(a,"float")&&(l.inlineBlockNeedsLayout&&"inline"!==k?p.zoom=1:p.display="inline-block")),c.overflow&&(p.overflow="hidden",l.shrinkWrapBlocks()||m.always(function(){p.overflow=c.overflow[0],p.overflowX=c.overflow[1],p.overflowY=c.overflow[2]})),b)if(e=b[d],bc.exec(e)){if(delete b[d],f=f||"toggle"===e,e===(q?"hide":"show")){if("show"!==e||!r||void 0===r[d])continue;q=!0}o[d]=r&&r[d]||n.style(a,d)}if(!n.isEmptyObject(o))for(d in r?"hidden"in r&&(q=r.hidden):r=n._data(a,"fxshow",{}),f&&(r.hidden=!q),q?n(a).show():m.done(function(){n(a).hide()}),m.done(function(){var b;for(b in n._removeData(a,"fxshow"),o)n.style(a,b,o[b])}),o)g=ic(q?r[d]:0,d,m),d in r||(r[d]=g.start,q&&(g.end=g.start,g.start="width"===d||"height"===d?1:0))}],fc={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=cc.exec(b),f=e&&e[3]||(n.cssNumber[a]?"":"px"),g=(n.cssNumber[a]||"px"!==f&&+d)&&cc.exec(n.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f)for(f=f||g[3],e=e||[],g=+d||1;g/=h=h||".5",n.style(c.elem,a,g+f),h!==(h=c.cur()/d)&&1!==h&&--i;);return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};function gc(){return setTimeout(function(){_b=void 0}),_b=n.now()}function hc(a,b){var c,d={height:a},e=0;for(b=b?1:0;e<4;e+=2-b)d["margin"+(c=U[e])]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function ic(a,b,c){for(var d,e=(fc[b]||[]).concat(fc["*"]),f=0,g=e.length;f<g;f++)if(d=e[f].call(c,b,a))return d}function lc(a,b,c){var d,e,f=0,g=ec.length,h=n.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=_b||gc(),c=Math.max(0,j.startTime+j.duration-b),f=1-(c/j.duration||0),g=0,i=j.tweens.length;g<i;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),f<1&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:n.extend({},b),opts:n.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:_b||gc(),duration:c.duration,tweens:[],createTween:function(b,c){var d=n.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;c<d;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(function(a,b){var c,d,e,f,g;for(c in a)if(e=b[d=n.camelCase(c)],f=a[c],n.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),(g=n.cssHooks[d])&&"expand"in g)for(c in f=g.expand(f),delete a[d],f)c in a||(a[c]=f[c],b[c]=e);else b[d]=e}(k,j.opts.specialEasing);f<g;f++)if(d=ec[f].call(j,a,k,j.opts))return d;return n.map(k,ic,j),n.isFunction(j.opts.start)&&j.opts.start.call(a,j),n.fx.timer(n.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}n.Animation=n.extend(lc,{tweener:function(a,b){for(var c,d=0,e=(a=n.isFunction(a)?(b=a,["*"]):a.split(" ")).length;d<e;d++)c=a[d],fc[c]=fc[c]||[],fc[c].unshift(b)},prefilter:function(a,b){b?ec.unshift(a):ec.push(a)}}),n.speed=function(a,b,c){var d=a&&"object"==_typeof(a)?n.extend({},a):{complete:c||!c&&b||n.isFunction(a)&&a,duration:a,easing:c&&b||b&&!n.isFunction(b)&&b};return d.duration=n.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in n.fx.speeds?n.fx.speeds[d.duration]:n.fx.speeds._default,null!=d.queue&&!0!==d.queue||(d.queue="fx"),d.old=d.complete,d.complete=function(){n.isFunction(d.old)&&d.old.call(this),d.queue&&n.dequeue(this,d.queue)},d},n.fn.extend({fadeTo:function(a,b,c,d){return this.filter(V).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=n.isEmptyObject(a),f=n.speed(b,c,d),g=function(){var b=lc(this,n.extend({},a),f);(e||n._data(this,"finish"))&&b.stop(!0)};return g.finish=g,e||!1===f.queue?this.each(g):this.queue(f.queue,g)},stop:function(a,b,c){var d=function(a){var b=a.stop;delete a.stop,b(c)};return"string"!=typeof a&&(c=b,b=a,a=void 0),b&&!1!==a&&this.queue(a||"fx",[]),this.each(function(){var b=!0,e=null!=a&&a+"queueHooks",f=n.timers,g=n._data(this);if(e)g[e]&&g[e].stop&&d(g[e]);else for(e in g)g[e]&&g[e].stop&&dc.test(e)&&d(g[e]);for(e=f.length;e--;)f[e].elem!==this||null!=a&&f[e].queue!==a||(f[e].anim.stop(c),b=!1,f.splice(e,1));!b&&c||n.dequeue(this,a)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var b,c=n._data(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=n.timers,g=d?d.length:0;for(c.finish=!0,n.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;b<g;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),n.each(["toggle","show","hide"],function(a,b){var c=n.fn[b];n.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(hc(b,!0),a,d,e)}}),n.each({slideDown:hc("show"),slideUp:hc("hide"),slideToggle:hc("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){n.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),n.timers=[],n.fx.tick=function(){var a,b=n.timers,c=0;for(_b=n.now();c<b.length;c++)(a=b[c])()||b[c]!==a||b.splice(c--,1);b.length||n.fx.stop(),_b=void 0},n.fx.timer=function(a){n.timers.push(a),a()?n.fx.start():n.timers.pop()},n.fx.interval=13,n.fx.start=function(){ac||(ac=setInterval(n.fx.tick,n.fx.interval))},n.fx.stop=function(){clearInterval(ac),ac=null},n.fx.speeds={slow:600,fast:200,_default:400},n.fn.delay=function(a,b){return a=n.fx&&n.fx.speeds[a]||a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},function(){var a,b,c,d,e=z.createElement("div");e.setAttribute("className","t"),e.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",a=e.getElementsByTagName("a")[0],d=(c=z.createElement("select")).appendChild(z.createElement("option")),b=e.getElementsByTagName("input")[0],a.style.cssText="top:1px",l.getSetAttribute="t"!==e.className,l.style=/top/.test(a.getAttribute("style")),l.hrefNormalized="/a"===a.getAttribute("href"),l.checkOn=!!b.value,l.optSelected=d.selected,l.enctype=!!z.createElement("form").enctype,c.disabled=!0,l.optDisabled=!d.disabled,(b=z.createElement("input")).setAttribute("value",""),l.input=""===b.getAttribute("value"),b.value="t",b.setAttribute("type","radio"),l.radioValue="t"===b.value,a=b=c=d=e=null}();var mc=/\r/g;n.fn.extend({val:function(a){var b,c,d,e=this[0];return arguments.length?(d=n.isFunction(a),this.each(function(c){var e;1===this.nodeType&&(null==(e=d?a.call(this,c,n(this).val()):a)?e="":"number"==typeof e?e+="":n.isArray(e)&&(e=n.map(e,function(a){return null==a?"":a+""})),(b=n.valHooks[this.type]||n.valHooks[this.nodeName.toLowerCase()])&&"set"in b&&void 0!==b.set(this,e,"value")||(this.value=e))})):e?(b=n.valHooks[e.type]||n.valHooks[e.nodeName.toLowerCase()])&&"get"in b&&void 0!==(c=b.get(e,"value"))?c:"string"==typeof(c=e.value)?c.replace(mc,""):null==c?"":c:void 0}}),n.extend({valHooks:{option:{get:function(a){var b=n.find.attr(a,"value");return null!=b?b:n.text(a)}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||e<0,g=f?null:[],h=f?e+1:d.length,i=e<0?h:f?e:0;i<h;i++)if(!(!(c=d[i]).selected&&i!==e||(l.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&n.nodeName(c.parentNode,"optgroup"))){if(b=n(c).val(),f)return b;g.push(b)}return g},set:function(a,b){for(var c,d,e=a.options,f=n.makeArray(b),g=e.length;g--;)if(d=e[g],0<=n.inArray(n.valHooks.option.get(d),f))try{d.selected=c=!0}catch(h){d.scrollHeight}else d.selected=!1;return c||(a.selectedIndex=-1),e}}}}),n.each(["radio","checkbox"],function(){n.valHooks[this]={set:function(a,b){return n.isArray(b)?a.checked=0<=n.inArray(n(a).val(),b):void 0}},l.checkOn||(n.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var nc,oc,pc=n.expr.attrHandle,qc=/^(?:checked|selected)$/i,rc=l.getSetAttribute,sc=l.input;n.fn.extend({attr:function(a,b){return W(this,n.attr,a,b,1<arguments.length)},removeAttr:function(a){return this.each(function(){n.removeAttr(this,a)})}}),n.extend({attr:function(a,b,c){var d,e,f=a.nodeType;if(a&&3!==f&&8!==f&&2!==f)return _typeof(a.getAttribute)===L?n.prop(a,b,c):(1===f&&n.isXMLDoc(a)||(b=b.toLowerCase(),d=n.attrHooks[b]||(n.expr.match.bool.test(b)?oc:nc)),void 0===c?d&&"get"in d&&null!==(e=d.get(a,b))?e:null==(e=n.find.attr(a,b))?void 0:e:null!==c?d&&"set"in d&&void 0!==(e=d.set(a,c,b))?e:(a.setAttribute(b,c+""),c):void n.removeAttr(a,b))},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(F);if(f&&1===a.nodeType)for(;c=f[e++];)d=n.propFix[c]||c,n.expr.match.bool.test(c)?sc&&rc||!qc.test(c)?a[d]=!1:a[n.camelCase("default-"+c)]=a[d]=!1:n.attr(a,c,""),a.removeAttribute(rc?c:d)},attrHooks:{type:{set:function(a,b){if(!l.radioValue&&"radio"===b&&n.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}}}),oc={set:function(a,b,c){return!1===b?n.removeAttr(a,c):sc&&rc||!qc.test(c)?a.setAttribute(!rc&&n.propFix[c]||c,c):a[n.camelCase("default-"+c)]=a[c]=!0,c}},n.each(n.expr.match.bool.source.match(/\w+/g),function(a,b){var c=pc[b]||n.find.attr;pc[b]=sc&&rc||!qc.test(b)?function(a,b,d){var e,f;return d||(f=pc[b],pc[b]=e,e=null!=c(a,b,d)?b.toLowerCase():null,pc[b]=f),e}:function(a,b,c){return c?void 0:a[n.camelCase("default-"+b)]?b.toLowerCase():null}}),sc&&rc||(n.attrHooks.value={set:function(a,b,c){return n.nodeName(a,"input")?void(a.defaultValue=b):nc&&nc.set(a,b,c)}}),rc||(nc={set:function(a,b,c){var d=a.getAttributeNode(c);return d||a.setAttributeNode(d=a.ownerDocument.createAttribute(c)),d.value=b+="","value"===c||b===a.getAttribute(c)?b:void 0}},pc.id=pc.name=pc.coords=function(a,b,c){var d;return c?void 0:(d=a.getAttributeNode(b))&&""!==d.value?d.value:null},n.valHooks.button={get:function(a,b){var c=a.getAttributeNode(b);return c&&c.specified?c.value:void 0},set:nc.set},n.attrHooks.contenteditable={set:function(a,b,c){nc.set(a,""!==b&&b,c)}},n.each(["width","height"],function(a,b){n.attrHooks[b]={set:function(a,c){return""===c?(a.setAttribute(b,"auto"),c):void 0}}})),l.style||(n.attrHooks.style={get:function(a){return a.style.cssText||void 0},set:function(a,b){return a.style.cssText=b+""}});var tc=/^(?:input|select|textarea|button|object)$/i,uc=/^(?:a|area)$/i;n.fn.extend({prop:function(a,b){return W(this,n.prop,a,b,1<arguments.length)},removeProp:function(a){return a=n.propFix[a]||a,this.each(function(){try{this[a]=void 0,delete this[a]}catch(b){}})}}),n.extend({propFix:{for:"htmlFor",class:"className"},prop:function(a,b,c){var d,e,g=a.nodeType;if(a&&3!==g&&8!==g&&2!==g)return(1!==g||!n.isXMLDoc(a))&&(b=n.propFix[b]||b,e=n.propHooks[b]),void 0!==c?e&&"set"in e&&void 0!==(d=e.set(a,c,b))?d:a[b]=c:e&&"get"in e&&null!==(d=e.get(a,b))?d:a[b]},propHooks:{tabIndex:{get:function(a){var b=n.find.attr(a,"tabindex");return b?parseInt(b,10):tc.test(a.nodeName)||uc.test(a.nodeName)&&a.href?0:-1}}}}),l.hrefNormalized||n.each(["href","src"],function(a,b){n.propHooks[b]={get:function(a){return a.getAttribute(b,4)}}}),l.optSelected||(n.propHooks.selected={get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}}),n.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){n.propFix[this.toLowerCase()]=this}),l.enctype||(n.propFix.enctype="encoding");var vc=/[\t\r\n\f]/g;n.fn.extend({addClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j="string"==typeof a&&a;if(n.isFunction(a))return this.each(function(b){n(this).addClass(a.call(this,b,this.className))});if(j)for(b=(a||"").match(F)||[];h<i;h++)if(d=1===(c=this[h]).nodeType&&(c.className?(" "+c.className+" ").replace(vc," "):" ")){for(f=0;e=b[f++];)d.indexOf(" "+e+" ")<0&&(d+=e+" ");g=n.trim(d),c.className!==g&&(c.className=g)}return this},removeClass:function(a){var b,c,d,e,f,g,h=0,i=this.length,j=0===arguments.length||"string"==typeof a&&a;if(n.isFunction(a))return this.each(function(b){n(this).removeClass(a.call(this,b,this.className))});if(j)for(b=(a||"").match(F)||[];h<i;h++)if(d=1===(c=this[h]).nodeType&&(c.className?(" "+c.className+" ").replace(vc," "):"")){for(f=0;e=b[f++];)for(;0<=d.indexOf(" "+e+" ");)d=d.replace(" "+e+" "," ");g=a?n.trim(d):"",c.className!==g&&(c.className=g)}return this},toggleClass:function(a,b){var c=_typeof(a);return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):this.each(n.isFunction(a)?function(c){n(this).toggleClass(a.call(this,c,this.className,b),b)}:function(){if("string"===c)for(var b,d=0,e=n(this),f=a.match(F)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else c!==L&&"boolean"!==c||(this.className&&n._data(this,"__className__",this.className),this.className=this.className||!1===a?"":n._data(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;c<d;c++)if(1===this[c].nodeType&&0<=(" "+this[c].className+" ").replace(vc," ").indexOf(b))return!0;return!1}}),n.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){n.fn[b]=function(a,c){return 0<arguments.length?this.on(b,null,a,c):this.trigger(b)}}),n.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var wc=n.now(),xc=/\?/,yc=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;n.parseJSON=function(b){if(a.JSON&&a.JSON.parse)return a.JSON.parse(b+"");var c,d=null,e=n.trim(b+"");return e&&!n.trim(e.replace(yc,function(a,b,e,f){return c&&b&&(d=0),0===d?a:(c=e||b,d+=!f-!e,"")}))?Function("return "+e)():n.error("Invalid JSON: "+b)},n.parseXML=function(b){var c;if(!b||"string"!=typeof b)return null;try{a.DOMParser?c=(new DOMParser).parseFromString(b,"text/xml"):((c=new ActiveXObject("Microsoft.XMLDOM")).async="false",c.loadXML(b))}catch(e){c=void 0}return c&&c.documentElement&&!c.getElementsByTagName("parsererror").length||n.error("Invalid XML: "+b),c};var zc,Ac,Bc=/#.*$/,Cc=/([?&])_=[^&]*/,Dc=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Fc=/^(?:GET|HEAD)$/,Gc=/^\/\//,Hc=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Ic={},Jc={},Kc="*/".concat("*");try{Ac=location.href}catch(Lc){(Ac=z.createElement("a")).href="",Ac=Ac.href}function Mc(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(F)||[];if(n.isFunction(c))for(;d=f[e++];)"+"===d.charAt(0)?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function Nc(a,b,c,d){var e={},f=a===Jc;function g(h){var i;return e[h]=!0,n.each(a[h]||[],function(a,h){var j=h(b,c,d);return"string"!=typeof j||f||e[j]?f?!(i=j):void 0:(b.dataTypes.unshift(j),g(j),!1)}),i}return g(b.dataTypes[0])||!e["*"]&&g("*")}function Oc(a,b){var c,d,e=n.ajaxSettings.flatOptions||{};for(d in b)void 0!==b[d]&&((e[d]?a:c||(c={}))[d]=b[d]);return c&&n.extend(!0,a,c),a}zc=Hc.exec(Ac.toLowerCase())||[],n.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ac,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(zc[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Kc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":n.parseJSON,"text xml":n.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?Oc(Oc(a,n.ajaxSettings),b):Oc(n.ajaxSettings,a)},ajaxPrefilter:Mc(Ic),ajaxTransport:Mc(Jc),ajax:function(a,b){"object"==_typeof(a)&&(b=a,a=void 0),b=b||{};var c,d,e,f,g,h,i,j,k=n.ajaxSetup({},b),l=k.context||k,m=k.context&&(l.nodeType||l.jquery)?n(l):n.event,o=n.Deferred(),p=n.Callbacks("once memory"),q=k.statusCode||{},r={},s={},t=0,u="canceled",v={readyState:0,getResponseHeader:function(a){var b;if(2===t){if(!j)for(j={};b=Dc.exec(f);)j[b[1].toLowerCase()]=b[2];b=j[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===t?f:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return t||(a=s[c]=s[c]||a,r[a]=b),this},overrideMimeType:function(a){return t||(k.mimeType=a),this},statusCode:function(a){var b;if(a)if(t<2)for(b in a)q[b]=[q[b],a[b]];else v.always(a[v.status]);return this},abort:function(a){var b=a||u;return i&&i.abort(b),x(0,b),this}};if(o.promise(v).complete=p.add,v.success=v.done,v.error=v.fail,k.url=((a||k.url||Ac)+"").replace(Bc,"").replace(Gc,zc[1]+"//"),k.type=b.method||b.type||k.method||k.type,k.dataTypes=n.trim(k.dataType||"*").toLowerCase().match(F)||[""],null==k.crossDomain&&(c=Hc.exec(k.url.toLowerCase()),k.crossDomain=!(!c||c[1]===zc[1]&&c[2]===zc[2]&&(c[3]||("http:"===c[1]?"80":"443"))===(zc[3]||("http:"===zc[1]?"80":"443")))),k.data&&k.processData&&"string"!=typeof k.data&&(k.data=n.param(k.data,k.traditional)),Nc(Ic,k,b,v),2===t)return v;for(d in(h=k.global)&&0==n.active++&&n.event.trigger("ajaxStart"),k.type=k.type.toUpperCase(),k.hasContent=!Fc.test(k.type),e=k.url,k.hasContent||(k.data&&(e=k.url+=(xc.test(e)?"&":"?")+k.data,delete k.data),!1===k.cache&&(k.url=Cc.test(e)?e.replace(Cc,"$1_="+wc++):e+(xc.test(e)?"&":"?")+"_="+wc++)),k.ifModified&&(n.lastModified[e]&&v.setRequestHeader("If-Modified-Since",n.lastModified[e]),n.etag[e]&&v.setRequestHeader("If-None-Match",n.etag[e])),(k.data&&k.hasContent&&!1!==k.contentType||b.contentType)&&v.setRequestHeader("Content-Type",k.contentType),v.setRequestHeader("Accept",k.dataTypes[0]&&k.accepts[k.dataTypes[0]]?k.accepts[k.dataTypes[0]]+("*"!==k.dataTypes[0]?", "+Kc+"; q=0.01":""):k.accepts["*"]),k.headers)v.setRequestHeader(d,k.headers[d]);if(k.beforeSend&&(!1===k.beforeSend.call(l,v,k)||2===t))return v.abort();for(d in u="abort",{success:1,error:1,complete:1})v[d](k[d]);if(i=Nc(Jc,k,b,v)){v.readyState=1,h&&m.trigger("ajaxSend",[v,k]),k.async&&0<k.timeout&&(g=setTimeout(function(){v.abort("timeout")},k.timeout));try{t=1,i.send(r,x)}catch(w){if(!(t<2))throw w;x(-1,w)}}else x(-1,"No Transport");function x(a,b,c,d){var j,r,s,u,w,x=b;2!==t&&(t=2,g&&clearTimeout(g),i=void 0,f=d||"",v.readyState=0<a?4:0,j=200<=a&&a<300||304===a,c&&(u=function(a,b,c){for(var d,e,f,g,h=a.contents,i=a.dataTypes;"*"===i[0];)i.shift(),void 0===e&&(e=a.mimeType||b.getResponseHeader("Content-Type"));if(e)for(g in h)if(h[g]&&h[g].test(e)){i.unshift(g);break}if(i[0]in c)f=i[0];else{for(g in c){if(!i[0]||a.converters[g+" "+i[0]]){f=g;break}d||(d=g)}f=f||d}return f?(f!==i[0]&&i.unshift(f),c[f]):void 0}(k,v,c)),u=function(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];for(f=k.shift();f;)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(!(g=j[i+" "+f]||j["* "+f]))for(e in j)if((h=e.split(" "))[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){!0===g?g=j[e]:!0!==j[e]&&(f=h[0],k.unshift(h[1]));break}if(!0!==g)if(g&&a.throws)b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}(k,u,v,j),j?(k.ifModified&&((w=v.getResponseHeader("Last-Modified"))&&(n.lastModified[e]=w),(w=v.getResponseHeader("etag"))&&(n.etag[e]=w)),204===a||"HEAD"===k.type?x="nocontent":304===a?x="notmodified":(x=u.state,r=u.data,j=!(s=u.error))):(s=x,!a&&x||(x="error",a<0&&(a=0))),v.status=a,v.statusText=(b||x)+"",j?o.resolveWith(l,[r,x,v]):o.rejectWith(l,[v,x,s]),v.statusCode(q),q=void 0,h&&m.trigger(j?"ajaxSuccess":"ajaxError",[v,k,j?r:s]),p.fireWith(l,[v,x]),h&&(m.trigger("ajaxComplete",[v,k]),--n.active||n.event.trigger("ajaxStop")))}return v},getJSON:function(a,b,c){return n.get(a,b,c,"json")},getScript:function(a,b){return n.get(a,void 0,b,"script")}}),n.each(["get","post"],function(a,b){n[b]=function(a,c,d,e){return n.isFunction(c)&&(e=e||d,d=c,c=void 0),n.ajax({url:a,type:b,dataType:e,data:c,success:d})}}),n.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){n.fn[b]=function(a){return this.on(b,a)}}),n._evalUrl=function(a){return n.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},n.fn.extend({wrapAll:function(a){if(n.isFunction(a))return this.each(function(b){n(this).wrapAll(a.call(this,b))});if(this[0]){var b=n(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstChild&&1===a.firstChild.nodeType;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return this.each(n.isFunction(a)?function(b){n(this).wrapInner(a.call(this,b))}:function(){var b=n(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=n.isFunction(a);return this.each(function(c){n(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){n.nodeName(this,"body")||n(this).replaceWith(this.childNodes)}).end()}}),n.expr.filters.hidden=function(a){return a.offsetWidth<=0&&a.offsetHeight<=0||!l.reliableHiddenOffsets()&&"none"===(a.style&&a.style.display||n.css(a,"display"))},n.expr.filters.visible=function(a){return!n.expr.filters.hidden(a)};var Rc=/%20/g,Sc=/\[\]$/,Tc=/\r?\n/g,Uc=/^(?:submit|button|image|reset|file)$/i,Vc=/^(?:input|select|textarea|keygen)/i;function Wc(a,b,c,d){var e;if(n.isArray(b))n.each(b,function(b,e){c||Sc.test(a)?d(a,e):Wc(a+"["+("object"==_typeof(e)?b:"")+"]",e,c,d)});else if(c||"object"!==n.type(b))d(a,b);else for(e in b)Wc(a+"["+e+"]",b[e],c,d)}n.param=function(a,b){var c,d=[],e=function(a,b){b=n.isFunction(b)?b():null==b?"":b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(void 0===b&&(b=n.ajaxSettings&&n.ajaxSettings.traditional),n.isArray(a)||a.jquery&&!n.isPlainObject(a))n.each(a,function(){e(this.name,this.value)});else for(c in a)Wc(c,a[c],b,e);return d.join("&").replace(Rc,"+")},n.fn.extend({serialize:function(){return n.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=n.prop(this,"elements");return a?n.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!n(this).is(":disabled")&&Vc.test(this.nodeName)&&!Uc.test(a)&&(this.checked||!X.test(a))}).map(function(a,b){var c=n(this).val();return null==c?null:n.isArray(c)?n.map(c,function(a){return{name:b.name,value:a.replace(Tc,"\r\n")}}):{name:b.name,value:c.replace(Tc,"\r\n")}}).get()}}),n.ajaxSettings.xhr=void 0!==a.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&$c()||function(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}()}:$c;var Xc=0,Yc={},Zc=n.ajaxSettings.xhr();function $c(){try{return new a.XMLHttpRequest}catch(b){}}a.ActiveXObject&&n(a).on("unload",function(){for(var a in Yc)Yc[a](void 0,!0)}),l.cors=!!Zc&&"withCredentials"in Zc,(Zc=l.ajax=!!Zc)&&n.ajaxTransport(function(a){var _b3;if(!a.crossDomain||l.cors)return{send:function(c,d){var e,f=a.xhr(),g=++Xc;if(f.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(e in a.xhrFields)f[e]=a.xhrFields[e];for(e in a.mimeType&&f.overrideMimeType&&f.overrideMimeType(a.mimeType),a.crossDomain||c["X-Requested-With"]||(c["X-Requested-With"]="XMLHttpRequest"),c)void 0!==c[e]&&f.setRequestHeader(e,c[e]+"");f.send(a.hasContent&&a.data||null),_b3=function(c,e){var h,i,j;if(_b3&&(e||4===f.readyState))if(delete Yc[g],_b3=void 0,f.onreadystatechange=n.noop,e)4!==f.readyState&&f.abort();else{j={},h=f.status,"string"==typeof f.responseText&&(j.text=f.responseText);try{i=f.statusText}catch(k){i=""}h||!a.isLocal||a.crossDomain?1223===h&&(h=204):h=j.text?200:404}j&&d(h,i,j,f.getAllResponseHeaders())},a.async?4===f.readyState?setTimeout(_b3):f.onreadystatechange=Yc[g]=_b3:_b3()},abort:function(){_b3&&_b3(void 0,!0)}}}),n.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return n.globalEval(a),a}}}),n.ajaxPrefilter("script",function(a){void 0===a.cache&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),n.ajaxTransport("script",function(a){if(a.crossDomain){var b,c=z.head||n("head")[0]||z.documentElement;return{send:function(d,e){(b=z.createElement("script")).async=!0,a.scriptCharset&&(b.charset=a.scriptCharset),b.src=a.url,b.onload=b.onreadystatechange=function(a,c){!c&&b.readyState&&!/loaded|complete/.test(b.readyState)||(b.onload=b.onreadystatechange=null,b.parentNode&&b.parentNode.removeChild(b),b=null,c||e(200,"success"))},c.insertBefore(b,c.firstChild)},abort:function(){b&&b.onload(void 0,!0)}}}});var ad=[],bd=/(=)\?(?=&|$)|\?\?/;n.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=ad.pop()||n.expando+"_"+wc++;return this[a]=!0,a}}),n.ajaxPrefilter("json jsonp",function(b,c,d){var e,f,g,h=!1!==b.jsonp&&(bd.test(b.url)?"url":"string"==typeof b.data&&!(b.contentType||"").indexOf("application/x-www-form-urlencoded")&&bd.test(b.data)&&"data");return h||"jsonp"===b.dataTypes[0]?(e=b.jsonpCallback=n.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h?b[h]=b[h].replace(bd,"$1"+e):!1!==b.jsonp&&(b.url+=(xc.test(b.url)?"&":"?")+b.jsonp+"="+e),b.converters["script json"]=function(){return g||n.error(e+" was not called"),g[0]},b.dataTypes[0]="json",f=a[e],a[e]=function(){g=arguments},d.always(function(){a[e]=f,b[e]&&(b.jsonpCallback=c.jsonpCallback,ad.push(e)),g&&n.isFunction(f)&&f(g[0]),g=f=void 0}),"script"):void 0}),n.parseHTML=function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||z;var d=v.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=n.buildFragment([a],b,e),e&&e.length&&n(e).remove(),n.merge([],d.childNodes))};var cd=n.fn.load;n.fn.load=function(a,b,c){if("string"!=typeof a&&cd)return cd.apply(this,arguments);var d,e,f,g=this,h=a.indexOf(" ");return 0<=h&&(d=a.slice(h,a.length),a=a.slice(0,h)),n.isFunction(b)?(c=b,b=void 0):b&&"object"==_typeof(b)&&(f="POST"),0<g.length&&n.ajax({url:a,type:f,dataType:"html",data:b}).done(function(a){e=arguments,g.html(d?n("<div>").append(n.parseHTML(a)).find(d):a)}).complete(c&&function(a,b){g.each(c,e||[a.responseText,b,a])}),this},n.expr.filters.animated=function(a){return n.grep(n.timers,function(b){return a===b.elem}).length};var dd=a.document.documentElement;function ed(a){return n.isWindow(a)?a:9===a.nodeType&&(a.defaultView||a.parentWindow)}n.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,k=n.css(a,"position"),l=n(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=n.css(a,"top"),i=n.css(a,"left"),e=("absolute"===k||"fixed"===k)&&-1<n.inArray("auto",[f,i])?(g=(d=l.position()).top,d.left):(g=parseFloat(f)||0,parseFloat(i)||0),n.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},n.fn.extend({offset:function(a){if(arguments.length)return void 0===a?this:this.each(function(b){n.offset.setOffset(this,a,b)});var b,c,d={top:0,left:0},e=this[0],f=e&&e.ownerDocument;return f?(b=f.documentElement,n.contains(b,e)?(_typeof(e.getBoundingClientRect)!==L&&(d=e.getBoundingClientRect()),c=ed(f),{top:d.top+(c.pageYOffset||b.scrollTop)-(b.clientTop||0),left:d.left+(c.pageXOffset||b.scrollLeft)-(b.clientLeft||0)}):d):void 0},position:function(){if(this[0]){var a,b,c={top:0,left:0},d=this[0];return"fixed"===n.css(d,"position")?b=d.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),n.nodeName(a[0],"html")||(c=a.offset()),c.top+=n.css(a[0],"borderTopWidth",!0),c.left+=n.css(a[0],"borderLeftWidth",!0)),{top:b.top-c.top-n.css(d,"marginTop",!0),left:b.left-c.left-n.css(d,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||dd;a&&!n.nodeName(a,"html")&&"static"===n.css(a,"position");)a=a.offsetParent;return a||dd})}}),n.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,b){var c=/Y/.test(b);n.fn[a]=function(d){return W(this,function(a,d,e){var f=ed(a);return void 0===e?f?b in f?f[b]:f.document.documentElement[d]:a[d]:void(f?f.scrollTo(c?n(f).scrollLeft():e,c?e:n(f).scrollTop()):a[d]=e)},a,d,arguments.length,null)}}),n.each(["top","left"],function(a,b){n.cssHooks[b]=Mb(l.pixelPosition,function(a,c){return c?(c=Kb(a,b),Ib.test(c)?n(a).position()[b]+"px":c):void 0})}),n.each({Height:"height",Width:"width"},function(a,b){n.each({padding:"inner"+a,content:b,"":"outer"+a},function(c,d){n.fn[d]=function(d,e){var f=arguments.length&&(c||"boolean"!=typeof d),g=c||(!0===d||!0===e?"margin":"border");return W(this,function(b,c,d){var e;return n.isWindow(b)?b.document.documentElement["client"+a]:9===b.nodeType?(e=b.documentElement,Math.max(b.body["scroll"+a],e["scroll"+a],b.body["offset"+a],e["offset"+a],e["client"+a])):void 0===d?n.css(b,c,g):n.style(b,c,d,g)},b,f?d:void 0,f,null)}})}),n.fn.size=function(){return this.length},n.fn.andSelf=n.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return n});var fd=a.jQuery,gd=a.$;return n.noConflict=function(b){return a.$===n&&(a.$=gd),b&&a.jQuery===n&&(a.jQuery=fd),n},_typeof(b)===L&&(a.jQuery=a.$=n),n}),function(jQuery,undefined){var colors,rplusequals=/^([\-+])=\s*(\d+\.?\d*)/,stringParsers=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(execResult){return[execResult[1],execResult[2],execResult[3],execResult[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(execResult){return[2.55*execResult[1],2.55*execResult[2],2.55*execResult[3],execResult[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(execResult){return[parseInt(execResult[1],16),parseInt(execResult[2],16),parseInt(execResult[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(execResult){return[parseInt(execResult[1]+execResult[1],16),parseInt(execResult[2]+execResult[2],16),parseInt(execResult[3]+execResult[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(execResult){return[execResult[1],execResult[2]/100,execResult[3]/100,execResult[4]]}}],color=jQuery.Color=function(color,green,blue,alpha){return new jQuery.Color.fn.parse(color,green,blue,alpha)},spaces={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},propTypes={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},support=color.support={},supportElem=jQuery("<p>")[0],each=jQuery.each;function clamp(value,prop,allowEmpty){var type=propTypes[prop.type]||{};return null==value?allowEmpty||!prop.def?null:prop.def:(value=type.floor?~~value:parseFloat(value),isNaN(value)?prop.def:type.mod?(value+type.mod)%type.mod:value<0?0:type.max<value?type.max:value)}function stringParse(string){var inst=color(),rgba=inst._rgba=[];return string=string.toLowerCase(),each(stringParsers,function(i,parser){var parsed,match=parser.re.exec(string),values=match&&parser.parse(match),spaceName=parser.space||"rgba";if(values)return parsed=inst[spaceName](values),inst[spaces[spaceName].cache]=parsed[spaces[spaceName].cache],rgba=inst._rgba=parsed._rgba,!1}),rgba.length?("0,0,0,0"===rgba.join()&&jQuery.extend(rgba,colors.transparent),inst):colors[string]}function hue2rgb(p,q,h){return 6*(h=(h+1)%1)<1?p+(q-p)*h*6:2*h<1?q:3*h<2?p+(q-p)*(2/3-h)*6:p}supportElem.style.cssText="background-color:rgba(1,1,1,.5)",support.rgba=-1<supportElem.style.backgroundColor.indexOf("rgba"),each(spaces,function(spaceName,space){space.cache="_"+spaceName,space.props.alpha={idx:3,type:"percent",def:1}}),color.fn=jQuery.extend(color.prototype,{parse:function(red,green,blue,alpha){if(void 0===red)return this._rgba=[null,null,null,null],this;(red.jquery||red.nodeType)&&(red=jQuery(red).css(green),green=void 0);var inst=this,type=jQuery.type(red),rgba=this._rgba=[];return void 0!==green&&(red=[red,green,blue,alpha],type="array"),"string"===type?this.parse(stringParse(red)||colors._default):"array"===type?(each(spaces.rgba.props,function(key,prop){rgba[prop.idx]=clamp(red[prop.idx],prop)}),this):"object"===type?(each(spaces,red instanceof color?function(spaceName,space){red[space.cache]&&(inst[space.cache]=red[space.cache].slice())}:function(spaceName,space){var cache=space.cache;each(space.props,function(key,prop){if(!inst[cache]&&space.to){if("alpha"===key||null==red[key])return;inst[cache]=space.to(inst._rgba)}inst[cache][prop.idx]=clamp(red[key],prop,!0)}),inst[cache]&&jQuery.inArray(null,inst[cache].slice(0,3))<0&&(inst[cache][3]=1,space.from&&(inst._rgba=space.from(inst[cache])))}),this):void 0},is:function(compare){var is=color(compare),same=!0,inst=this;return each(spaces,function(_,space){var localCache,isCache=is[space.cache];return isCache&&(localCache=inst[space.cache]||space.to&&space.to(inst._rgba)||[],each(space.props,function(_,prop){if(null!=isCache[prop.idx])return same=isCache[prop.idx]===localCache[prop.idx]})),same}),same},_space:function(){var used=[],inst=this;return each(spaces,function(spaceName,space){inst[space.cache]&&used.push(spaceName)}),used.pop()},transition:function(other,distance){var end=color(other),spaceName=end._space(),space=spaces[spaceName],startColor=0===this.alpha()?color("transparent"):this,start=startColor[space.cache]||space.to(startColor._rgba),result=start.slice();return end=end[space.cache],each(space.props,function(key,prop){var index=prop.idx,startValue=start[index],endValue=end[index],type=propTypes[prop.type]||{};null!==endValue&&(null===startValue?result[index]=endValue:(type.mod&&(endValue-startValue>type.mod/2?startValue+=type.mod:startValue-endValue>type.mod/2&&(startValue-=type.mod)),result[index]=clamp((endValue-startValue)*distance+startValue,prop)))}),this[spaceName](result)},blend:function(opaque){if(1===this._rgba[3])return this;var rgb=this._rgba.slice(),a=rgb.pop(),blend=color(opaque)._rgba;return color(jQuery.map(rgb,function(v,i){return(1-a)*blend[i]+a*v}))},toRgbaString:function(){var prefix="rgba(",rgba=jQuery.map(this._rgba,function(v,i){return null==v?2<i?1:0:v});return 1===rgba[3]&&(rgba.pop(),prefix="rgb("),prefix+rgba.join()+")"},toHslaString:function(){var prefix="hsla(",hsla=jQuery.map(this.hsla(),function(v,i){return null==v&&(v=2<i?1:0),i&&i<3&&(v=Math.round(100*v)+"%"),v});return 1===hsla[3]&&(hsla.pop(),prefix="hsl("),prefix+hsla.join()+")"},toHexString:function(includeAlpha){var rgba=this._rgba.slice(),alpha=rgba.pop();return includeAlpha&&rgba.push(~~(255*alpha)),"#"+jQuery.map(rgba,function(v){return 1===(v=(v||0).toString(16)).length?"0"+v:v}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),color.fn.parse.prototype=color.fn,spaces.hsla.to=function(rgba){if(null==rgba[0]||null==rgba[1]||null==rgba[2])return[null,null,null,rgba[3]];var h,s,r=rgba[0]/255,g=rgba[1]/255,b=rgba[2]/255,a=rgba[3],max=Math.max(r,g,b),min=Math.min(r,g,b),diff=max-min,add=max+min,l=.5*add;return h=min===max?0:r===max?60*(g-b)/diff+360:g===max?60*(b-r)/diff+120:60*(r-g)/diff+240,s=0==diff?0:l<=.5?diff/add:diff/(2-add),[Math.round(h)%360,s,l,null==a?1:a]},spaces.hsla.from=function(hsla){if(null==hsla[0]||null==hsla[1]||null==hsla[2])return[null,null,null,hsla[3]];var h=hsla[0]/360,s=hsla[1],l=hsla[2],a=hsla[3],q=l<=.5?l*(1+s):l+s-l*s,p=2*l-q;return[Math.round(255*hue2rgb(p,q,h+1/3)),Math.round(255*hue2rgb(p,q,h)),Math.round(255*hue2rgb(p,q,h-1/3)),a]},each(spaces,function(spaceName,space){var props=space.props,cache=space.cache,to=space.to,from=space.from;color.fn[spaceName]=function(value){if(to&&!this[cache]&&(this[cache]=to(this._rgba)),void 0===value)return this[cache].slice();var ret,type=jQuery.type(value),arr="array"===type||"object"===type?value:arguments,local=this[cache].slice();return each(props,function(key,prop){var val=arr["object"===type?key:prop.idx];null==val&&(val=local[prop.idx]),local[prop.idx]=clamp(val,prop)}),from?((ret=color(from(local)))[cache]=local,ret):color(local)},each(props,function(key,prop){color.fn[key]||(color.fn[key]=function(value){var match,vtype=jQuery.type(value),fn="alpha"===key?this._hsla?"hsla":"rgba":spaceName,local=this[fn](),cur=local[prop.idx];return"undefined"===vtype?cur:("function"===vtype&&(value=value.call(this,cur),vtype=jQuery.type(value)),null==value&&prop.empty?this:("string"!==vtype||(match=rplusequals.exec(value))&&(value=cur+parseFloat(match[2])*("+"===match[1]?1:-1)),local[prop.idx]=value,this[fn](local)))})})}),color.hook=function(hook){var hooks=hook.split(" ");each(hooks,function(i,hook){jQuery.cssHooks[hook]={set:function(elem,value){var parsed,curElem,backgroundColor="";if("transparent"!==value&&("string"!==jQuery.type(value)||(parsed=stringParse(value)))){if(value=color(parsed||value),!support.rgba&&1!==value._rgba[3]){for(curElem="backgroundColor"===hook?elem.parentNode:elem;(""===backgroundColor||"transparent"===backgroundColor)&&curElem&&curElem.style;)try{backgroundColor=jQuery.css(curElem,"backgroundColor"),curElem=curElem.parentNode}catch(e){}value=value.blend(backgroundColor&&"transparent"!==backgroundColor?backgroundColor:"_default")}value=value.toRgbaString()}try{elem.style[hook]=value}catch(e){}}},jQuery.fx.step[hook]=function(fx){fx.colorInit||(fx.start=color(fx.elem,hook),fx.end=color(fx.end),fx.colorInit=!0),jQuery.cssHooks[hook].set(fx.elem,fx.start.transition(fx.end,fx.pos))}})},color.hook("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor"),jQuery.cssHooks.borderColor={expand:function(value){var expanded={};return each(["Top","Right","Bottom","Left"],function(i,part){expanded["border"+part+"Color"]=value}),expanded}},colors=jQuery.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(jQuery);