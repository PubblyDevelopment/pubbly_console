<html>
   <head>
      <title>Console - NavNodes</title>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <!-- Woo jquery -->
      <script src="includes/jquery-3.3.1.min.js"></script>
      <link rel="stylesheet" href="includes/fontawesome.css" />
      <script src="includes/bootstrap.js"></script>
      <link rel="stylesheet" href="includes/bootstrap.css" />


      <link rel="stylesheet" href="NavigationNodesUI/css/main.css">
      <!-- Navigation node development class -->
      <!-- (In a production or not-open sourced environment, you would probably minify to a single unreadable copyrighted script. BUT this is all attached to the Xprize project, so keep scripts open like so -->
      <!-- If you're interested... I used to follow the AirBnB javascript styleguide.
      
      https://github.com/airbnb/javascript
      
      You're welcome to follow/make your own, but as a jumping off point...
      Small constructed classes should be InitCapsCamelCase()
      Big contructed classes should be in their own folder. _main.js ties everything together, one "function" named the name of the class (and folder and everything else).
      Constructed classes should be Init caps camel case (ExampleClass)
      Scope constants should be all caps (THIS, NAV_SCOPE)

      Everything else, methods props and vars, are be camel case (this.exampleMethod, exampleHelper, this.exampleProp, exampleVar)
      
      If you want to change this up, maybe make methods snake_case instead of camelCase, that's fine. But just be aware... you're coming up with a styleguide even if you aren't fully aware of it.
      -->
      <!-- Underscores so it's at the VERY top of the folder -->
      <script src="NavigationNodesUI/js/_main.js"></script>
      <!-- Single underscore. It's a super class for what's listed below -->
      <script src="NavigationNodesUI/js/element.js"></script>
      <script src="NavigationNodesUI/js/element_Canvas.js"></script>
      <script src="NavigationNodesUI/js/element_Path.js"></script>
      <script src="NavigationNodesUI/js/element_Zoom.js"></script>
      <script src="NavigationNodesUI/js/element_Save.js"></script>
      <script src="NavigationNodesUI/js/element_Dropdown.js?v=2"></script>
      <script src="NavigationNodesUI/js/element_Entry.js"></script>
      <script src="NavigationNodesUI/js/canvas-arrow.js"></script>

      <script src="NavigationNodesUI/js/helper.js"></script>

      <link rel="stylesheet" href="skins/webix.css" type="text/css">
      <link rel="styleSheet" href="css/webixPersonalModifications.css"/>
      <script src="includes/webix/webix.js"></script>
      <script src="js/classes/betterCookies.js"></script>
      <script src="js/edit_map.js"></script>

      <script>
         window.username = "{USERNAME}";
         $(document).ready(function () {
             let inputs = {
                 canvas: $("#NavNodesCanvasMain")[0],
                 saveButton: $("#saveButton")[0],
                 zoomInButton: $("#zoomInButton")[0],
                 zoomOutButton: $("#zoomOutButton")[0],
                 linkButton: $("#linkButton")[0],
                 linkDropdown: $("#linkSelections")[0],
                 entryNodeButton: $("#entryNodeButton")[0],
                 pathButton: $("#pathButton")[0],
                 pathDropdown: $("#pathSelections")[0],
                 fromNode: $("#firstNodePhoto")[0],
                 deleteNode: $("#deleteNodeButton")[0],
                 viewAt: $("#viewAtButton")[0],
                 allPathButton: $("#allPathButton")[0],
                 updateButton: $("#updateButton")[0],
             };
             let data = false;
             try {
                 data = JSON.parse(`{MAP_JSON}`);
             } catch (e) {
                 console.log("Could not interpret passed data");
             }
             if (!data) {
                 data = {};
             }
             console.log(data);
             window.mapID = "{MAP_ID}";
             window.mapName = "{MAP_NAME}";
             window.navigationNodes = new NavigationNodes(
                     window.mapName,
                     data,
                     inputs,
                     {fakeProjectVirgin: false});
         });

         function insertNewNodeTest() {
          let retFromAddNodeToMapExample = {
            name: "static-Pots", 
            cover: 0, 
            links: Array(0),
            node_id: 21
          }
          navigationNodes.addNewNode(retFromAddNodeToMapExample);
         }
         
      </script>
   </head>
   <body>
      <form id="file_upload_form" style="display:none" method="POST" enctype="multipart/form-data">
         <input type="file" name="upload" id="file_upload" />
         <input type="text" name="mapName" value="{MAP_NAME}" />
      </form>

      <div id="webixHeader"></div>


      <div id="modalBlack" class="hidden"></div>
      <div id="modalWhite" class="hidden"><img id="modalImg" class="center" width="55%" src="NavigationNodesUI/assets/loadarrow.png"><div id="modalContent">Nodes updating, please wait...</div></div>

      <!-- For bootstrap, always enclose in a .container (just works that way) -->
      <div class="container">
         <!-- bootstrap classname for style="display:block;margin:auto" (center align) -->
         <!-- spacing -->
         <!-- bootstrap cols use flex styles. BAD for us, cause the canvas needs to be a set 600px all the time no matter what. So can't use the grid for the canvas. Manual fake grid solution below. -->
         <div class="row">
            <div class="col-3 m-0 p-0">
               <div id="importMapNodesButtonContainer"
                    style="height:calc(100% - 80px)"></div>
            </div>
            <div class="col-9 m-0 p-0">
               <div>
                  <div class="d-block m-auto" style="width:910px">
                     <div class="d-inline-block" style="width:50px">

                     </div>

                     <div class="d-inline-block" style="width:800px">
                        <div id="savePrompt" style="opacity: 0;">Last saved: blah blah</div>
                        <canvas id="NavNodesCanvasMain" 
                                height=600 width=800></canvas>
                     </div>
                     <div class="d-inline-block" style="width:50px;vertical-align:top">
                        <button class='button d-block' id="saveButton" type="button" value="SAVE"/><i class="far fa-save"></i></button>
                        <button class='button d-block' id="zoomInButton" type="button" value="ZOOM IN"/><i class="fas fa-search-plus"></i></button>
                        <button class='button d-block' id="zoomOutButton" type="button" value="ZOOM OUT"/><i class="fas fa-search-minus"></i></button>
                        <button class='button d-block' id="entryNodeButton" type="button" value="SET POINT"/><i class="fas fa-star"></i></button>
                        <button class='button d-block' id="viewAtButton" type="button" value="VIEW MAP AT NODE"/><i class="fas fa-glasses"></i></button>
                        <button class='button d-block' id="updateButton" type="button" value="UPDATE ALL NODES"/><i class="fas fa-sync-alt"></i></button>
                        <button class='button d-block' id="deleteNodeButton" type="button" value="DELETE NODE"/><i class="fas fa-trash"></i></button>
                       
                     </div>
                  </div>
               </div>
               <div class="row">
                  <!-- If no col-number is set, other cols will fill around it -->
                  <div class="col" style="top: 25;">
                     <!-- d-block m-auto centers image -->
                     <img id="firstNodePhoto" class="d-block m-auto" width=100px
                          src="NavigationNodesUI/assets/nonodeselected.png">
                     <!-- text-align:center centers text -->
                     <p id="firstNodeSelected" style="text-align:center;">[No node selected]</p>
                  </div>
                  <div class="col-2">
                     <!-- note, this is the poor-boy centershit of css -->
                     <div style="position:absolute;top:100%;left:50%;transform:translate(-50%,-50%);">
                        <select id="pathSelections" style="width:200px">
                        </select>
                        <br>
                        <br>
                        <div style="text-align: center">
                           <button class='button' id="pathButton" type="button" value="PATH" style="font-size: 22px">
                              <i class="fas fa-angle-right"></i>
                           </button>
                           <button class='button' id="allPathButton" type="button" value="ALLPATH" style="font-size: 22px">
                              <i class="fas fa-angle-double-right"></i>
                           </button>
                        </div>
                     </div>
                  </div>
                  <div class="col" style="top: 25;">
                     <!-- d-block m-auto centers image -->
                     <img id="secondNodePhoto" class="d-block m-auto" width=100px
                          src="NavigationNodesUI/assets/nonodeselected.png">
                     <!-- text-align:center centers text -->
                     <p id="secondNodeSelected" style="text-align:center;">[No node selected]</p>
                  </div>
               </div>
            </div>
         </div>
      </div>
   </body>
</html>